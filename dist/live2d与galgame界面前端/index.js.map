{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/src/live2dgalgame/lib/renderers/cubism/CubismAdapter.ts","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/motion/cubismmotionmanager/+esm\"","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/motion/cubismexpressionmotion/+esm\"","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/model/cubismmoc/+esm\"","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/cubismmodelsettingjson/+esm\"","src://tavern_helper_template/src/live2dgalgame/lib/renderers/cubism/LAppPal.ts","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/rendering/cubismrenderer_webgl/+esm\"","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/motion/cubismexpressionmotionmanager/+esm\"","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/model/cubismmodel/+esm\"","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/math/cubismmodelmatrix/+esm\"","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/live2dcubismframework/+esm\"","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/math/cubismmatrix44/+esm\"","src://tavern_helper_template/external import \"https://testingcf.jsdelivr.net/npm/@framework/motion/cubismmotion/+esm\"","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/src/live2dgalgame/types/galgame.ts","src://tavern_helper_template/src//utils/worldbookFormat.ts","src://tavern_helper_template/src/live2dgalgame/utils/messageParser.ts","src://tavern_helper_template/src/live2dgalgame/utils/indexedDB.ts","src://tavern_helper_template/src/live2dgalgame/lib/renderers/cubism/ModelManager.ts","src://tavern_helper_template/src/live2dgalgame/lib/renderers/cubism/LAppDefine.ts","src://tavern_helper_template/src/live2dgalgame/lib/renderers/Live2DRenderer.ts","webpack://tavern_helper_template/./src/live2dgalgame/components/CharacterSprite.vue?b200","webpack://tavern_helper_template/src/live2dgalgame/components/CharacterSprite.vue?1582","src://tavern_helper_template/external var \"_\"","webpack://tavern_helper_template/./src/live2dgalgame/components/CharacterStatusPanel.vue?7bbb","webpack://tavern_helper_template/src/live2dgalgame/components/CharacterStatusPanel.vue?5b8e","src://tavern_helper_template/src/live2dgalgame/components/ChoiceBox.vue","webpack://tavern_helper_template/src/live2dgalgame/components/ChoiceBox.vue?f797","webpack://tavern_helper_template/./src/live2dgalgame/components/DialogBox.vue?d7ff","webpack://tavern_helper_template/src/live2dgalgame/components/DialogBox.vue?f4ea","webpack://tavern_helper_template/./src/live2dgalgame/components/NoteCard.vue?ee26","webpack://tavern_helper_template/src/live2dgalgame/components/NoteCard.vue?d628","webpack://tavern_helper_template/./src/live2dgalgame/components/ColorSlider.vue?3ac9","webpack://tavern_helper_template/src/live2dgalgame/components/ColorSlider.vue?3e99","src://tavern_helper_template/src/live2dgalgame/components/DialogPreview.vue","webpack://tavern_helper_template/src/live2dgalgame/components/DialogPreview.vue?c30e","webpack://tavern_helper_template/./src/live2dgalgame/components/SettingsPanel.vue?2a81","webpack://tavern_helper_template/src/live2dgalgame/components/SettingsPanel.vue?a0f2","webpack://tavern_helper_template/./src/live2dgalgame/components/TheaterPanel.vue?1d8d","webpack://tavern_helper_template/src/live2dgalgame/components/TheaterPanel.vue?b1f0","webpack://tavern_helper_template/./src/live2dgalgame/components/GalgamePlayer.vue?5934","webpack://tavern_helper_template/src/live2dgalgame/components/GalgamePlayer.vue?5f01","src://tavern_helper_template/src/live2dgalgame/index.ts"],"sourcesContent":["/**\n * Cubism SDK \n *  Cubism Framework \n */\n\nimport { LAppPal } from './LAppPal';\n\n// Cubism Framework \ndeclare let Live2DCubismCore: any;\n\n/**\n * Cubism Framework \n */\nexport class CubismAdapter {\n  private static _isInitialized = false;\n  private static _cubismFramework: any = null;\n\n  /**\n   *  Cubism Framework\n   */\n  static async initialize(): Promise<void> {\n    if (this._isInitialized) {\n      return;\n    }\n\n    try {\n      //  Cubism Core \n      if (!window.Live2DCubismCore && !window.CubismCore) {\n        throw new Error('Cubism Core ');\n      }\n\n      //  Cubism Framework\n      const frameworkModule = await import('@framework/live2dcubismframework');\n      const { CubismFramework, Option, LogLevel } = frameworkModule;\n\n      if (!CubismFramework.isStarted()) {\n        const option = new Option();\n        option.logFunction = LAppPal.printMessage;\n        option.loggingLevel = LogLevel.LogLevel_Verbose;\n        CubismFramework.startUp(option);\n        CubismFramework.initialize();\n        console.info(' Cubism Framework ');\n      } else {\n        console.info(' Cubism Framework ');\n      }\n\n      this._cubismFramework = CubismFramework;\n      this._isInitialized = true;\n    } catch (error) {\n      console.warn('[CubismAdapter] Framework :', error);\n      //  Framework \n      this._isInitialized = true;\n    }\n  }\n\n  /**\n   * \n   */\n  static isInitialized(): boolean {\n    return this._isInitialized;\n  }\n\n  /**\n   *  Cubism Framework \n   */\n  static getFramework(): any {\n    return this._cubismFramework;\n  }\n}\n","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/motion/cubismmotionmanager/+esm\");;","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/motion/cubismexpressionmotion/+esm\");;","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/model/cubismmoc/+esm\");;","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/cubismmodelsettingjson/+esm\");;","/**\n * Cubism Platform Abstraction Layer\n * \n */\n\nexport class LAppPal {\n  /**\n   * \n   */\n  public static loadFileAsBytes(filePath: string, callback: (arrayBuffer: ArrayBuffer, size: number) => void): void {\n    fetch(filePath)\n      .then(response => response.arrayBuffer())\n      .then(arrayBuffer => callback(arrayBuffer, arrayBuffer.byteLength))\n      .catch(error => {\n        console.error(`Failed to load file: ${filePath}`, error);\n        callback(new ArrayBuffer(0), 0);\n      });\n  }\n\n  /**\n   * \n   * @return []\n   */\n  public static getDeltaTime(): number {\n    return this.deltaTime;\n  }\n\n  /**\n   * \n   */\n  public static updateTime(): void {\n    this.currentFrame = Date.now();\n    this.deltaTime = (this.currentFrame - this.lastFrame) / 1000;\n    this.lastFrame = this.currentFrame;\n  }\n\n  /**\n   * \n   */\n  public static printMessage(message: string): void {\n    console.log(message);\n  }\n\n  static lastUpdate = Date.now();\n  static currentFrame = 0.0;\n  static lastFrame = 0.0;\n  static deltaTime = 0.0;\n}\n","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/rendering/cubismrenderer_webgl/+esm\");;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/motion/cubismexpressionmotionmanager/+esm\");;","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/model/cubismmodel/+esm\");;","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/math/cubismmodelmatrix/+esm\");;","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/live2dcubismframework/+esm\");;","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/math/cubismmatrix44/+esm\");;","module.exports = import(\"https://testingcf.jsdelivr.net/npm/@framework/motion/cubismmotion/+esm\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","/**\n * Galgame \n */\n\nexport interface DialogueItem {\n  character?: string;\n  text: string;\n  type?: 'blackscreen' | 'choice' | 'narration' | 'user' | 'cg';\n  options?: ChoiceOption[];\n  message_id?: number; // ID\n  role?: 'system' | 'assistant' | 'user'; // \n  sprite?: {\n    type: 'live2d' | 'image' | 'none'; // noneCG\n    live2dModelId?: string; // Live2D ID\n    imageUrl?: string; // URL\n  };\n  // \n  scene?: string; // \n  sceneImageUrl?: string; // URL\n  motion?: string; // \n  expression?: string; // \n  isThrough?: boolean; // through\n  isCG?: boolean; // CG\n  cgImageUrl?: string; // CGURL\n  statusBlock?: {\n    ?: string;\n    ?: string;\n    ?: string;\n    ?: string;\n    ?: string;\n    ?: string;\n    [key: string]: any;\n  } | null;\n  isEditable?: boolean; // \n  editedText?: string; // \n  isDeleted?: boolean; // \n}\n\nexport interface ChoiceOption {\n  id: string;\n  text: string;\n  character?: string; // \n  response?: string; // \n  onClick?: () => void;\n}\n\nexport interface BoxShapePreset {\n  id: string;\n  name: string;\n  borderRadius: string;\n  borderWidth: string;\n  shadow: string;\n}\n\nexport interface NameShapePreset {\n  id: string;\n  name: string;\n  borderRadius: string;\n  style: 'tag' | 'pill' | 'square' | 'underline' | 'floating';\n}\n\nexport interface ArrowShapePreset {\n  id: string;\n  name: string;\n  type: 'circle' | 'square' | 'pill' | 'minimal' | 'inner-round' | 'inner-square';\n  isInner: boolean;\n}\n\nexport interface IndicatorShapePreset {\n  id: string;\n  name: string;\n  type: 'dots' | 'diamonds' | 'pulse' | 'arrow' | 'none';\n}\n\nexport interface BackgroundPatternPreset {\n  id: string;\n  name: string;\n  pattern: string;\n}\n\nexport interface DialogBoxStyle {\n  boxShape: string;\n  nameShape: string;\n  arrowShape: string;\n  indicatorShape: string;\n  backgroundPattern: string;\n  borderWidth: string;\n  colors: {\n    boxBackground: string;\n    boxBorder: string;\n    nameBackground: string;\n    nameText: string;\n    nameBorder: string;\n    dialogText: string;\n    narrationText: string;\n    arrowBackground: string;\n    arrowIcon: string;\n    indicatorColor: string;\n  };\n  fontSize: number;\n}\n\nexport const backgroundPatternPresets: BackgroundPatternPreset[] = [\n  { id: 'none', name: '', pattern: '' },\n  {\n    id: 'grid',\n    name: '',\n    pattern:\n      'linear-gradient(to right, VAR_BORDER_COLOR 1px, transparent 1px), linear-gradient(to bottom, VAR_BORDER_COLOR 1px, transparent 1px)',\n  },\n  { id: 'dots', name: '', pattern: 'radial-gradient(circle, VAR_BORDER_COLOR 1px, transparent 1px)' },\n  {\n    id: 'diamonds',\n    name: '',\n    pattern:\n      'linear-gradient(45deg, VAR_BORDER_COLOR 25%, transparent 25%), linear-gradient(-45deg, VAR_BORDER_COLOR 25%, transparent 25%), linear-gradient(45deg, transparent 75%, VAR_BORDER_COLOR 75%), linear-gradient(-45deg, transparent 75%, VAR_BORDER_COLOR 75%)',\n  },\n  {\n    id: 'stripes',\n    name: '',\n    pattern:\n      'repeating-linear-gradient(45deg, transparent, transparent 10px, VAR_BORDER_COLOR 10px, VAR_BORDER_COLOR 20px)',\n  },\n  {\n    id: 'gradient-soft',\n    name: '',\n    pattern: 'linear-gradient(135deg, rgba(255,255,255,0.15) 0%, transparent 50%, VAR_BORDER_COLOR 100%)',\n  },\n];\n\nexport const boxShapePresets: BoxShapePreset[] = [\n  { id: 'rounded', name: '', borderRadius: '12px', borderWidth: '1px', shadow: '0 4px 20px rgba(0,0,0,0.08)' },\n  { id: 'pill', name: '', borderRadius: '24px', borderWidth: '1px', shadow: '0 4px 24px rgba(0,0,0,0.1)' },\n  { id: 'sharp', name: '', borderRadius: '0px', borderWidth: '2px', shadow: '4px 4px 0 rgba(0,0,0,0.1)' },\n  { id: 'soft', name: '', borderRadius: '16px', borderWidth: '0px', shadow: '0 8px 32px rgba(0,0,0,0.12)' },\n  { id: 'frame', name: '', borderRadius: '4px', borderWidth: '3px', shadow: 'inset 0 0 0 1px rgba(0,0,0,0.05)' },\n];\n\nexport const borderWidthPresets = [\n  { id: 'none', name: '', width: '0px' },\n  { id: 'thin', name: '', width: '1px' },\n  { id: 'medium', name: '', width: '2px' },\n  { id: 'thick', name: '', width: '3px' },\n  { id: 'bold', name: '', width: '4px' },\n];\n\nexport const nameShapePresets: NameShapePreset[] = [\n  { id: 'tag', name: '', borderRadius: '6px 6px 0 0', style: 'tag' },\n  { id: 'pill', name: '', borderRadius: '999px', style: 'pill' },\n  { id: 'square', name: '', borderRadius: '0px', style: 'square' },\n  { id: 'underline', name: '', borderRadius: '0px', style: 'underline' },\n  { id: 'floating', name: '', borderRadius: '8px', style: 'floating' },\n];\n\nexport const arrowShapePresets: ArrowShapePreset[] = [\n  { id: 'circle', name: '', type: 'circle', isInner: false },\n  { id: 'square', name: '', type: 'square', isInner: false },\n  { id: 'pill', name: '', type: 'pill', isInner: false },\n  { id: 'minimal', name: '', type: 'minimal', isInner: false },\n  { id: 'inner-round', name: '', type: 'inner-round', isInner: true },\n  { id: 'inner-square', name: '', type: 'inner-square', isInner: true },\n];\n\nexport const indicatorShapePresets: IndicatorShapePreset[] = [\n  { id: 'dots', name: '', type: 'dots' },\n  { id: 'diamonds', name: '', type: 'diamonds' },\n  { id: 'pulse', name: '', type: 'pulse' },\n  { id: 'arrow', name: '', type: 'arrow' },\n  { id: 'none', name: '', type: 'none' },\n];\n\nexport const defaultDialogStyle: DialogBoxStyle = {\n  boxShape: 'rounded',\n  nameShape: 'tag',\n  arrowShape: 'circle',\n  indicatorShape: 'dots',\n  backgroundPattern: 'none',\n  borderWidth: 'thin',\n  colors: {\n    boxBackground: 'rgba(255, 255, 255, 0.9)',\n    boxBorder: 'rgba(16, 185, 129, 0.3)',\n    nameBackground: 'rgba(236, 253, 245, 0.9)',\n    nameText: '#059669',\n    nameBorder: 'rgba(16, 185, 129, 0.3)',\n    dialogText: '#374151',\n    narrationText: '#6b7280',\n    arrowBackground: 'rgba(255, 255, 255, 0.85)',\n    arrowIcon: '#10b981',\n    indicatorColor: '#10b981',\n  },\n  fontSize: 16,\n};\n","/**\n * \n *  JSON \n */\n\nimport type { PartialDeep } from 'type-fest';\nimport type { WorldbookEntry } from '../../@types/function/worldbook';\n\n/**\n *  JSON \n */\nexport interface ModelResourceWorldbookData {\n  type: 'live2d_model';\n  modelName: string;\n  files: {\n    model3?: string;\n    moc3?: string;\n    textures: string[];\n    cdi3?: string;\n    physics3?: string;\n  };\n  motions: Array<{ name: string; file: string; group: string }>;\n  expressions: Array<{ name: string; file: string }>;\n  defaultAnimation?: {\n    expression?: string;\n    motion?: string;\n    autoLoop?: boolean;\n  };\n  textMappings?: {\n    expression?: Record<string, string>; // { \"happy.exp3.json\": \"\" }\n    motion?: Record<string, string>; // { \"idle.motion3.json\": \"\" }\n  };\n}\n\n/**\n *  JSON \n */\nexport interface SpriteResourceWorldbookData {\n  type: 'sprite';\n  characterName?: string;\n  sprites: Array<{\n    name: string;\n    file: string;\n    textMappings?: string[]; // \n  }>;\n}\n\n/**\n *  JSON \n */\nexport interface BackgroundResourceWorldbookData {\n  type: 'background';\n  backgrounds: Array<{\n    name: string;\n    file: string;\n    textMappings?: string[]; // \n  }>;\n}\n\n/**\n * CG JSON \n */\nexport interface CGResourceWorldbookData {\n  type: 'cg';\n  cgs: Array<{\n    name: string;\n    file: string;\n    textMappings?: string[]; // \n  }>;\n}\n\n/**\n *  JSON \n */\nexport function createModelResourceWorldbookEntry(\n  modelName: string,\n  data: ModelResourceWorldbookData,\n): PartialDeep<WorldbookEntry> {\n  const neverMatchKey = `__MODEL_RESOURCE_${modelName}_${Date.now()}__`;\n\n  return {\n    name: `[] ${modelName}`,\n    enabled: true,\n    strategy: {\n      type: 'selective',\n      keys: [neverMatchKey],\n      keys_secondary: { logic: 'and_any', keys: [] },\n      scan_depth: 'same_as_global',\n    },\n    position: {\n      type: 'after_character_definition',\n      role: 'system',\n      depth: 0,\n      order: 0,\n    },\n    content: `\\`\\`\\`json\n${JSON.stringify(data, null, 2)}\n\\`\\`\\`\n`,\n    probability: 100,\n    recursion: {\n      prevent_incoming: true,\n      prevent_outgoing: true,\n      delay_until: null,\n    },\n    effect: {\n      sticky: null,\n      cooldown: null,\n      delay: null,\n    },\n  };\n}\n\n/**\n *  JSON \n */\nexport function createSpriteResourceWorldbookEntry(\n  characterName: string,\n  data: SpriteResourceWorldbookData,\n): PartialDeep<WorldbookEntry> {\n  const entryName = characterName ? `[] ${characterName}` : '[]';\n  const keys = characterName ? [characterName, `${characterName}`] : ['', ''];\n\n  return {\n    name: entryName,\n    enabled: true,\n    strategy: {\n      type: 'selective',\n      keys,\n      keys_secondary: { logic: 'and_any', keys: [] },\n      scan_depth: 'same_as_global',\n    },\n    position: {\n      type: 'after_character_definition',\n      role: 'system',\n      depth: 0,\n      order: 1,\n    },\n    content: `\\`\\`\\`json\n${JSON.stringify(data, null, 2)}\n\\`\\`\\`\n`,\n    probability: 100,\n    recursion: {\n      prevent_incoming: false,\n      prevent_outgoing: false,\n      delay_until: null,\n    },\n    effect: {\n      sticky: null,\n      cooldown: null,\n      delay: null,\n    },\n  };\n}\n\n/**\n *  JSON \n */\nexport function createBackgroundResourceWorldbookEntry(\n  data: BackgroundResourceWorldbookData,\n): PartialDeep<WorldbookEntry> {\n  // \n  const keys: string[] = ['', ''];\n  for (const bg of data.backgrounds) {\n    if (bg.textMappings) {\n      keys.push(...bg.textMappings);\n    }\n    keys.push(bg.name);\n  }\n\n  return {\n    name: '[]',\n    enabled: true,\n    strategy: {\n      type: 'selective',\n      keys: [...new Set(keys)],\n      keys_secondary: { logic: 'and_any', keys: [] },\n      scan_depth: 'same_as_global',\n    },\n    position: {\n      type: 'after_character_definition',\n      role: 'system',\n      depth: 0,\n      order: 2,\n    },\n    content: `\\`\\`\\`json\n${JSON.stringify(data, null, 2)}\n\\`\\`\\`\n`,\n    probability: 100,\n    recursion: {\n      prevent_incoming: false,\n      prevent_outgoing: false,\n      delay_until: null,\n    },\n    effect: {\n      sticky: null,\n      cooldown: null,\n      delay: null,\n    },\n  };\n}\n\n/**\n * CG JSON \n */\nexport function createCGResourceWorldbookEntry(data: CGResourceWorldbookData): PartialDeep<WorldbookEntry> {\n  // \n  const keys: string[] = ['CG', 'cg'];\n  for (const cg of data.cgs) {\n    if (cg.textMappings) {\n      keys.push(...cg.textMappings);\n    }\n    keys.push(cg.name);\n  }\n\n  return {\n    name: '[CG]',\n    enabled: true,\n    strategy: {\n      type: 'selective',\n      keys: [...new Set(keys)],\n      keys_secondary: { logic: 'and_any', keys: [] },\n      scan_depth: 'same_as_global',\n    },\n    position: {\n      type: 'after_character_definition',\n      role: 'system',\n      depth: 0,\n      order: 3,\n    },\n    content: `\\`\\`\\`json\n${JSON.stringify(data, null, 2)}\n\\`\\`\\`\n`,\n    probability: 100,\n    recursion: {\n      prevent_incoming: false,\n      prevent_outgoing: false,\n      delay_until: null,\n    },\n    effect: {\n      sticky: null,\n      cooldown: null,\n      delay: null,\n    },\n  };\n}\n\n/**\n *  JSON \n */\nexport function parseWorldbookJsonData(content: string): any {\n  //  markdown  JSON\n  const jsonMatch = content.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n  if (jsonMatch) {\n    try {\n      return JSON.parse(jsonMatch[1]);\n    } catch (error) {\n      console.warn(' JSON :', error);\n    }\n  }\n\n  // \n  try {\n    return JSON.parse(content.trim());\n  } catch (error) {\n    console.warn(' JSON :', error);\n    return null;\n  }\n}\n","/**\n * \n *  [[character||...]][[narration||...]] \n */\n\nimport type {\n  BackgroundResourceWorldbookData,\n  CGResourceWorldbookData,\n  ModelResourceWorldbookData,\n  SpriteResourceWorldbookData,\n} from '../..//utils/worldbookFormat';\nimport { parseWorldbookJsonData } from '../..//utils/worldbookFormat';\nimport type { MessageBlock, StatusBlockData } from '../types/message';\n\n/**\n * \n */\ninterface WorldbookResourceCache {\n  models: Map<string, ModelResourceWorldbookData>; // modelName -> \n  sprites: SpriteResourceWorldbookData | null; // CG\n  backgrounds: BackgroundResourceWorldbookData | null;\n  cgs: CGResourceWorldbookData | null;\n}\n\nlet worldbookCache: WorldbookResourceCache | null = null;\nlet worldbookCacheTimestamp = 0;\nlet worldbookCacheSource = ''; // \nconst WORLDBOOK_NAME = '-';\nconst CACHE_DURATION = 5000; // 5\n\n/**\n * \n * \n *\n * @returns \n */\nexport async function loadWorldbookResources(): Promise<WorldbookResourceCache> {\n  const now = Date.now();\n\n  // \n  let currentCharacterName = '';\n  try {\n    const rawChar = new RawCharacter(RawCharacter.find({ name: 'current' }));\n    currentCharacterName = rawChar.getCardData().name || '';\n  } catch (error) {\n    console.warn(':', error);\n  }\n\n  // \n  if (\n    worldbookCache &&\n    now - worldbookCacheTimestamp < CACHE_DURATION &&\n    worldbookCacheSource === currentCharacterName\n  ) {\n    return worldbookCache;\n  }\n\n  const cache: WorldbookResourceCache = {\n    models: new Map(),\n    sprites: null,\n    backgrounds: null,\n    cgs: null,\n  };\n\n  // \n  const worldbookNames: string[] = [];\n  try {\n    const charWorldbooks = getCharWorldbookNames('current');\n    if (charWorldbooks.primary) {\n      worldbookNames.push(charWorldbooks.primary);\n    }\n    worldbookNames.push(...charWorldbooks.additional);\n  } catch (error) {\n    console.warn(':', error);\n  }\n\n  // \n  if (worldbookNames.length === 0) {\n    worldbookNames.push(WORLDBOOK_NAME);\n  }\n\n  // \n  console.info('[] :', worldbookNames);\n  for (const worldbookName of worldbookNames) {\n    try {\n      //  getWorldbook \n      if (typeof getWorldbook !== 'function') {\n        console.warn('[] getWorldbook ');\n        continue;\n      }\n\n      const entries = await getWorldbook(worldbookName);\n      console.info(`[]  ${worldbookName}  ${entries.length} `);\n\n      for (const entry of entries) {\n        if (!entry.enabled) continue;\n\n        const data = parseWorldbookJsonData(entry.content);\n        if (!data) {\n          console.warn(`[] : ${entry.name}`);\n          continue;\n        }\n\n        console.info(`[] : ${entry.name}, type=${data.type}`);\n\n        if (data.type === 'live2d_model') {\n          const modelData = data as ModelResourceWorldbookData;\n          // \n          if (!cache.models.has(modelData.modelName)) {\n            cache.models.set(modelData.modelName, modelData);\n          }\n        } else if (data.type === 'sprite') {\n          // CG\n          const spriteData = data as SpriteResourceWorldbookData;\n          console.info(`[]  ${spriteData.sprites?.length || 0} `);\n          if (spriteData.sprites && spriteData.sprites.length > 0) {\n            // \n            for (const sprite of spriteData.sprites) {\n              console.info(`[] : ${sprite.name}, textMappings: ${sprite.textMappings?.join(', ')}`);\n            }\n          }\n          if (!cache.sprites) {\n            cache.sprites = spriteData;\n          } else {\n            const existing = cache.sprites;\n            const newData = spriteData;\n            existing.sprites.push(...newData.sprites);\n          }\n          console.info('[] :', cache.sprites.sprites.length);\n        } else if (data.type === 'background') {\n          // \n          if (!cache.backgrounds) {\n            cache.backgrounds = data as BackgroundResourceWorldbookData;\n          } else {\n            const existing = cache.backgrounds;\n            const newData = data as BackgroundResourceWorldbookData;\n            existing.backgrounds.push(...newData.backgrounds);\n          }\n        } else if (data.type === 'cg') {\n          // CG\n          if (!cache.cgs) {\n            cache.cgs = data as CGResourceWorldbookData;\n          } else {\n            const existing = cache.cgs;\n            const newData = data as CGResourceWorldbookData;\n            existing.cgs.push(...newData.cgs);\n          }\n        }\n      }\n    } catch (error) {\n      console.warn(` ${worldbookName} :`, error);\n    }\n  }\n\n  worldbookCache = cache;\n  worldbookCacheTimestamp = now;\n  worldbookCacheSource = currentCharacterName;\n\n  // \n  console.info('[] :', {\n    : cache.models.size,\n    : cache.sprites?.sprites?.length || 0,\n    : cache.backgrounds?.backgrounds?.length || 0,\n    CG: cache.cgs?.cgs?.length || 0,\n  });\n\n  return cache;\n}\n\n/**\n * \n */\nfunction normalizeText(text: string): string {\n  return text\n    .replace(/[-/\\\\_.\\s]/g, '') //  - / \\ _ . \n    .toLowerCase();\n}\n\n/**\n * \n */\nfunction fuzzyMatch(source: string, target: string): boolean {\n  const normalizedSource = normalizeText(source);\n  const normalizedTarget = normalizeText(target);\n  return (\n    normalizedSource === normalizedTarget ||\n    normalizedSource.includes(normalizedTarget) ||\n    normalizedTarget.includes(normalizedSource)\n  );\n}\n\n/**\n * \n * \n */\nfunction parseKeyValuePairs(text: string): Record<string, string> {\n  const result: Record<string, string> = {};\n\n  //  || \n  const parts = text\n    .split('||')\n    .map(p => p.trim())\n    .filter(p => p);\n\n  // \n  for (const part of parts) {\n    //  \"\"  \":\" \n    //  +  + \n    const kvMatch = part.match(/^([^:]+)[:]\\s*(.+)$/);\n    if (kvMatch) {\n      const key = kvMatch[1].trim();\n      const value = kvMatch[2].trim();\n      if (key && value) {\n        result[key] = value;\n      }\n    }\n  }\n\n  return result;\n}\n\n/**\n * \n */\nasync function matchWorldbookResources(\n  characterName: string | undefined,\n  sceneText: string | undefined,\n  motionText: string | undefined,\n  expressionText: string | undefined,\n  cgSceneText: string | undefined,\n): Promise<{\n  sceneImageUrl?: string;\n  cgImageUrl?: string;\n  spriteImageUrl?: string;\n  motionFile?: string;\n  expressionFile?: string;\n}> {\n  const result: {\n    sceneImageUrl?: string;\n    cgImageUrl?: string;\n    spriteImageUrl?: string;\n    motionFile?: string;\n    expressionFile?: string;\n  } = {};\n\n  try {\n    const resources = await loadWorldbookResources();\n\n    // \n    if (sceneText && resources.backgrounds) {\n      for (const bg of resources.backgrounds.backgrounds) {\n        // \n        const matchText = sceneText;\n        if (fuzzyMatch(bg.name, matchText) || bg.textMappings?.some(mapping => fuzzyMatch(mapping, matchText))) {\n          result.sceneImageUrl = bg.file;\n          break;\n        }\n      }\n    }\n\n    // CG\n    if (cgSceneText && resources.cgs) {\n      for (const cg of resources.cgs.cgs) {\n        const matchText = cgSceneText;\n        if (fuzzyMatch(cg.name, matchText) || cg.textMappings?.some(mapping => fuzzyMatch(mapping, matchText))) {\n          result.cgImageUrl = cg.file;\n          break;\n        }\n      }\n    }\n\n    // CG\n    if (characterName && resources.sprites) {\n      const matchText = characterName;\n      console.info(\n        '[] :',\n        characterName,\n        ':',\n        resources.sprites.sprites.length,\n      );\n      for (const sprite of resources.sprites.sprites) {\n        //  textMappings nameCG\n        //  ||  textMappings true\n        const textMappingMatch = sprite.textMappings?.some(mapping => fuzzyMatch(mapping, matchText));\n        const nameMatch = fuzzyMatch(sprite.name, matchText);\n        if (textMappingMatch || nameMatch) {\n          result.spriteImageUrl = sprite.file;\n          console.info(\n            '[] ! sprite:',\n            sprite.name,\n            'textMappings:',\n            textMappingMatch,\n            'name:',\n            nameMatch,\n            'URL:',\n            sprite.file,\n          );\n          break;\n        }\n      }\n      if (!result.spriteImageUrl) {\n        console.warn('[] :', characterName);\n      }\n    }\n\n    // Live2DtextMappingscharacter\n    // \n    const modelMatchTexts: string[] = [];\n    if (characterName) modelMatchTexts.push(characterName);\n    if (sceneText) modelMatchTexts.push(sceneText);\n    if (motionText) modelMatchTexts.push(motionText);\n    if (expressionText) modelMatchTexts.push(expressionText);\n\n    // modelNametextMappings\n    let matchedModelData: ModelResourceWorldbookData | null = null;\n    for (const [modelName, modelData] of resources.models.entries()) {\n      // modelName\n      if (modelMatchTexts.some(text => fuzzyMatch(modelName, text))) {\n        matchedModelData = modelData;\n        break;\n      }\n    }\n\n    if (matchedModelData) {\n      // \n      if (motionText) {\n        // \n        if (matchedModelData.textMappings?.motion) {\n          for (const [file, mappingText] of Object.entries(matchedModelData.textMappings.motion)) {\n            if (fuzzyMatch(mappingText, motionText)) {\n              // \n              const motion = (matchedModelData.motions || []).find(m => m.file === file || m.name === file);\n              if (motion) {\n                result.motionFile = motion.file;\n                break;\n              }\n            }\n          }\n        }\n        // \n        if (!result.motionFile) {\n          for (const motion of matchedModelData.motions || []) {\n            if (fuzzyMatch(motion.name, motionText) || fuzzyMatch(motion.file, motionText)) {\n              result.motionFile = motion.file;\n              break;\n            }\n          }\n        }\n      }\n\n      // \n      if (expressionText) {\n        // \n        if (matchedModelData.textMappings?.expression) {\n          for (const [file, mappingText] of Object.entries(matchedModelData.textMappings.expression)) {\n            if (fuzzyMatch(mappingText, expressionText)) {\n              // \n              const expression = (matchedModelData.expressions || []).find(e => e.file === file || e.name === file);\n              if (expression) {\n                result.expressionFile = expression.file;\n                break;\n              }\n            }\n          }\n        }\n        // \n        if (!result.expressionFile) {\n          for (const expression of matchedModelData.expressions || []) {\n            if (fuzzyMatch(expression.name, expressionText) || fuzzyMatch(expression.file, expressionText)) {\n              result.expressionFile = expression.file;\n              break;\n            }\n          }\n        }\n      }\n    }\n  } catch (error) {\n    console.warn(':', error);\n  }\n\n  return result;\n}\n\n/**\n *  StatusBlock \n * : <StatusBlock>...</StatusBlock>\n */\nexport function parseStatusBlock(message: string): StatusBlockData | null {\n  const statusBlockRegex = /<StatusBlock>([\\s\\S]*?)<\\/StatusBlock>/i;\n  const match = message.match(statusBlockRegex);\n\n  if (!match) {\n    return null;\n  }\n\n  const content = match[1].trim();\n  const statusData: StatusBlockData = {};\n\n  // : \n  const fieldRegex = /(\\S+?):\\s*(.+?)(?=\\n\\S+?:|\\n*$)/g;\n  let fieldMatch;\n\n  while ((fieldMatch = fieldRegex.exec(content)) !== null) {\n    const key = fieldMatch[1].trim();\n    const value = fieldMatch[2].trim();\n    statusData[key] = value;\n  }\n\n  // \n  if (Object.keys(statusData).length === 0) {\n    const lines = content.split('\\n').filter(line => line.trim());\n    for (const line of lines) {\n      const colonIndex = line.indexOf(':');\n      if (colonIndex > 0) {\n        const key = line.substring(0, colonIndex).trim();\n        const value = line.substring(colonIndex + 1).trim();\n        if (key && value) {\n          statusData[key] = value;\n        }\n      }\n    }\n  }\n\n  return Object.keys(statusData).length > 0 ? statusData : null;\n}\n\n/**\n * \n * \n * - [[character||||||||||]]\n * - [[character||||CG||]]\n * - [[narration||||]]\n * - [[blacktext||]]\n * - [[user||||]]\n * - [[choice||1||||]] - \n * - [[choice||1||2||3]] - AI\n *\n * \n *  <content>...</content> \n */\nexport async function parseMessageBlocks(message: string, lastScene?: string): Promise<MessageBlock[]> {\n  const blocks: MessageBlock[] = [];\n  let currentScene = lastScene; // \n\n  //  <content>...</content> \n  const contentMatch = message.match(/<content>([\\s\\S]*?)<\\/content>/i);\n  const contentText = contentMatch ? contentMatch[1] : message;\n\n  //  [[type||...]] \n  const blockRegex = /\\[\\[(\\w+)\\|\\|([^\\]]*)\\]\\]/g;\n  let match;\n\n  while ((match = blockRegex.exec(contentText)) !== null) {\n    const type = match[1] as MessageBlock['type'];\n    const content = match[2];\n\n    if (type === 'character') {\n      // \n      const kvPairs = parseKeyValuePairs(content);\n\n      //  <user> user \n      const characterName = kvPairs[''] || kvPairs['character'] || '';\n      if (characterName === '<user>' || characterName === '{{user}}' || characterName.toLowerCase() === 'user') {\n        //  user \n        const scene = kvPairs[''] || kvPairs['scene'] || currentScene;\n        let messageText = kvPairs[''] || kvPairs[''] || kvPairs['text'] || content;\n\n        // \n        // ** \n        //  \n        const narrationRegex = /([^]+)/g;\n\n        // \n        const narrationMatches: string[] = [];\n        let narrationMatch;\n        while ((narrationMatch = narrationRegex.exec(messageText)) !== null) {\n          narrationMatches.push(narrationMatch[1]);\n        }\n\n        // \n        messageText = messageText.replace(narrationRegex, '').trim();\n\n        // \n        if (scene) {\n          currentScene = scene;\n        }\n\n        // \n        for (const narrationText of narrationMatches) {\n          const narrationBlock: MessageBlock = {\n            type: 'narration',\n            scene,\n            message: narrationText,\n          };\n\n          // \n          if (scene) {\n            const resources = await matchWorldbookResources(undefined, scene, undefined, undefined, undefined);\n            if (resources.sceneImageUrl) {\n              narrationBlock.sceneImageUrl = resources.sceneImageUrl;\n            }\n          }\n\n          blocks.push(narrationBlock);\n        }\n\n        // \n        const block: MessageBlock = {\n          type: 'user',\n          scene,\n          message: messageText,\n        };\n\n        // \n        if (scene) {\n          const resources = await matchWorldbookResources(undefined, scene, undefined, undefined, undefined);\n          if (resources.sceneImageUrl) {\n            block.sceneImageUrl = resources.sceneImageUrl;\n          }\n        }\n\n        blocks.push(block);\n        continue;\n      }\n\n      const block: MessageBlock = {\n        type: 'character',\n      };\n\n      // [[character||||||||||]]\n      block.character = characterName;\n\n      // CGCGCG\n      const cgScene = kvPairs['CG'] || kvPairs['cg'] || kvPairs['CG'] || kvPairs['cg'];\n      if (cgScene) {\n        // CGCG\n        block.scene = cgScene;\n        block.text = kvPairs[''] || kvPairs['text'] || '';\n        block.isCG = true;\n      } else {\n        // \n        block.scene = kvPairs[''] || kvPairs['scene'] || currentScene;\n        block.motion = kvPairs[''] || kvPairs['motion'] || '';\n        block.expression = kvPairs[''] || kvPairs['expression'] || '';\n        block.text = kvPairs[''] || kvPairs['text'] || '';\n        block.isCG = false; //  false\n      }\n\n      // \n      if (!block.scene && currentScene) {\n        block.scene = currentScene;\n      }\n\n      // \n      if (block.scene) {\n        currentScene = block.scene;\n      }\n\n      //  isThrough**\n      //  ** \n\n      // \n      const resources = await matchWorldbookResources(\n        block.character,\n        block.isCG ? undefined : block.scene, // CGCG\n        block.motion,\n        block.expression,\n        block.isCG ? block.scene : undefined, // CGCG\n      );\n      Object.assign(block, resources);\n\n      blocks.push(block);\n    } else if (type === 'narration') {\n      // [[narration||||]]\n      const kvPairs = parseKeyValuePairs(content);\n\n      const scene = kvPairs[''] || kvPairs['scene'] || currentScene;\n      const messageText = kvPairs[''] || kvPairs[''] || kvPairs['text'] || kvPairs[''] || content;\n\n      // \n      if (scene) {\n        currentScene = scene;\n      }\n\n      const block: MessageBlock = {\n        type: 'narration',\n        scene,\n        message: messageText,\n      };\n\n      // \n      if (scene) {\n        const resources = await matchWorldbookResources(undefined, scene, undefined, undefined, undefined);\n        if (resources.sceneImageUrl) {\n          block.sceneImageUrl = resources.sceneImageUrl;\n        }\n      }\n\n      blocks.push(block);\n    } else if (type === 'blacktext') {\n      // [[blacktext||]]\n      const kvPairs = parseKeyValuePairs(content);\n      const messageText = kvPairs[''] || kvPairs['text'] || kvPairs[''] || content;\n\n      blocks.push({\n        type: 'blacktext',\n        message: messageText,\n      });\n    } else if (type === 'user') {\n      // [[user||||]]\n      const kvPairs = parseKeyValuePairs(content);\n\n      const scene = kvPairs[''] || kvPairs['scene'] || currentScene;\n      let messageText = kvPairs[''] || kvPairs[''] || kvPairs[''] || kvPairs['text'] || content;\n\n      // \n      // ** \n      //  \n      const narrationRegex = /([^]+)/g;\n\n      // \n      const narrationMatches: string[] = [];\n      let narrationMatch;\n      while ((narrationMatch = narrationRegex.exec(messageText)) !== null) {\n        narrationMatches.push(narrationMatch[1]);\n      }\n\n      // \n      messageText = messageText.replace(narrationRegex, '').trim();\n\n      //  **  *through*\n\n      // \n      if (scene) {\n        currentScene = scene;\n      }\n\n      // \n      for (const narrationText of narrationMatches) {\n        const narrationBlock: MessageBlock = {\n          type: 'narration',\n          scene,\n          message: narrationText,\n        };\n\n        // \n        if (scene) {\n          const resources = await matchWorldbookResources(undefined, scene, undefined, undefined, undefined);\n          if (resources.sceneImageUrl) {\n            narrationBlock.sceneImageUrl = resources.sceneImageUrl;\n          }\n        }\n\n        blocks.push(narrationBlock);\n      }\n\n      // \n      //  isThrough**\n      const block: MessageBlock = {\n        type: 'user',\n        scene,\n        message: messageText,\n      };\n\n      // \n      if (scene) {\n        const resources = await matchWorldbookResources(undefined, scene, undefined, undefined, undefined);\n        if (resources.sceneImageUrl) {\n          block.sceneImageUrl = resources.sceneImageUrl;\n        }\n      }\n\n      blocks.push(block);\n    } else if (type === 'choice') {\n      // \n      // 1. [[choice||1||||]] - \n      // 2. [[choice||1||2||3]] - AI\n      const kvPairs = parseKeyValuePairs(content);\n\n      // 1\n      const choiceCharacter = kvPairs[''] || kvPairs['character'];\n      const choiceResponse = kvPairs[''] || kvPairs['response'] || kvPairs['text'];\n\n      if (choiceCharacter && choiceResponse) {\n        // 1\n        const choiceText = kvPairs['1'] || kvPairs['1'] || kvPairs['choice1'];\n        if (choiceText) {\n          blocks.push({\n            type: 'choice',\n            choiceText,\n            choiceCharacter,\n            choiceResponse,\n          });\n        }\n      } else {\n        // 2AI\n        const choices: string[] = [];\n        let i = 1;\n        while (kvPairs[`${i}`] || kvPairs[`${i}`] || kvPairs[`choice${i}`]) {\n          const choice = kvPairs[`${i}`] || kvPairs[`${i}`] || kvPairs[`choice${i}`];\n          if (choice) {\n            choices.push(choice);\n          }\n          i++;\n        }\n\n        if (choices.length > 0) {\n          blocks.push({\n            type: 'choice',\n            choices,\n          });\n        }\n      }\n    }\n  }\n\n  //  > \n  //  [[type||...]] \n  let remainingText = contentText;\n  const blockMatches = Array.from(contentText.matchAll(/\\[\\[(\\w+)\\|\\|([^\\]]*)\\]\\]/g));\n  for (const match of blockMatches) {\n    remainingText = remainingText.replace(match[0], '');\n  }\n\n  //  > \n  const lines = remainingText.split('\\n');\n  const noteLines: string[] = [];\n  let inNoteBlock = false;\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const trimmedLine = line.trim();\n\n    //  > \n    if (trimmedLine.startsWith('> ')) {\n      //  > \n      const noteLine = trimmedLine.substring(2);\n      noteLines.push(noteLine);\n      inNoteBlock = true;\n    } else if (inNoteBlock && trimmedLine === '') {\n      // \n      noteLines.push('');\n    } else if (inNoteBlock && !trimmedLine.startsWith('> ')) {\n      //  > \n      if (noteLines.length > 0) {\n        const noteContent = noteLines.join('\\n').trim();\n        if (noteContent) {\n          blocks.push({\n            type: 'note',\n            noteContent,\n          });\n        }\n        noteLines.length = 0;\n      }\n      inNoteBlock = false;\n    }\n  }\n\n  // \n  if (noteLines.length > 0) {\n    const noteContent = noteLines.join('\\n').trim();\n    if (noteContent) {\n      blocks.push({\n        type: 'note',\n        noteContent,\n      });\n    }\n  }\n\n  return blocks;\n}\n\n/**\n * \n * textMappings\n */\nexport function hasMotionAndExpression(\n  characterName: string,\n  motion?: string,\n  expression?: string,\n  live2dModels?: any[],\n): boolean {\n  if (!characterName || !live2dModels || live2dModels.length === 0) {\n    return false;\n  }\n\n  const model = live2dModels.find(m => m.name === characterName);\n  if (!model) {\n    return false;\n  }\n\n  // \n  if (motion) {\n    let hasMotion = false;\n\n    // \n    hasMotion = model.motions?.some((m: any) => {\n      const motionName = typeof m === 'string' ? m : m.name || m.file;\n      return motionName === motion || motionName === `${motion}.motion3.json`;\n    });\n\n    // textMappings\n    if (!hasMotion && model.textMappings?.motion) {\n      for (const [file, mappingText] of Object.entries(model.textMappings.motion)) {\n        // \n        const normalizedMotion = normalizeText(motion);\n        const normalizedMapping = normalizeText(String(mappingText));\n        if (\n          normalizedMotion === normalizedMapping ||\n          normalizedMotion.includes(normalizedMapping) ||\n          normalizedMapping.includes(normalizedMotion)\n        ) {\n          // motions\n          hasMotion = model.motions?.some((m: any) => {\n            const motionFile = typeof m === 'string' ? m : m.file;\n            return motionFile === file || motionFile === `${file}.motion3.json`;\n          });\n          if (hasMotion) break;\n        }\n      }\n    }\n\n    if (!hasMotion) {\n      return false;\n    }\n  }\n\n  // \n  if (expression) {\n    let hasExpression = false;\n\n    // \n    hasExpression = model.expressions?.some((e: any) => {\n      const exprName = typeof e === 'string' ? e : e.name || e.file;\n      return exprName === expression || exprName === `${expression}.exp3.json`;\n    });\n\n    // textMappings\n    if (!hasExpression && model.textMappings?.expression) {\n      for (const [file, mappingText] of Object.entries(model.textMappings.expression)) {\n        // \n        const normalizedExpression = normalizeText(expression);\n        const normalizedMapping = normalizeText(String(mappingText));\n        if (\n          normalizedExpression === normalizedMapping ||\n          normalizedExpression.includes(normalizedMapping) ||\n          normalizedMapping.includes(normalizedExpression)\n        ) {\n          // expressions\n          hasExpression = model.expressions?.some((e: any) => {\n            const exprFile = typeof e === 'string' ? e : e.file;\n            return exprFile === file || exprFile === `${file}.exp3.json`;\n          });\n          if (hasExpression) break;\n        }\n      }\n    }\n\n    if (!hasExpression) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","/**\n * IndexedDB \n *  IndexedDB  Live2D \n */\n\nconst DB_NAME = 'live2d-models-db';\nconst DB_VERSION = 1;\nconst STORE_NAME = 'model-files';\n\n/**\n * \n */\nfunction openDB(): Promise<IDBDatabase> {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n\n    request.onerror = () => reject(request.error);\n    request.onsuccess = () => resolve(request.result);\n\n    request.onupgradeneeded = event => {\n      const db = (event.target as IDBOpenDBRequest).result;\n      if (!db.objectStoreNames.contains(STORE_NAME)) {\n        db.createObjectStore(STORE_NAME, { keyPath: 'id' });\n      }\n    };\n  });\n}\n\n/**\n *  IndexedDB \n */\nexport async function getFile(fileId: string): Promise<File | null> {\n  const db = await openDB();\n\n  return new Promise((resolve, reject) => {\n    const transaction = db.transaction([STORE_NAME], 'readonly');\n    const store = transaction.objectStore(STORE_NAME);\n    const request = store.get(fileId);\n\n    request.onsuccess = () => {\n      const fileData = request.result;\n      if (!fileData) {\n        resolve(null);\n        return;\n      }\n\n      //  ArrayBuffer  File\n      const blob = new Blob([fileData.data], { type: fileData.type });\n      const file = new File([blob], fileData.filename, {\n        type: fileData.type,\n        lastModified: fileData.lastModified,\n      });\n\n      resolve(file);\n    };\n    request.onerror = () => reject(request.error);\n  });\n}\n\n/**\n *  IndexedDB  Blob URL\n */\nexport async function getFileBlobUrl(fileId: string): Promise<string | null> {\n  const file = await getFile(fileId);\n  if (!file) return null;\n\n  return URL.createObjectURL(file);\n}\n\n/**\n * \n */\nexport async function fileExists(fileId: string): Promise<boolean> {\n  const db = await openDB();\n\n  return new Promise((resolve, reject) => {\n    const transaction = db.transaction([STORE_NAME], 'readonly');\n    const store = transaction.objectStore(STORE_NAME);\n    const request = store.get(fileId);\n\n    request.onsuccess = () => {\n      resolve(request.result !== undefined);\n    };\n    request.onerror = () => reject(request.error);\n  });\n}\n\n/**\n *  indexeddb://  URL  ID\n */\nexport function parseIndexedDbUrl(url: string): { modelName: string; filename: string } | null {\n  // indexeddb:///\n  const match = url.match(/^indexeddb:\\/\\/([^/]+)\\/(.+)$/);\n  if (!match) return null;\n\n  return {\n    modelName: match[1],\n    filename: match[2],\n  };\n}\n\n/**\n *  ID\n */\nexport function generateFileId(modelName: string, filename: string): string {\n  return `${modelName}::${filename}`;\n}\n\n/**\n *  indexeddb:// URL  Blob URL\n */\nexport async function getIndexedDbFileUrl(\n  indexedDbUrl: string,\n  fileIds?: Record<string, string>,\n): Promise<string | null> {\n  const parsed = parseIndexedDbUrl(indexedDbUrl);\n  if (!parsed) return null;\n\n  //  fileIds \n  if (fileIds && fileIds[parsed.filename]) {\n    return getFileBlobUrl(fileIds[parsed.filename]);\n  }\n\n  //  fileId\n  const fileId = generateFileId(parsed.modelName, parsed.filename);\n  return getFileBlobUrl(fileId);\n}\n","/**\n * Live2D \n *  Cubism SDK Framework \n */\n\nimport { LAppPal } from './LAppPal';\nimport { PriorityNormal } from './LAppDefine';\n\n// \nenum ModelState {\n  NotLoaded,\n  Loading,\n  Loaded,\n  Error,\n}\n\n/**\n * Live2D \n * \n */\nexport class ModelManager {\n  private _model: any = null; // CubismModel \n  private _modelSetting: any = null; // CubismModelSettingJson \n  private _renderer: any = null; // CubismRenderer \n  private _motionManager: any = null; // CubismMotionManager \n  private _expressionManager: any = null; // CubismExpressionMotionManager \n  private _modelHomeDir: string = '';\n  private _state: ModelState = ModelState.NotLoaded;\n  private _gl: WebGLRenderingContext | null = null;\n  private _canvas: HTMLCanvasElement | null = null;\n  private _motions: Map<string, any> = new Map(); // \n  private _expressions: Map<string, any> = new Map(); // \n  private _modelMatrix: any = null; // \n  private _projectionMatrix: any = null; // \n\n  /**\n   * \n   */\n  async initialize(\n    canvas: HTMLCanvasElement,\n    gl: WebGLRenderingContext,\n    modelUrl: string,\n    basePath: string,\n  ): Promise<void> {\n    this._canvas = canvas;\n    this._gl = gl;\n    this._modelHomeDir = basePath.endsWith('/') ? basePath : basePath + '/';\n    this._state = ModelState.Loading;\n\n    try {\n      //  model3.json\n      const modelSetting = await this.loadModelSetting(modelUrl);\n      this._modelSetting = modelSetting;\n\n      //  Cubism Framework\n      await this.ensureCubismFramework();\n\n      // \n      await this.loadModelData();\n\n      // \n      await this.loadTextures();\n\n      // \n      await this.preloadMotions();\n      await this.preloadExpressions();\n\n      this._state = ModelState.Loaded;\n      console.info('[ModelManager] ');\n    } catch (error) {\n      this._state = ModelState.Error;\n      console.error('[ModelManager] :', error);\n      throw error;\n    }\n  }\n\n  /**\n   *  model3.json\n   */\n  private async loadModelSetting(modelUrl: string): Promise<any> {\n    return new Promise((resolve, reject) => {\n      LAppPal.loadFileAsBytes(modelUrl, (arrayBuffer, size) => {\n        if (size === 0) {\n          reject(new Error('Failed to load model3.json'));\n          return;\n        }\n\n        try {\n          //  Cubism SDK  CubismModelSettingJson\n          //  Framework\n          import('@framework/cubismmodelsettingjson')\n            .then(module => {\n              const { CubismModelSettingJson } = module;\n              const setting = new CubismModelSettingJson(arrayBuffer, size);\n              resolve(setting);\n            })\n            .catch(() => {\n              //  Framework  JSON \n              const json = JSON.parse(new TextDecoder().decode(arrayBuffer));\n              resolve(json);\n            });\n        } catch (error) {\n          reject(error);\n        }\n      });\n    });\n  }\n\n  /**\n   *  Cubism Framework \n   */\n  private async ensureCubismFramework(): Promise<void> {\n    try {\n      const { CubismAdapter } = await import('./CubismAdapter');\n      await CubismAdapter.initialize();\n    } catch (error) {\n      console.warn('[ModelManager] Cubism Framework :', error);\n    }\n  }\n\n  /**\n   * .moc3 \n   */\n  private async loadModelData(): Promise<void> {\n    if (!this._modelSetting || !this._gl) {\n      throw new Error('Model setting or GL context not available');\n    }\n\n    try {\n      //  Cubism SDK  .moc3 \n      const frameworkModule = await import('@framework/model/cubismmoc');\n      const { CubismMoc } = frameworkModule;\n\n      const modelFileName = this._modelSetting.getModelFileName();\n      if (!modelFileName) {\n        throw new Error('Model file name not found in setting');\n      }\n\n      //  .moc3 \n      return new Promise((resolve, reject) => {\n        LAppPal.loadFileAsBytes(`${this._modelHomeDir}${modelFileName}`, async (arrayBuffer, size) => {\n          if (size === 0) {\n            reject(new Error('Failed to load .moc3 file'));\n            return;\n          }\n\n          try {\n            //  MOC\n            const moc = CubismMoc.create(arrayBuffer, size);\n            if (!moc) {\n              reject(new Error('Failed to create MOC'));\n              return;\n            }\n\n            // \n            const modelModule = await import('@framework/model/cubismmodel');\n            const { CubismModel } = modelModule;\n            this._model = CubismModel.create(moc);\n            if (!this._model) {\n              reject(new Error('Failed to create model'));\n              return;\n            }\n\n            // \n            const rendererModule = await import('@framework/rendering/cubismrenderer_webgl');\n            const { CubismRenderer_WebGL } = rendererModule;\n            this._renderer = new CubismRenderer_WebGL();\n            this._renderer.startUp(this._gl);\n\n            // \n            const motionModule = await import('@framework/motion/cubismmotionmanager');\n            const { CubismMotionManager } = motionModule;\n            this._motionManager = new CubismMotionManager();\n\n            // \n            const expressionModule = await import('@framework/motion/cubismexpressionmotionmanager');\n            const { CubismExpressionMotionManager } = expressionModule;\n            this._expressionManager = new CubismExpressionMotionManager();\n\n            // \n            const mathModule = await import('@framework/math/cubismmodelmatrix');\n            const { CubismModelMatrix } = mathModule;\n            this._modelMatrix = new CubismModelMatrix(this._model.getCanvasWidth(), this._model.getCanvasHeight());\n\n            // \n            const matrixModule = await import('@framework/math/cubismmatrix44');\n            const { CubismMatrix44 } = matrixModule;\n            this._projectionMatrix = new CubismMatrix44();\n\n            console.info('[ModelManager] ');\n            resolve();\n          } catch (error) {\n            reject(error);\n          }\n        });\n      });\n    } catch (error) {\n      console.warn('[ModelManager]  Cubism SDK:', error);\n      // \n    }\n  }\n\n  /**\n   * \n   */\n  private async loadTextures(): Promise<void> {\n    if (!this._modelSetting || !this._gl || !this._renderer) {\n      return;\n    }\n\n    try {\n      const textureCount = this._modelSetting.getTextureCount();\n      let loadedCount = 0;\n\n      for (let i = 0; i < textureCount; i++) {\n        const textureFileName = this._modelSetting.getTextureFileName(i);\n        if (!textureFileName) {\n          continue;\n        }\n\n        const texturePath = `${this._modelHomeDir}${textureFileName}`;\n\n        // \n        await new Promise<void>((resolve, reject) => {\n          const img = new Image();\n          img.crossOrigin = 'anonymous';\n          img.onload = () => {\n            try {\n              //  WebGL \n              const texture = this._gl!.createTexture();\n              if (!texture) {\n                reject(new Error('Failed to create texture'));\n                return;\n              }\n\n              this._gl!.bindTexture(this._gl!.TEXTURE_2D, texture);\n              this._gl!.texParameteri(\n                this._gl!.TEXTURE_2D,\n                this._gl!.TEXTURE_MIN_FILTER,\n                this._gl!.LINEAR_MIPMAP_LINEAR,\n              );\n              this._gl!.texParameteri(this._gl!.TEXTURE_2D, this._gl!.TEXTURE_MAG_FILTER, this._gl!.LINEAR);\n              this._gl!.pixelStorei(this._gl!.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1);\n              this._gl!.texImage2D(\n                this._gl!.TEXTURE_2D,\n                0,\n                this._gl!.RGBA,\n                this._gl!.RGBA,\n                this._gl!.UNSIGNED_BYTE,\n                img,\n              );\n              this._gl!.generateMipmap(this._gl!.TEXTURE_2D);\n              this._gl!.bindTexture(this._gl!.TEXTURE_2D, null);\n\n              // \n              this._renderer.bindTexture(i, texture);\n\n              loadedCount++;\n              if (loadedCount >= textureCount) {\n                console.info('[ModelManager] ');\n              }\n              resolve();\n            } catch (error) {\n              reject(error);\n            }\n          };\n          img.onerror = () => {\n            console.warn(`[ModelManager] : ${texturePath}`);\n            loadedCount++;\n            resolve(); // \n          };\n          img.src = texturePath;\n        });\n      }\n    } catch (error) {\n      console.warn('[ModelManager] :', error);\n    }\n  }\n\n  /**\n   * \n   */\n  private async preloadMotions(): Promise<void> {\n    if (!this._modelSetting) {\n      return;\n    }\n\n    try {\n      // \n      const motionGroupCount = this._modelSetting.getMotionGroupCount();\n      for (let i = 0; i < motionGroupCount; i++) {\n        const groupName = this._modelSetting.getMotionGroupName(i);\n        const motionCount = this._modelSetting.getMotionCount(groupName);\n\n        // \n        // \n        console.info(`[ModelManager] : ${groupName}, : ${motionCount}`);\n      }\n    } catch (error) {\n      console.warn('[ModelManager] :', error);\n    }\n  }\n\n  /**\n   * \n   */\n  private async preloadExpressions(): Promise<void> {\n    if (!this._modelSetting) {\n      return;\n    }\n\n    try {\n      // \n      const expressionCount = this._modelSetting.getExpressionCount();\n      console.info(`[ModelManager] : ${expressionCount}`);\n\n      // \n      for (let i = 0; i < expressionCount; i++) {\n        const expressionName = this._modelSetting.getExpressionName(i);\n        const expressionFileName = this._modelSetting.getExpressionFileName(i);\n\n        // \n        LAppPal.loadFileAsBytes(`${this._modelHomeDir}${expressionFileName}`, (arrayBuffer, size) => {\n          if (size === 0) {\n            console.warn(`[ModelManager] : ${expressionFileName}`);\n            return;\n          }\n\n          try {\n            import('@framework/motion/cubismexpressionmotion')\n              .then(({ CubismExpressionMotion }) => {\n                const expression = CubismExpressionMotion.create(arrayBuffer, size);\n                if (expression) {\n                  this._expressions.set(expressionName, expression);\n                  console.info(`[ModelManager] : ${expressionName}`);\n                }\n              })\n              .catch(error => {\n                console.warn(`[ModelManager] : ${expressionName}`, error);\n              });\n          } catch (error) {\n            console.warn(`[ModelManager] : ${expressionName}`, error);\n          }\n        });\n      }\n    } catch (error) {\n      console.warn('[ModelManager] :', error);\n    }\n  }\n\n  /**\n   * \n   */\n  playMotion(group: string, index: number, priority: number = PriorityNormal): void {\n    if (this._state !== ModelState.Loaded) {\n      console.warn('[ModelManager] ');\n      return;\n    }\n\n    if (!this._motionManager || !this._modelSetting) {\n      console.warn('[ModelManager] ');\n      return;\n    }\n\n    try {\n      const motionFileName = this._modelSetting.getMotionFileName(group, index);\n      if (!motionFileName) {\n        console.warn(`[ModelManager] : ${group}_${index}`);\n        return;\n      }\n\n      const motionKey = `${group}_${index}`;\n      let motion = this._motions.get(motionKey);\n\n      if (!motion) {\n        // \n        LAppPal.loadFileAsBytes(`${this._modelHomeDir}${motionFileName}`, (arrayBuffer, size) => {\n          if (size === 0) {\n            console.error(`[ModelManager] : ${motionFileName}`);\n            return;\n          }\n\n          try {\n            import('@framework/motion/cubismmotion')\n              .then(({ CubismMotion }) => {\n                motion = CubismMotion.create(arrayBuffer, size, null);\n                if (motion) {\n                  this._motions.set(motionKey, motion);\n                  this._motionManager.startMotionPriority(motion, false, priority);\n                  console.info(`[ModelManager] : ${motionKey}`);\n                }\n              })\n              .catch(error => {\n                console.error(`[ModelManager] :`, error);\n              });\n          } catch (error) {\n            console.error(`[ModelManager] :`, error);\n          }\n        });\n      } else {\n        // \n        this._motionManager.startMotionPriority(motion, false, priority);\n        console.info(`[ModelManager] : ${motionKey}`);\n      }\n    } catch (error) {\n      console.error('[ModelManager] :', error);\n    }\n  }\n\n  /**\n   * \n   */\n  playExpression(expressionIndex: number): void {\n    if (this._state !== ModelState.Loaded) {\n      console.warn('[ModelManager] ');\n      return;\n    }\n\n    if (!this._expressionManager || !this._modelSetting) {\n      console.warn('[ModelManager] ');\n      return;\n    }\n\n    try {\n      const expressionName = this._modelSetting.getExpressionName(expressionIndex);\n      if (!expressionName) {\n        console.warn(`[ModelManager] : ${expressionIndex}`);\n        return;\n      }\n\n      let expression = this._expressions.get(expressionName);\n\n      if (!expression) {\n        // \n        const expressionFileName = this._modelSetting.getExpressionFileName(expressionIndex);\n        LAppPal.loadFileAsBytes(`${this._modelHomeDir}${expressionFileName}`, (arrayBuffer, size) => {\n          if (size === 0) {\n            console.error(`[ModelManager] : ${expressionFileName}`);\n            return;\n          }\n\n          try {\n            import('@framework/motion/cubismexpressionmotion')\n              .then(({ CubismExpressionMotion }) => {\n                expression = CubismExpressionMotion.create(arrayBuffer, size);\n                if (expression) {\n                  this._expressions.set(expressionName, expression);\n                  this._expressionManager.startMotion(expression, false);\n                  console.info(`[ModelManager] : ${expressionName}`);\n                }\n              })\n              .catch(error => {\n                console.error(`[ModelManager] :`, error);\n              });\n          } catch (error) {\n            console.error(`[ModelManager] :`, error);\n          }\n        });\n      } else {\n        // \n        this._expressionManager.startMotion(expression, false);\n        console.info(`[ModelManager] : ${expressionName}`);\n      }\n    } catch (error) {\n      console.error('[ModelManager] :', error);\n    }\n  }\n\n  /**\n   * \n   */\n  update(deltaTime: number): void {\n    if (this._state !== ModelState.Loaded || !this._model) {\n      return;\n    }\n\n    // \n    if (this._motionManager) {\n      this._motionManager.updateMotion(this._model, deltaTime);\n    }\n\n    // \n    if (this._expressionManager) {\n      this._expressionManager.updateMotion(this._model, deltaTime);\n    }\n\n    // \n    this._model.update();\n  }\n\n  /**\n   * \n   */\n  render(): void {\n    if (this._state !== ModelState.Loaded || !this._model || !this._renderer || !this._gl) {\n      return;\n    }\n\n    // \n    if (this._projectionMatrix && this._canvas) {\n      const width = this._canvas.width;\n      const height = this._canvas.height;\n      this._projectionMatrix.loadIdentity();\n      this._projectionMatrix.scale(height / width, 1.0);\n    }\n\n    // \n    if (this._projectionMatrix && this._modelMatrix) {\n      const viewMatrix = this._projectionMatrix;\n      viewMatrix.multiplyByMatrix(this._modelMatrix);\n      this._renderer.drawModel(this._model, viewMatrix);\n    }\n  }\n\n  /**\n   * \n   */\n  getModel(): any {\n    return this._model;\n  }\n\n  /**\n   * \n   */\n  isLoaded(): boolean {\n    return this._state === ModelState.Loaded;\n  }\n\n  /**\n   * \n   */\n  release(): void {\n    // \n    if (this._model) {\n      this._model.release();\n      this._model = null;\n    }\n\n    if (this._renderer) {\n      this._renderer.release();\n      this._renderer = null;\n    }\n\n    // \n    this._motions.forEach(motion => {\n      if (motion && typeof motion.delete === 'function') {\n        motion.delete();\n      }\n    });\n    this._motions.clear();\n\n    this._expressions.forEach(expression => {\n      if (expression && typeof expression.delete === 'function') {\n        expression.delete();\n      }\n    });\n    this._expressions.clear();\n\n    this._motionManager = null;\n    this._expressionManager = null;\n    this._modelMatrix = null;\n    this._projectionMatrix = null;\n    this._state = ModelState.NotLoaded;\n  }\n}\n","/**\n * \n */\n\n// \nexport const PriorityNone = 0;\nexport const PriorityIdle = 1;\nexport const PriorityNormal = 2;\nexport const PriorityForce = 3;\n\n// \nexport const MotionGroupIdle = 'idle';\n\n// \nexport const DebugLogEnable = false;\n","/**\n * Live2D\n *  Cubism SDK 5  Cubism 3/4/5 \n *\n * \n * -  Cubism Core CDN \n * -  Cubism SDK Framework\n * -  Cubism 3 .model3.json\n * -  WebGL \n */\n\nimport { getIndexedDbFileUrl } from '../../utils/indexedDB';\nimport { CubismAdapter } from './cubism/CubismAdapter';\nimport { PriorityNormal } from './cubism/LAppDefine';\nimport { LAppPal } from './cubism/LAppPal';\nimport { ModelManager } from './cubism/ModelManager';\n\n// Live2D \nexport interface Live2DModelConfig {\n  id: string;\n  name: string;\n  modelPath: string;\n  basePath: string;\n  version: number;\n  motions: Array<{ group: string; name: string; file: string }>;\n  expressions: string[];\n  textures: string[];\n  physics?: string;\n  pose?: string;\n  /**  fileId  IndexedDB  */\n  _fileIds?: Record<string, string>;\n  /**  */\n  defaultAnimation?: {\n    motion?: string;\n    expression?: string;\n    autoLoop?: boolean;\n  };\n}\n\n// Cubism Core \ndeclare global {\n  interface Window {\n    Live2DCubismCore?: any;\n    CubismCore?: any;\n  }\n}\n\n// \nfunction loadScript(src: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const existingScript = document.querySelector(`script[src=\"${src}\"]`);\n    if (existingScript) {\n      setTimeout(() => resolve(), 100);\n      return;\n    }\n\n    const script = document.createElement('script');\n    script.src = src;\n    script.onload = () => {\n      setTimeout(() => resolve(), 100);\n    };\n    script.onerror = () => reject(new Error(`: ${src}`));\n    document.head.appendChild(script);\n  });\n}\n\n//  Cubism Core\nlet cubismCoreInitPromise: Promise<void> | null = null;\n\nasync function initCubismCore(): Promise<void> {\n  if (cubismCoreInitPromise) return cubismCoreInitPromise;\n\n  cubismCoreInitPromise = (async () => {\n    try {\n      //  Cubism CoreCubism 3/4/5 \n      //  CDN\n      if (!window.Live2DCubismCore && !window.CubismCore) {\n        await loadScript('https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js');\n        console.info(' Cubism Core ');\n      } else {\n        console.info(' Cubism Core ');\n      }\n    } catch (error) {\n      cubismCoreInitPromise = null;\n      console.error('Cubism Core :', error);\n      throw error;\n    }\n  })();\n\n  return cubismCoreInitPromise;\n}\n\n//  Cubism Framework  CubismAdapter\n\n/**\n * Live2D \n *  Cubism SDK  Live2D \n */\nexport class Live2DRenderer {\n  private canvas: HTMLCanvasElement | null = null;\n  private gl: WebGLRenderingContext | null = null;\n  private _modelConfig: Live2DModelConfig | null = null;\n  private isInitialized = false;\n  private _currentModelUrl: string | null = null;\n  private _model: any = null; // LAppModel \n  private _modelManager: ModelManager | null = null; // \n  private _renderer: any = null; // CubismRenderer \n  private _animationFrameId: number | null = null;\n  private _lastUpdateTime: number = 0;\n  private _motionManager: any = null; // \n  private _expressionManager: any = null; // \n  private _modelMatrix: any = null; // \n  private _projectionMatrix: any = null; // \n  private _viewMatrix: any = null; // \n  private _scale: number = 1.0;\n  private _positionX: number = 0;\n  private _positionY: number = 0;\n\n  // \n  // \n  private _usePrivateVars(): void {\n    // \n    void this._currentModelUrl;\n    void this._renderer;\n    void this._lastUpdateTime;\n    void this._motionManager;\n    void this._expressionManager;\n    void this._modelMatrix;\n    void this._viewMatrix;\n    void this._scale;\n    void this._positionX;\n    void this._positionY;\n    void this._waitForModelLoad;\n  }\n\n  constructor() {\n    // \n    this._usePrivateVars();\n  }\n  private _subdelegate: any = null; // LAppSubdelegate \n\n  /**\n   * \n   */\n  async init(canvas: HTMLCanvasElement): Promise<void> {\n    if (this.isInitialized) return;\n\n    try {\n      console.info('[Live2DRenderer] canvas:', {\n        exists: !!canvas,\n        width: canvas?.width || canvas?.clientWidth,\n        height: canvas?.height || canvas?.clientHeight,\n      });\n\n      //  Cubism Core\n      console.info('[Live2DRenderer]  Cubism Core...');\n      await initCubismCore();\n      console.info('[Live2DRenderer] Cubism Core ');\n\n      //  Cubism Framework\n      console.info('[Live2DRenderer]  Cubism Framework...');\n      await CubismAdapter.initialize();\n      console.info('[Live2DRenderer] Cubism Framework ');\n\n      this.canvas = canvas;\n\n      //  WebGL \n      const gl = canvas.getContext('webgl', {\n        alpha: true,\n        premultipliedAlpha: false,\n        preserveDrawingBuffer: false,\n      }) as WebGLRenderingContext | null;\n\n      if (!gl) {\n        throw new Error(' WebGL ');\n      }\n\n      this.gl = gl;\n\n      //  WebGL \n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n      gl.clearColor(0.0, 0.0, 0.0, 0.0);\n\n      // \n      const resizeObserver = new ResizeObserver(() => {\n        this.resize();\n      });\n      resizeObserver.observe(canvas);\n\n      //  LAppSubdelegate Framework \n      // \n      // try {\n      //   const { LAppSubdelegate } = await import('../..//CubismSdkForWeb-5-r.4/Samples/TypeScript/Demo/src/lappsubdelegate');\n      //   this._subdelegate = new LAppSubdelegate();\n      //   if (this._subdelegate.initialize(canvas)) {\n      //     console.info('[Live2DRenderer] LAppSubdelegate ');\n      //   }\n      // } catch (error) {\n      //   console.warn('[Live2DRenderer]  LAppSubdelegate:', error);\n      // }\n\n      this.isInitialized = true;\n      console.info('[Live2DRenderer] Live2D');\n    } catch (error) {\n      console.error('Live2D:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * \n   */\n  async loadModel(config: Live2DModelConfig): Promise<void> {\n    if (!this.isInitialized || !this.canvas || !this.gl) {\n      throw new Error('');\n    }\n\n    try {\n      this._modelConfig = config;\n\n      // \n      let modelUrl = config.modelPath;\n      if (!modelUrl.startsWith('http://') && !modelUrl.startsWith('https://')) {\n        modelUrl = config.basePath ? `${config.basePath}${modelUrl}` : modelUrl;\n      }\n\n      //  IndexedDB \n      if (modelUrl.startsWith('indexeddb://')) {\n        console.info(`[Live2DRenderer]  IndexedDB : ${modelUrl}`);\n        const blobUrl = await getIndexedDbFileUrl(modelUrl, config._fileIds);\n        if (!blobUrl) {\n          throw new Error(` IndexedDB : ${modelUrl}`);\n        }\n        modelUrl = blobUrl;\n      }\n\n      console.info(`[Live2DRenderer] : ${modelUrl}`);\n\n      // \n      const modelDir = modelUrl.substring(0, modelUrl.lastIndexOf('/') + 1);\n\n      //  ModelManager \n      try {\n        this._modelManager = new ModelManager();\n        await this._modelManager.initialize(this.canvas, this.gl, modelUrl, modelDir);\n        this._model = this._modelManager.getModel();\n        this._currentModelUrl = modelUrl;\n        console.info(`[Live2DRenderer]  \"${config.name}\" `);\n      } catch (error) {\n        console.error('[Live2DRenderer] :', error);\n        //  ModelManager \n        this._currentModelUrl = modelUrl;\n        throw error;\n      }\n\n      // \n      this.startRenderLoop();\n\n      // \n      if (config.defaultAnimation) {\n        if (config.defaultAnimation.motion) {\n          const motionIndex = config.motions.findIndex(\n            m => m.name === config.defaultAnimation?.motion || m.file === config.defaultAnimation?.motion,\n          );\n          if (motionIndex >= 0) {\n            const motionGroup = config.motions[motionIndex].group || 'idle';\n            this.playMotion(motionGroup, motionIndex);\n          }\n        }\n        if (config.defaultAnimation.expression) {\n          const expressionIndex = config.expressions.findIndex(\n            e => e === config.defaultAnimation?.expression || e.includes(config.defaultAnimation?.expression || ''),\n          );\n          if (expressionIndex >= 0) {\n            this.playExpression(expressionIndex);\n          }\n        }\n      }\n    } catch (error) {\n      console.error(':', error);\n      throw new Error(`: ${error instanceof Error ? error.message : String(error)}`);\n    }\n  }\n\n  /**\n   *  LAppModel\n   */\n  private async _waitForModelLoad(): Promise<void> {\n    if (!this._model) return;\n\n    // \n    return new Promise((resolve, reject) => {\n      let attempts = 0;\n      const maxAttempts = 300; //  30 \n\n      const checkLoad = () => {\n        attempts++;\n\n        //  LAppModel \n        if (this._model && this._model.getModel && this._model.getModel()) {\n          resolve();\n          return;\n        }\n\n        if (attempts >= maxAttempts) {\n          reject(new Error(''));\n          return;\n        }\n\n        setTimeout(checkLoad, 100);\n      };\n\n      checkLoad();\n    });\n  }\n\n  /**\n   * \n   */\n  private startRenderLoop(): void {\n    if (this._animationFrameId !== null) {\n      return; // \n    }\n\n    const render = () => {\n      if (!this.canvas || !this.gl) {\n        return;\n      }\n\n      // \n      LAppPal.updateTime();\n\n      // \n      this.update();\n\n      // \n      this.render();\n\n      this._animationFrameId = requestAnimationFrame(render);\n    };\n\n    this._lastUpdateTime = Date.now();\n    this._animationFrameId = requestAnimationFrame(render);\n  }\n\n  /**\n   * \n   */\n  private stopRenderLoop(): void {\n    if (this._animationFrameId !== null) {\n      cancelAnimationFrame(this._animationFrameId);\n      this._animationFrameId = null;\n    }\n  }\n\n  /**\n   * \n   */\n  private update(): void {\n    if (this._modelManager && this._modelManager.isLoaded()) {\n      const deltaTime = LAppPal.getDeltaTime();\n      this._modelManager.update(deltaTime);\n    } else if (this._model && typeof this._model.update === 'function') {\n      //  update \n      this._model.update();\n    }\n  }\n\n  /**\n   * \n   */\n  private render(): void {\n    if (!this.canvas || !this.gl) {\n      return;\n    }\n\n    const gl = this.gl;\n\n    // \n    gl.clear(gl.COLOR_BUFFER_BIT);\n\n    //  ModelManager \n    if (this._modelManager && this._modelManager.isLoaded()) {\n      this._modelManager.render();\n      return;\n    }\n\n    //  draw \n    if (this._model && typeof this._model.draw === 'function' && this._projectionMatrix) {\n      this._model.draw(this._projectionMatrix);\n      return;\n    }\n\n    if (this._subdelegate && typeof this._subdelegate.update === 'function') {\n      //  Subdelegate \n      this._subdelegate.update();\n      return;\n    }\n  }\n\n  /**\n   * \n   */\n  playMotion(group: string, index: number, priority?: number): void {\n    console.info(`[Live2DRenderer] : =\"${group}\", =${index}, =${priority || PriorityNormal}`);\n\n    //  ModelManager\n    if (this._modelManager && this._modelManager.isLoaded()) {\n      this._modelManager.playMotion(group, index, priority || PriorityNormal);\n      return;\n    }\n\n    //  startMotion \n    if (this._model && typeof this._model.startMotion === 'function') {\n      this._model.startMotion(group, index, priority || PriorityNormal);\n    } else if (this._model && typeof this._model.startRandomMotion === 'function') {\n      // \n      this._model.startRandomMotion(group, priority || PriorityNormal);\n    } else {\n      console.warn('[Live2DRenderer] ');\n    }\n  }\n\n  /**\n   * \n   */\n  playExpression(expressionIndex: number): void {\n    console.info(`[Live2DRenderer] : =${expressionIndex}`);\n\n    //  ModelManager\n    if (this._modelManager && this._modelManager.isLoaded()) {\n      this._modelManager.playExpression(expressionIndex);\n      return;\n    }\n\n    //  setExpression \n    if (this._model && typeof this._model.setExpression === 'function') {\n      //  expressionIndex \n      const expressionName = this._modelConfig?.expressions[expressionIndex];\n      if (expressionName) {\n        this._model.setExpression(expressionName);\n      }\n    } else {\n      console.warn('[Live2DRenderer] ');\n    }\n  }\n\n  /**\n   * \n   */\n  setPosition(x: number, y: number): void {\n    this._positionX = x;\n    this._positionY = y;\n\n    //  ModelManager \n    if (this._modelManager && this._modelManager.isLoaded()) {\n      // ModelManager \n      // \n      const model = this._modelManager.getModel();\n      if (model && model.getModelMatrix) {\n        const modelMatrix = model.getModelMatrix();\n        // \n        // x, y  0-100  -1  1  NDC \n        const ndcX = (x / 100) * 2 - 1;\n        const ndcY = (1 - y / 100) * 2 - 1; // Y\n        modelMatrix.setX(ndcX);\n        modelMatrix.setY(ndcY);\n      }\n    }\n  }\n\n  /**\n   * \n   */\n  setScale(scale: number): void {\n    this._scale = scale;\n\n    //  ModelManager \n    if (this._modelManager && this._modelManager.isLoaded()) {\n      const model = this._modelManager.getModel();\n      if (model && model.getModelMatrix) {\n        const modelMatrix = model.getModelMatrix();\n        modelMatrix.setScale(scale);\n      }\n    }\n  }\n\n  /**\n   * \n   */\n  getModel(): any {\n    return this._model;\n  }\n\n  /**\n   * \n   */\n  isReady(): boolean {\n    return this.isInitialized;\n  }\n\n  /**\n   * \n   */\n  unloadModel(): void {\n    this.stopRenderLoop();\n\n    //  ModelManager\n    if (this._modelManager) {\n      this._modelManager.release();\n      this._modelManager = null;\n    }\n\n    if (this._model && typeof this._model.release === 'function') {\n      this._model.release();\n    }\n\n    this._currentModelUrl = null;\n    this._modelConfig = null;\n    this._model = null;\n    this._renderer = null;\n  }\n\n  /**\n   * \n   */\n  destroy(): void {\n    this.unloadModel();\n\n    if (this._subdelegate && typeof this._subdelegate.release === 'function') {\n      this._subdelegate.release();\n      this._subdelegate = null;\n    }\n\n    if (this.gl) {\n      const loseContext = this.gl.getExtension('WEBGL_lose_context');\n      if (loseContext) {\n        loseContext.loseContext();\n      }\n      this.gl = null;\n    }\n\n    this.canvas = null;\n    this.isInitialized = false;\n  }\n\n  /**\n   * \n   */\n  resize(width?: number, height?: number): void {\n    if (!this.canvas || !this.gl) return;\n\n    const displayWidth = width || this.canvas.clientWidth;\n    const displayHeight = height || this.canvas.clientHeight;\n\n    if (this.canvas.width !== displayWidth || this.canvas.height !== displayHeight) {\n      this.canvas.width = displayWidth;\n      this.canvas.height = displayHeight;\n      this.gl.viewport(0, 0, displayWidth, displayHeight);\n    }\n\n    //  Subdelegate \n    if (this._subdelegate && typeof this._subdelegate.onResize === 'function') {\n      this._subdelegate.onResize();\n    }\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = [\"src\"];\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue';\nimport { Live2DRenderer } from '../lib/renderers/Live2DRenderer';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterSprite',\n    props: {\n        scale: {},\n        positionX: {},\n        positionY: {},\n        spriteType: {},\n        imageUrl: {},\n        live2dModelId: {},\n        live2dModels: {},\n        motion: {},\n        expression: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const spriteContainerRef = ref(null);\n        const live2dCanvasRef = ref(null);\n        let live2dRenderer = null;\n        // \n        let lastMotion = undefined;\n        let lastExpression = undefined;\n        let lastModelId = undefined;\n        // \n        const containerStyle = computed(() => {\n            return {\n                left: `${props.positionX}%`,\n                bottom: `${100 - props.positionY}%`,\n                transform: `translateX(-50%) scale(${props.scale})`,\n                transformOrigin: 'bottom center',\n            };\n        });\n        // \n        function playMotionAndExpression(modelConfig) {\n            if (!live2dRenderer) {\n                return;\n            }\n            // \n            //  defaultAnimationLive2DRenderer \n            // \n            if (props.motion) {\n                // \n                const motionConfig = modelConfig.motions?.find((m) => {\n                    const name = typeof m === 'string' ? m : m.name || m.file;\n                    return name === props.motion || name === `${props.motion}.motion3.json`;\n                });\n                if (motionConfig) {\n                    const group = typeof motionConfig === 'string' ? 'idle' : motionConfig.group || 'idle';\n                    const normalizedGroup = group === 'default' ? 'idle' : group; // 'default'\n                    // 'default''idle'\n                    const groupMotions = modelConfig.motions?.filter((m) => {\n                        const mGroup = typeof m === 'string' ? 'idle' : m.group || 'idle';\n                        const normalizedMGroup = mGroup === 'default' ? 'idle' : mGroup;\n                        return normalizedMGroup === normalizedGroup || mGroup === group;\n                    }) || [];\n                    const index = groupMotions.findIndex((m) => {\n                        const name = typeof m === 'string' ? m : m.name || m.file;\n                        return name === props.motion || name === `${props.motion}.motion3.json`;\n                    });\n                    if (index >= 0) {\n                        live2dRenderer.playMotion(normalizedGroup, index);\n                    }\n                }\n            }\n            // Live2DRenderer \n            // \n            if (props.expression) {\n                // \n                const expressionIndex = modelConfig.expressions?.findIndex((e) => {\n                    const name = typeof e === 'string' ? e : e.name || e.file;\n                    return name === props.expression || name === `${props.expression}.exp3.json`;\n                });\n                if (expressionIndex !== undefined && expressionIndex >= 0) {\n                    live2dRenderer.playExpression(expressionIndex);\n                }\n            }\n            // Live2DRenderer \n        }\n        //  Live2D \n        async function loadLive2dModel() {\n            console.info('[CharacterSprite] loadLive2dModel ', {\n                spriteType: props.spriteType,\n                live2dModelId: props.live2dModelId,\n                hasModels: !!props.live2dModels,\n                modelsLength: props.live2dModels?.length || 0,\n                hasCanvas: !!live2dCanvasRef.value,\n            });\n            if (props.spriteType !== 'live2d' || !props.live2dModelId || !props.live2dModels || !live2dCanvasRef.value) {\n                console.warn('[CharacterSprite] ', {\n                    spriteType: props.spriteType,\n                    live2dModelId: props.live2dModelId,\n                    hasModels: !!props.live2dModels,\n                    hasCanvas: !!live2dCanvasRef.value,\n                });\n                return;\n            }\n            // ID\n            const availableModels = props.live2dModels.map(m => ({ id: m.id, name: m.name }));\n            console.info('[CharacterSprite] :', availableModels);\n            console.info('[CharacterSprite] ID:', props.live2dModelId, ':', typeof props.live2dModelId);\n            //  id  name \n            let modelConfig = props.live2dModels.find(m => m.id === props.live2dModelId);\n            //  id  name \n            if (!modelConfig) {\n                modelConfig = props.live2dModels.find(m => m.name === props.live2dModelId);\n                if (modelConfig) {\n                    console.info(`[CharacterSprite]  name : ${props.live2dModelId} -> ${modelConfig.id}`);\n                }\n            }\n            if (!modelConfig) {\n                console.warn(`[CharacterSprite]  Live2D : ${props.live2dModelId}`, {\n                    requestedId: props.live2dModelId,\n                    requestedIdType: typeof props.live2dModelId,\n                    availableIds: props.live2dModels.map(m => ({ id: m.id, idType: typeof m.id, name: m.name })),\n                    availableIdsString: JSON.stringify(props.live2dModels.map(m => m.id)),\n                    requestedIdString: JSON.stringify(props.live2dModelId),\n                });\n                return;\n            }\n            console.info('[CharacterSprite] :', {\n                id: modelConfig.id,\n                name: modelConfig.name,\n                modelPath: modelConfig.modelPath,\n                basePath: modelConfig.basePath,\n                motionsCount: modelConfig.motions?.length || 0,\n                expressionsCount: modelConfig.expressions?.length || 0,\n            });\n            try {\n                // ID\n                const needReloadModel = lastModelId !== props.live2dModelId;\n                if (needReloadModel) {\n                    // \n                    if (live2dRenderer) {\n                        live2dRenderer.destroy();\n                        live2dRenderer = null;\n                    }\n                    // \n                    console.info('[CharacterSprite]  Live2D ');\n                    live2dRenderer = new Live2DRenderer();\n                    await live2dRenderer.init(live2dCanvasRef.value);\n                    console.info('[CharacterSprite] Live2D ');\n                    await live2dRenderer.loadModel(modelConfig);\n                    console.info('[CharacterSprite] Live2D ');\n                    lastModelId = props.live2dModelId;\n                }\n                // \n                const motionChanged = lastMotion !== props.motion;\n                const expressionChanged = lastExpression !== props.expression;\n                // \n                if (motionChanged || expressionChanged || needReloadModel) {\n                    playMotionAndExpression(modelConfig);\n                    lastMotion = props.motion;\n                    lastExpression = props.expression;\n                }\n            }\n            catch (error) {\n                console.error('[CharacterSprite]  Live2D :', error);\n                console.error('[CharacterSprite] :', {\n                    message: error instanceof Error ? error.message : String(error),\n                    stack: error instanceof Error ? error.stack : undefined,\n                    modelId: props.live2dModelId,\n                    modelConfig: modelConfig ? { id: modelConfig.id, name: modelConfig.name } : null,\n                });\n            }\n        }\n        // IDspriteType\n        watch(() => [props.spriteType, props.live2dModelId, props.live2dModels], async (newVal, oldVal) => {\n            if (props.spriteType === 'live2d') {\n                // IDlive2dlive2d\n                const oldSpriteType = oldVal?.[0];\n                const oldModelId = oldVal?.[1];\n                const modelIdChanged = oldModelId !== props.live2dModelId;\n                const spriteTypeChanged = oldSpriteType !== 'live2d';\n                // IDlive2dlive2d\n                if (modelIdChanged || spriteTypeChanged) {\n                    lastMotion = undefined;\n                    lastExpression = undefined;\n                }\n                //  DOM  canvas \n                await nextTick();\n                loadLive2dModel();\n            }\n            else {\n                //  Live2D \n                if (live2dRenderer) {\n                    live2dRenderer.destroy();\n                    live2dRenderer = null;\n                }\n                lastMotion = undefined;\n                lastExpression = undefined;\n                lastModelId = undefined;\n            }\n        }, { immediate: true });\n        // \n        watch(() => [props.motion, props.expression], () => {\n            if (props.spriteType === 'live2d' && live2dRenderer && props.live2dModelId && props.live2dModels) {\n                // \n                const motionChanged = lastMotion !== props.motion;\n                const expressionChanged = lastExpression !== props.expression;\n                // \n                if (motionChanged || expressionChanged) {\n                    const modelConfig = props.live2dModels.find(m => m.id === props.live2dModelId);\n                    if (modelConfig) {\n                        playMotionAndExpression(modelConfig);\n                        lastMotion = props.motion;\n                        lastExpression = props.expression;\n                    }\n                }\n            }\n        });\n        onMounted(async () => {\n            if (props.spriteType === 'live2d') {\n                //  DOM \n                await nextTick();\n                loadLive2dModel();\n            }\n        });\n        onUnmounted(() => {\n            if (live2dRenderer) {\n                live2dRenderer.destroy();\n                live2dRenderer = null;\n            }\n        });\n        return (_ctx, _cache) => {\n            return (__props.spriteType !== 'none')\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    ref_key: \"spriteContainerRef\",\n                    ref: spriteContainerRef,\n                    class: \"pointer-events-none absolute z-5 transition-all duration-300\",\n                    style: _normalizeStyle(containerStyle.value)\n                }, [\n                    _createCommentVNode(\"  \"),\n                    (__props.spriteType === 'image')\n                        ? (_openBlock(), _createElementBlock(\"img\", {\n                            key: 0,\n                            src: __props.imageUrl,\n                            alt: \"\",\n                            class: \"h-[70vh] w-auto object-contain drop-shadow-2xl\",\n                            draggable: \"false\"\n                        }, null, 8 /* PROPS */, _hoisted_1))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createCommentVNode(\" Live2D  \"),\n                    (__props.spriteType === 'live2d')\n                        ? (_openBlock(), _createElementBlock(\"canvas\", {\n                            key: 1,\n                            ref_key: \"live2dCanvasRef\",\n                            ref: live2dCanvasRef,\n                            class: \"live2d-canvas\"\n                        }, null, 512 /* NEED_PATCH */))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 4 /* STYLE */))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterSprite.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterSprite.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterSprite.vue?vue&type=style&index=0&id=8121c5b4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8121c5b4\"]])\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = _;","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"border-gray-200 flex items-center justify-between border-b px-4 py-3\" };\nconst _hoisted_2 = { class: \"max-h-[calc(85vh-60px)] overflow-y-auto p-4\" };\nconst _hoisted_3 = { class: \"space-y-4\" };\nconst _hoisted_4 = { class: \"flex border-b border-gray-200\" };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = {\n    key: 0,\n    class: \"absolute bottom-0 left-0 right-0 h-1 bg-primary\",\n    style: { \"height\": \"3px\" }\n};\nconst _hoisted_7 = {\n    key: 0,\n    class: \"animate-in fade-in space-y-4 duration-200\"\n};\nconst _hoisted_8 = { class: \"status-info-bar\" };\nconst _hoisted_9 = { class: \"info-item\" };\nconst _hoisted_10 = { class: \"info-item\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"status-values-grid\"\n};\nconst _hoisted_12 = { class: \"value-name\" };\nconst _hoisted_13 = { class: \"value-number\" };\nconst _hoisted_14 = { class: \"status-text-card\" };\nconst _hoisted_15 = { class: \"text-card-row\" };\nconst _hoisted_16 = { class: \"text-card-content\" };\nconst _hoisted_17 = { class: \"text-card-row\" };\nconst _hoisted_18 = { class: \"text-card-content\" };\nconst _hoisted_19 = { class: \"text-card-row\" };\nconst _hoisted_20 = { class: \"text-card-content\" };\nconst _hoisted_21 = { class: \"text-card-row\" };\nconst _hoisted_22 = { class: \"text-card-content\" };\nconst _hoisted_23 = {\n    key: 1,\n    class: \"animate-in fade-in space-y-4 duration-200\"\n};\nimport _ from 'lodash';\nimport { nextTick, onMounted, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterStatusPanel',\n    props: {\n        show: { type: Boolean },\n        messageId: {},\n        statusBlock: {},\n        onClose: { type: Function }\n    },\n    setup(__props) {\n        const props = __props;\n        const activeTab = ref('status');\n        const theaterExpanded = ref(false);\n        const theaterContainer = ref(null);\n        const theaterRendered = ref(false);\n        const isLoading = ref(false);\n        // Tab\n        const tabs = [\n            { id: 'status', name: '' },\n            { id: 'theater', name: '' },\n        ];\n        // \n        const statusData = ref({\n            : '',\n            : '',\n            : '',\n            : '',\n            : '',\n            : '',\n        });\n        // MVU\n        const statusValues = ref({});\n        // MVU \n        async function getMvuStatData() {\n            try {\n                // MVU\n                if (typeof window !== 'undefined' && window.waitGlobalInitialized) {\n                    await window.waitGlobalInitialized('Mvu');\n                }\n                // MVU\n                if (typeof window !== 'undefined' && window.Mvu) {\n                    const mvuData = window.Mvu.getMvuData({\n                        type: 'message',\n                        message_id: props.messageId || 'latest',\n                    });\n                    if (mvuData?.stat_data) {\n                        return mvuData.stat_data;\n                    }\n                }\n            }\n            catch (error) {\n                console.warn('MVU:', error);\n            }\n            return null;\n        }\n        // MVU\n        async function loadStatusFromMvu() {\n            const statData = await getMvuStatData();\n            if (!statData)\n                return false;\n            // \n            const fields = ['', '', '', '', '', '', ''];\n            fields.forEach(field => {\n                const value = _.get(statData, field);\n                if (value !== undefined) {\n                    statusData.value[field] = String(value);\n                }\n            });\n            return true;\n        }\n        // StatusBlock\n        function loadStatusFromBlock() {\n            if (props.statusBlock) {\n                statusData.value = {\n                    ...statusData.value,\n                    ...props.statusBlock,\n                };\n            }\n        }\n        // MVU\n        async function extractStatusValues() {\n            const statData = await getMvuStatData();\n            if (!statData)\n                return;\n            // stat_data..\n            if (statData. && typeof statData. === 'object') {\n                const newValues = {};\n                // \n                Object.keys(statData.).forEach(characterName => {\n                    const characterData = statData.[characterName];\n                    if (characterData && typeof characterData === 'object') {\n                        // \n                        Object.keys(characterData).forEach(attrName => {\n                            const attrValue = characterData[attrName];\n                            if (typeof attrValue === 'number' || (typeof attrValue === 'string' && !isNaN(Number(attrValue)))) {\n                                newValues[attrName] = attrValue;\n                            }\n                        });\n                    }\n                });\n                statusValues.value = newValues;\n            }\n        }\n        // /\n        function toggleTheater() {\n            theaterExpanded.value = !theaterExpanded.value;\n            if (theaterExpanded.value) {\n                // nextTickDOM\n                nextTick(() => {\n                    if (!theaterRendered.value) {\n                        renderTheater();\n                    }\n                });\n            }\n        }\n        // \n        watch(activeTab, newTab => {\n            if (newTab === 'theater') {\n                // \n                theaterExpanded.value = true;\n                nextTick(() => {\n                    renderTheater();\n                });\n            }\n        }, { immediate: true });\n        // \n        function renderTheater() {\n            if (!theaterContainer.value || !statusData.value.) {\n                return;\n            }\n            const rawText = statusData.value.;\n            const container = theaterContainer.value;\n            // \n            container.innerHTML = '';\n            //  :  \n            const matches = [...rawText.matchAll(/([^:]+)[:](.*?)/g)];\n            if (matches.length === 0) {\n                // \n                const emptyMsg = document.createElement('div');\n                emptyMsg.textContent = '';\n                emptyMsg.style.textAlign = 'center';\n                emptyMsg.style.color = '#788a82';\n                emptyMsg.style.padding = '20px';\n                container.appendChild(emptyMsg);\n                theaterRendered.value = true;\n                return;\n            }\n            // \n            // \"\"/\"\"\n            const firstSpeaker = matches[0]?.[1]?.trim() || '';\n            const mainCharacterName = firstSpeaker.split('')[0].split('(')[0]; // \n            matches.forEach(match => {\n                const fullSpeaker = match[1]?.trim(); // OS\n                const content = match[2]?.trim();\n                if (!fullSpeaker || !content)\n                    return;\n                // \n                // {{user}}user - \n                // \n                const speakerName = fullSpeaker.split('')[0].split('(')[0].trim();\n                const isUser = speakerName === '{{user}}' ||\n                    speakerName.toLowerCase() === 'user' ||\n                    speakerName === '' ||\n                    fullSpeaker.includes('{{user}}') ||\n                    fullSpeaker.toLowerCase().includes('user') ||\n                    fullSpeaker.includes('');\n                const bubbleSide = isUser ? 'right' : 'left'; // \n                // \n                const bubbleWrapper = document.createElement('div');\n                bubbleWrapper.style.display = 'flex';\n                bubbleWrapper.style.flexDirection = 'column';\n                bubbleWrapper.style.marginBottom = '16px';\n                bubbleWrapper.style.alignItems = isUser ? 'flex-end' : 'flex-start';\n                // \n                const speakerLabel = document.createElement('div');\n                speakerLabel.textContent = speakerName; // \n                speakerLabel.style.fontSize = '0.75em';\n                speakerLabel.style.color = '#788a82';\n                speakerLabel.style.marginBottom = '4px';\n                speakerLabel.style.padding = '0 8px';\n                // \n                const bubble = document.createElement('div');\n                bubble.classList.add('bubble', bubbleSide);\n                bubble.textContent = content;\n                // \n                bubbleWrapper.appendChild(speakerLabel);\n                bubbleWrapper.appendChild(bubble);\n                container.appendChild(bubbleWrapper);\n            });\n            theaterRendered.value = true;\n        }\n        // \n        async function loadStatusData() {\n            if (isLoading.value)\n                return;\n            isLoading.value = true;\n            try {\n                // \n                statusValues.value = {};\n                theaterRendered.value = false;\n                // MVU\n                const mvuLoaded = await loadStatusFromMvu();\n                // MVU\n                await extractStatusValues();\n                // MVUStatusBlock\n                if (!mvuLoaded) {\n                    loadStatusFromBlock();\n                }\n            }\n            finally {\n                isLoading.value = false;\n            }\n        }\n        // props\n        watch(() => [props.show, props.messageId, props.statusBlock], () => {\n            if (props.show) {\n                loadStatusData();\n            }\n        }, { immediate: true });\n        onMounted(() => {\n            if (props.show) {\n                loadStatusData();\n            }\n        });\n        return (_ctx, _cache) => {\n            return (__props.show)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"absolute inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm\",\n                    onClick: _cache[2] || (_cache[2] =\n                        //@ts-ignore\n                        (...args) => (__props.onClose && __props.onClose(...args)))\n                }, [\n                    _createElementVNode(\"div\", {\n                        class: \"bg-card max-h-[85vh] w-[90%] max-w-md overflow-hidden rounded-xl shadow-2xl\",\n                        onClick: _cache[1] || (_cache[1] = _withModifiers(() => { }, [\"stop\"]))\n                    }, [\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"h2\", { class: \"text-foreground text-lg font-semibold\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"button\", {\n                                class: \"hover:bg-muted rounded-full p-1 transition-colors\",\n                                \"aria-label\": \"\",\n                                onClick: _cache[0] || (_cache[0] =\n                                    //@ts-ignore\n                                    (...args) => (__props.onClose && __props.onClose(...args)))\n                            }, [...(_cache[3] || (_cache[3] = [\n                                    _createElementVNode(\"svg\", {\n                                        class: \"h-5 w-5\",\n                                        fill: \"none\",\n                                        stroke: \"currentColor\",\n                                        viewBox: \"0 0 24 24\"\n                                    }, [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M6 18L18 6M6 6l12 12\"\n                                        })\n                                    ], -1 /* CACHED */)\n                                ]))])\n                        ]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createCommentVNode(\" Tab  -  \"),\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(tabs, (tab) => {\n                                        return _createElementVNode(\"button\", {\n                                            key: tab.id,\n                                            class: _normalizeClass([\n                                                'flex-1 px-4 py-3 text-sm font-medium transition-all relative',\n                                                activeTab.value === tab.id ? 'text-primary' : 'text-muted-foreground hover:text-foreground',\n                                            ]),\n                                            onClick: ($event) => (activeTab.value = tab.id)\n                                        }, [\n                                            _createTextVNode(_toDisplayString(tab.name) + \" \", 1 /* TEXT */),\n                                            _createCommentVNode(\"  \"),\n                                            (activeTab.value === tab.id)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ], 10 /* CLASS, PROPS */, _hoisted_5);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                (activeTab.value === 'status')\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                        _createCommentVNode(\"  \"),\n                                        _createElementVNode(\"div\", _hoisted_8, [\n                                            _createElementVNode(\"div\", _hoisted_9, [\n                                                _cache[5] || (_cache[5] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", null, _toDisplayString(statusData.value. || ''), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_10, [\n                                                _cache[6] || (_cache[6] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", null, _toDisplayString(statusData.value. || ''), 1 /* TEXT */)\n                                            ])\n                                        ]),\n                                        _createCommentVNode(\"  \"),\n                                        (Object.keys(statusValues.value).length > 0)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(statusValues.value, (value, key) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: key,\n                                                        class: \"value-card\"\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_12, _toDisplayString(key), 1 /* TEXT */),\n                                                        _createElementVNode(\"div\", _hoisted_13, _toDisplayString(value), 1 /* TEXT */)\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createCommentVNode(\"  \"),\n                                        _createElementVNode(\"div\", _hoisted_14, [\n                                            _createElementVNode(\"div\", _hoisted_15, [\n                                                _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"text-card-label\" }, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(statusData.value. || ''), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_17, [\n                                                _cache[8] || (_cache[8] = _createElementVNode(\"span\", { class: \"text-card-label\" }, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", _hoisted_18, _toDisplayString(statusData.value. || ''), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_19, [\n                                                _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"text-card-label\" }, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", _hoisted_20, _toDisplayString(statusData.value. || ''), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_21, [\n                                                _cache[10] || (_cache[10] = _createElementVNode(\"span\", { class: \"text-card-label\" }, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", _hoisted_22, _toDisplayString(statusData.value. || ''), 1 /* TEXT */)\n                                            ])\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true),\n                                _createCommentVNode(\"  \"),\n                                (activeTab.value === 'theater')\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [\n                                        _cache[11] || (_cache[11] = _createElementVNode(\"div\", { class: \"theater-title\" }, \"    \", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", {\n                                            ref_key: \"theaterContainer\",\n                                            ref: theaterContainer,\n                                            class: \"theater-bubbles-container overflow-y-auto max-h-[calc(85vh-200px)]\"\n                                        }, null, 512 /* NEED_PATCH */)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterStatusPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterStatusPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterStatusPanel.vue?vue&type=style&index=0&id=5c2698dc&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5c2698dc\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withModifiers as _withModifiers, withKeys as _withKeys, withDirectives as _withDirectives, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = [\"onClick\"];\nconst _hoisted_2 = {\n    key: 1,\n    class: \"flex items-center gap-2\"\n};\nimport { computed, nextTick, ref, watch } from 'vue';\nimport { borderWidthPresets, boxShapePresets, defaultDialogStyle } from '../types/galgame';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ChoiceBox',\n    props: {\n        options: {},\n        customStyle: {},\n        onSelect: { type: Function },\n        onPrev: { type: Function },\n        onNext: { type: Function },\n        onSave: { type: Function }\n    },\n    setup(__props) {\n        const props = __props;\n        const isInputting = ref(false);\n        const inputText = ref('');\n        const selectedCustom = ref(false);\n        const inputRef = ref(null);\n        function handleOptionClick(id) {\n            if (selectedCustom.value) {\n                selectedCustom.value = false;\n            }\n            props.onSelect(id);\n        }\n        function handleCustomClick() {\n            if (!isInputting.value) {\n                isInputting.value = true;\n                nextTick(() => {\n                    inputRef.value?.focus();\n                });\n            }\n            else if (inputText.value.trim() && !selectedCustom.value) {\n                selectedCustom.value = true;\n            }\n            else if (selectedCustom.value) {\n                props.onSelect('custom', inputText.value);\n            }\n        }\n        function handleInputConfirm() {\n            if (inputText.value.trim()) {\n                if (!selectedCustom.value) {\n                    selectedCustom.value = true;\n                }\n                else {\n                    props.onSelect('custom', inputText.value);\n                }\n            }\n        }\n        function handleSave() {\n            if (inputText.value.trim() && props.onSave) {\n                props.onSave(inputText.value.trim());\n                // \n                inputText.value = '';\n                isInputting.value = false;\n                selectedCustom.value = false;\n            }\n        }\n        watch(() => props.options, () => {\n            // \n            isInputting.value = false;\n            inputText.value = '';\n            selectedCustom.value = false;\n        });\n        const dialogStyle = computed(() => props.customStyle || defaultDialogStyle);\n        const boxShape = computed(() => boxShapePresets.find(p => p.id === dialogStyle.value.boxShape) || boxShapePresets[0]);\n        const borderWidthPreset = computed(() => borderWidthPresets.find(p => p.id === dialogStyle.value.borderWidth) || borderWidthPresets[1]);\n        const isPillShape = computed(() => dialogStyle.value.boxShape === 'pill');\n        function handleBackgroundClick(e) {\n            const rect = e.currentTarget.getBoundingClientRect();\n            const clickX = e.clientX - rect.left;\n            const halfWidth = rect.width / 2;\n            if (clickX < halfWidth) {\n                // \n                props.onPrev?.();\n            }\n            else {\n                // \n                props.onNext?.();\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"absolute inset-0 z-25 flex items-center justify-center bg-black/30 backdrop-blur-sm\",\n                onClick: handleBackgroundClick\n            }, [\n                _createElementVNode(\"div\", {\n                    class: \"flex w-full max-w-md flex-col gap-3 px-6\",\n                    onClick: _cache[2] || (_cache[2] = _withModifiers(() => { }, [\"stop\"]))\n                }, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.options, (option, index) => {\n                        return (_openBlock(), _createElementBlock(\"button\", {\n                            key: option.id,\n                            class: \"w-full p-4 text-left transition-all hover:scale-[1.02] active:scale-[0.98]\",\n                            style: _normalizeStyle({\n                                backgroundColor: isPillShape.value ? 'rgba(255, 255, 255, 0.7)' : dialogStyle.value.colors.boxBackground,\n                                borderRadius: boxShape.value.borderRadius,\n                                borderTopWidth: borderWidthPreset.value.width,\n                                borderLeftWidth: borderWidthPreset.value.width,\n                                borderRightWidth: borderWidthPreset.value.width,\n                                borderBottomWidth: borderWidthPreset.value.width,\n                                borderStyle: 'solid',\n                                borderColor: dialogStyle.value.colors.boxBorder,\n                                boxShadow: boxShape.value.shadow,\n                                color: dialogStyle.value.colors.dialogText,\n                                fontSize: `${dialogStyle.value.fontSize}px`,\n                                backdropFilter: isPillShape.value ? 'blur(12px)' : undefined,\n                                WebkitBackdropFilter: isPillShape.value ? 'blur(12px)' : undefined,\n                            }),\n                            onClick: () => handleOptionClick(option.id)\n                        }, _toDisplayString(option.text), 13 /* TEXT, STYLE, PROPS */, _hoisted_1));\n                    }), 128 /* KEYED_FRAGMENT */)),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"div\", {\n                        class: _normalizeClass(['w-full p-4 transition-all cursor-pointer', selectedCustom.value ? 'ring-2 ring-primary' : '']),\n                        style: _normalizeStyle({\n                            backgroundColor: isPillShape.value ? 'rgba(255, 255, 255, 0.7)' : dialogStyle.value.colors.boxBackground,\n                            borderRadius: boxShape.value.borderRadius,\n                            borderTopWidth: borderWidthPreset.value.width,\n                            borderLeftWidth: borderWidthPreset.value.width,\n                            borderRightWidth: borderWidthPreset.value.width,\n                            borderBottomWidth: borderWidthPreset.value.width,\n                            borderStyle: 'solid',\n                            borderColor: dialogStyle.value.colors.boxBorder,\n                            boxShadow: boxShape.value.shadow,\n                            fontSize: `${dialogStyle.value.fontSize}px`,\n                            backdropFilter: isPillShape.value ? 'blur(12px)' : undefined,\n                            WebkitBackdropFilter: isPillShape.value ? 'blur(12px)' : undefined,\n                        }),\n                        onClick: handleCustomClick\n                    }, [\n                        (!isInputting.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"flex items-center gap-2\",\n                                style: _normalizeStyle({ color: dialogStyle.value.colors.narrationText })\n                            }, [...(_cache[3] || (_cache[3] = [\n                                    _createElementVNode(\"svg\", {\n                                        class: \"h-4 w-4\",\n                                        fill: \"none\",\n                                        stroke: \"currentColor\",\n                                        viewBox: \"0 0 24 24\"\n                                    }, [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"\n                                        })\n                                    ], -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"...\", -1 /* CACHED */)\n                                ]))], 4 /* STYLE */))\n                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                                _withDirectives(_createElementVNode(\"input\", {\n                                    ref_key: \"inputRef\",\n                                    ref: inputRef,\n                                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((inputText).value = $event)),\n                                    type: \"text\",\n                                    placeholder: \"...\",\n                                    class: \"flex-1 bg-transparent outline-none\",\n                                    style: _normalizeStyle({ color: dialogStyle.value.colors.dialogText }),\n                                    onClick: _cache[1] || (_cache[1] = _withModifiers(() => { }, [\"stop\"])),\n                                    onKeydown: _withKeys(handleInputConfirm, [\"enter\"]),\n                                    autofocus: \"\"\n                                }, null, 36 /* STYLE, NEED_HYDRATION */), [\n                                    [_vModelText, inputText.value]\n                                ]),\n                                _createCommentVNode(\" / \"),\n                                (inputText.value.trim())\n                                    ? (_openBlock(), _createElementBlock(\"svg\", {\n                                        key: 0,\n                                        class: \"h-5 w-5 transition-colors cursor-pointer\",\n                                        style: _normalizeStyle({ color: selectedCustom.value ? dialogStyle.value.colors.nameText : dialogStyle.value.colors.narrationText }),\n                                        fill: \"none\",\n                                        stroke: \"currentColor\",\n                                        viewBox: \"0 0 24 24\",\n                                        onClick: _withModifiers(handleInputConfirm, [\"stop\"])\n                                    }, [...(_cache[4] || (_cache[4] = [\n                                            _createElementVNode(\"path\", {\n                                                \"stroke-linecap\": \"round\",\n                                                \"stroke-linejoin\": \"round\",\n                                                \"stroke-width\": \"2\",\n                                                d: \"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\n                                            }, null, -1 /* CACHED */)\n                                        ]))], 4 /* STYLE */))\n                                    : _createCommentVNode(\"v-if\", true),\n                                _createCommentVNode(\"  \"),\n                                (inputText.value.trim())\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 1,\n                                        class: \"p-1 transition-colors hover:opacity-80\",\n                                        style: _normalizeStyle({ color: dialogStyle.value.colors.nameText }),\n                                        \"aria-label\": \"\",\n                                        title: \"\",\n                                        onClick: _withModifiers(handleSave, [\"stop\"])\n                                    }, [...(_cache[5] || (_cache[5] = [\n                                            _createElementVNode(\"svg\", {\n                                                class: \"h-5 w-5\",\n                                                fill: \"none\",\n                                                stroke: \"currentColor\",\n                                                viewBox: \"0 0 24 24\"\n                                            }, [\n                                                _createElementVNode(\"path\", {\n                                                    \"stroke-linecap\": \"round\",\n                                                    \"stroke-linejoin\": \"round\",\n                                                    \"stroke-width\": \"2\",\n                                                    d: \"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12\"\n                                                })\n                                            ], -1 /* CACHED */)\n                                        ]))], 4 /* STYLE */))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]))\n                    ], 6 /* CLASS, STYLE */)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ChoiceBox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ChoiceBox.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, toDisplayString as _toDisplayString, resolveDynamicComponent as _resolveDynamicComponent, createBlock as _createBlock, vModelText as _vModelText, withDirectives as _withDirectives, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = { class: \"absolute bottom-0 left-0 right-0 z-20 px-4 md:px-8 pb-4 md:pb-6\" };\nconst _hoisted_2 = { class: \"flex items-center gap-2 md:gap-4 max-w-4xl mx-auto\" };\nconst _hoisted_3 = [\"disabled\"];\nconst _hoisted_4 = {\n    key: 0,\n    class: \"absolute left-2 top-1/2 -translate-y-1/2 z-10\"\n};\nconst _hoisted_5 = [\"disabled\"];\nconst _hoisted_6 = {\n    key: 0,\n    class: \"ml-auto flex gap-2\"\n};\nconst _hoisted_7 = [\"innerHTML\"];\nconst _hoisted_8 = { class: \"absolute bottom-3 right-4\" };\nconst _hoisted_9 = {\n    key: 2,\n    class: \"absolute right-2 top-1/2 -translate-y-1/2 z-10\"\n};\nconst _hoisted_10 = [\"disabled\"];\nconst _hoisted_11 = [\"disabled\"];\nconst _hoisted_12 = { class: \"flex gap-3 mt-4 justify-end\" };\nimport { computed, h, nextTick, onMounted, onUnmounted, ref, watch } from 'vue';\nimport { arrowShapePresets, backgroundPatternPresets, borderWidthPresets, boxShapePresets, defaultDialogStyle, indicatorShapePresets, nameShapePresets, } from '../types/galgame';\nconst TYPING_SPEED = 50;\n// narration\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DialogBox',\n    props: {\n        character: {},\n        text: {},\n        isLastDialogue: { type: Boolean },\n        isFirstDialogue: { type: Boolean },\n        onPrev: { type: Function },\n        onNext: { type: Function },\n        dialogKey: {},\n        customStyle: {},\n        isLoading: { type: Boolean },\n        streamingText: {},\n        isThrough: { type: Boolean },\n        isEditable: { type: Boolean },\n        messageId: {},\n        onEdit: { type: Function },\n        onDelete: { type: Function }\n    },\n    setup(__props) {\n        const props = __props;\n        const displayedText = ref('');\n        const isTyping = ref(true);\n        let typingTimer = null;\n        const textContentRef = ref(null);\n        const needsWrapping = ref(false);\n        // \n        const narrationJustifyClass = computed(() => {\n            return needsWrapping.value ? 'justify-start' : 'justify-center';\n        });\n        const dialogStyle = computed(() => props.customStyle || defaultDialogStyle);\n        const boxShape = computed(() => boxShapePresets.find(p => p.id === dialogStyle.value.boxShape) || boxShapePresets[0]);\n        const nameShape = computed(() => nameShapePresets.find(p => p.id === dialogStyle.value.nameShape) || nameShapePresets[0]);\n        const arrowShape = computed(() => arrowShapePresets.find(p => p.id === dialogStyle.value.arrowShape) || arrowShapePresets[0]);\n        const indicatorShape = computed(() => indicatorShapePresets.find(p => p.id === dialogStyle.value.indicatorShape) || indicatorShapePresets[0]);\n        const borderWidth = computed(() => borderWidthPresets.find(p => p.id === dialogStyle.value.borderWidth) || borderWidthPresets[1]);\n        const bgPattern = computed(() => backgroundPatternPresets.find(p => p.id === dialogStyle.value.backgroundPattern));\n        const isNarration = computed(() => !props.character || props.character.trim() === '');\n        const isInnerArrow = computed(() => arrowShape.value.isInner);\n        const isMinimalArrow = computed(() => arrowShape.value.type === 'minimal');\n        const isPillShape = computed(() => dialogStyle.value.boxShape === 'pill');\n        // \n        const getPatternStyle = computed(() => {\n            if (!bgPattern.value?.pattern)\n                return {};\n            const borderColorForPattern = dialogStyle.value.colors.boxBorder.replace(/[\\d.]+\\)$/, '0.08)');\n            const patternWithColor = bgPattern.value.pattern.replace(/VAR_BORDER_COLOR/g, borderColorForPattern);\n            let backgroundSize = '20px 20px';\n            if (bgPattern.value.id === 'dots')\n                backgroundSize = '16px 16px';\n            if (bgPattern.value.id === 'diamonds')\n                backgroundSize = '16px 16px';\n            if (bgPattern.value.id === 'stripes')\n                backgroundSize = '28px 28px';\n            return {\n                backgroundImage: patternWithColor,\n                backgroundSize,\n            };\n        });\n        const boxStyle = computed(() => {\n            const style = {\n                backgroundColor: isPillShape.value ? 'rgba(255, 255, 255, 0.7)' : dialogStyle.value.colors.boxBackground,\n                borderRadius: boxShape.value.borderRadius,\n                borderTopWidth: borderWidth.value.width,\n                borderLeftWidth: borderWidth.value.width,\n                borderRightWidth: borderWidth.value.width,\n                borderBottomWidth: borderWidth.value.width,\n                borderStyle: 'solid',\n                borderColor: dialogStyle.value.colors.boxBorder,\n                boxShadow: boxShape.value.shadow,\n                ...(isPillShape.value ? { backdropFilter: 'blur(12px)', WebkitBackdropFilter: 'blur(12px)' } : {}),\n                ...getPatternStyle.value,\n            };\n            return style;\n        });\n        const outerArrowStyle = computed(() => {\n            const isDisabled = props.isFirstDialogue || props.isLastDialogue;\n            const iconColor = isDisabled ? `${dialogStyle.value.colors.arrowIcon}66` : dialogStyle.value.colors.arrowIcon;\n            if (isMinimalArrow.value) {\n                return {\n                    color: iconColor,\n                };\n            }\n            const bgColor = dialogStyle.value.colors.arrowBackground;\n            let borderRadius = '9999px';\n            if (arrowShape.value.type === 'square' || arrowShape.value.type === 'inner-square')\n                borderRadius = '6px';\n            if (arrowShape.value.type === 'pill')\n                borderRadius = '16px';\n            return {\n                backgroundColor: bgColor,\n                borderRadius,\n                color: iconColor,\n            };\n        });\n        const innerLeftArrowStyle = computed(() => {\n            const isDisabled = props.isFirstDialogue;\n            const iconColor = isDisabled ? `${dialogStyle.value.colors.arrowIcon}66` : dialogStyle.value.colors.arrowIcon;\n            const isRound = arrowShape.value.type === 'inner-round';\n            return {\n                background: isRound ? dialogStyle.value.colors.arrowBackground : 'transparent',\n                color: iconColor,\n            };\n        });\n        const innerRightArrowStyle = computed(() => {\n            const isDisabled = props.isLastDialogue;\n            const iconColor = isDisabled ? `${dialogStyle.value.colors.arrowIcon}66` : dialogStyle.value.colors.arrowIcon;\n            const isRound = arrowShape.value.type === 'inner-round';\n            return {\n                background: isRound ? dialogStyle.value.colors.arrowBackground : 'transparent',\n                color: iconColor,\n            };\n        });\n        // \n        const indicatorComponent = computed(() => {\n            const { type } = indicatorShape.value;\n            const { indicatorColor } = dialogStyle.value.colors;\n            if (type === 'none')\n                return null;\n            // \n            const isStreaming = props.isLoading || false;\n            if (type === 'dots') {\n                return h('div', { class: 'flex gap-1 items-center' }, [0, 1, 2].map(i => h('span', {\n                    key: i,\n                    class: 'w-1.5 h-1.5 rounded-full transition-opacity duration-500',\n                    style: {\n                        backgroundColor: indicatorColor,\n                        opacity: isStreaming ? (i === 2 ? 1 : 0.4) : 0.6,\n                        animation: isStreaming && i === 2 ? 'pulse 1s ease-in-out infinite' : undefined,\n                    },\n                })));\n            }\n            if (type === 'diamonds') {\n                return h('div', { class: 'flex gap-1 items-center' }, [0, 1, 2].map(i => h('span', {\n                    key: i,\n                    class: 'transition-all duration-300',\n                    style: {\n                        width: '8px',\n                        height: '8px',\n                        backgroundColor: indicatorColor,\n                        opacity: isStreaming ? (i === 2 ? 1 : 0.3 + i * 0.15) : 0.5,\n                        transform: `rotate(45deg) scale(${isStreaming && i === 2 ? 1.1 : 0.9})`,\n                        animation: isStreaming && i === 2 ? 'diamondPulse 1.2s ease-in-out infinite' : undefined,\n                        display: 'inline-block',\n                    },\n                })));\n            }\n            if (type === 'pulse') {\n                return h('div', { class: 'relative w-3 h-3' }, [\n                    h('span', {\n                        class: 'absolute inset-0 rounded-full',\n                        style: {\n                            backgroundColor: indicatorColor,\n                            opacity: 0.4,\n                            animation: isStreaming ? 'ping 1.5s cubic-bezier(0, 0, 0.2, 1) infinite' : undefined,\n                        },\n                    }),\n                    h('span', {\n                        class: 'absolute inset-0 rounded-full',\n                        style: {\n                            backgroundColor: indicatorColor,\n                            animation: isStreaming ? 'pulse 2s ease-in-out infinite' : undefined,\n                        },\n                    }),\n                ]);\n            }\n            if (type === 'arrow') {\n                return h('svg', {\n                    class: 'w-4 h-4 transition-transform duration-300',\n                    style: {\n                        color: indicatorColor,\n                        animation: isStreaming ? 'arrowBounce 0.8s ease-in-out infinite' : undefined,\n                    },\n                    fill: 'none',\n                    stroke: 'currentColor',\n                    viewBox: '0 0 24 24',\n                }, [\n                    h('path', {\n                        'stroke-linecap': 'round',\n                        'stroke-linejoin': 'round',\n                        'stroke-width': '2',\n                        d: 'M9 5l7 7-7 7',\n                    }),\n                ]);\n            }\n            return null;\n        });\n        function handlePrev() {\n            if (!props.isFirstDialogue) {\n                props.onPrev();\n            }\n        }\n        function handleNext() {\n            if (!props.isLastDialogue) {\n                props.onNext();\n            }\n        }\n        //  ** \n        function formatTextWithThoughts(text) {\n            if (!text)\n                return '';\n            //  ** \n            //  **  *through* \n            return text.replace(/\\*([^*]+)\\*/g, (match, content) => {\n                //  *through* \n                if (content.trim() === 'through')\n                    return match;\n                // \n                return ` <span style=\"color: #9ca3af; font-style: italic;\">${content}</span> `;\n            });\n        }\n        // \n        function formatTextWithCursor(text, showCursor) {\n            const formattedText = formatTextWithThoughts(text);\n            if (showCursor) {\n                // \n                //  display: inline \n                return formattedText + '<span class=\"animate-pulse\" style=\"display: inline; margin-left: 2px;\">|</span>';\n            }\n            return formattedText;\n        }\n        function clearTypingTimer() {\n            if (typingTimer) {\n                clearInterval(typingTimer);\n                typingTimer = null;\n            }\n        }\n        function startTyping() {\n            clearTypingTimer();\n            if (props.isLoading) {\n                displayedText.value = props.text;\n                isTyping.value = true;\n                return;\n            }\n            if (!props.text) {\n                displayedText.value = '';\n                isTyping.value = false;\n                return;\n            }\n            displayedText.value = '';\n            isTyping.value = true;\n            let index = 0;\n            typingTimer = setInterval(() => {\n                if (index < props.text.length) {\n                    displayedText.value = props.text.slice(0, index + 1);\n                    index++;\n                }\n                else {\n                    isTyping.value = false;\n                    clearTypingTimer();\n                }\n            }, TYPING_SPEED);\n        }\n        // \n        function checkTextWrapping() {\n            if (!isNarration.value || !textContentRef.value) {\n                needsWrapping.value = false;\n                return;\n            }\n            nextTick(() => {\n                if (!textContentRef.value)\n                    return;\n                const element = textContentRef.value;\n                const span = element.querySelector('span');\n                if (!span || !displayedText.value) {\n                    needsWrapping.value = false;\n                    return;\n                }\n                // padding\n                const containerWidth = element.offsetWidth;\n                const paddingLeft = parseInt(getComputedStyle(element).paddingLeft) || 0;\n                const paddingRight = parseInt(getComputedStyle(element).paddingRight) || 0;\n                const availableWidth = containerWidth - paddingLeft - paddingRight;\n                if (availableWidth <= 0) {\n                    needsWrapping.value = false;\n                    return;\n                }\n                // \n                const tempDiv = document.createElement('div');\n                tempDiv.style.visibility = 'hidden';\n                tempDiv.style.position = 'absolute';\n                tempDiv.style.top = '-9999px';\n                tempDiv.style.left = '-9999px';\n                tempDiv.style.width = `${availableWidth}px`;\n                tempDiv.style.fontSize = `${dialogStyle.value.fontSize}px`;\n                tempDiv.style.fontStyle = 'italic';\n                tempDiv.style.fontFamily = getComputedStyle(element).fontFamily;\n                tempDiv.style.lineHeight = getComputedStyle(element).lineHeight;\n                tempDiv.style.textAlign = 'center';\n                tempDiv.style.whiteSpace = 'normal';\n                tempDiv.style.wordWrap = 'break-word';\n                tempDiv.style.overflowWrap = 'break-word';\n                // innerHTML\n                const textContent = span.innerHTML || '';\n                // \n                const cleanContent = textContent.replace(/<span[^>]*class=\"[^\"]*animate-pulse[^\"]*\"[^>]*>.*?<\\/span>/gi, '');\n                tempDiv.innerHTML = cleanContent || 'M';\n                document.body.appendChild(tempDiv);\n                // \n                const singleLineDiv = document.createElement('div');\n                singleLineDiv.style.visibility = 'hidden';\n                singleLineDiv.style.position = 'absolute';\n                singleLineDiv.style.top = '-9999px';\n                singleLineDiv.style.left = '-9999px';\n                singleLineDiv.style.width = `${availableWidth}px`;\n                singleLineDiv.style.fontSize = `${dialogStyle.value.fontSize}px`;\n                singleLineDiv.style.fontStyle = 'italic';\n                singleLineDiv.style.fontFamily = getComputedStyle(element).fontFamily;\n                singleLineDiv.style.lineHeight = getComputedStyle(element).lineHeight;\n                singleLineDiv.style.textAlign = 'center';\n                singleLineDiv.style.whiteSpace = 'nowrap';\n                singleLineDiv.textContent = 'M';\n                document.body.appendChild(singleLineDiv);\n                const singleLineHeight = singleLineDiv.offsetHeight;\n                const actualHeight = tempDiv.offsetHeight;\n                document.body.removeChild(tempDiv);\n                document.body.removeChild(singleLineDiv);\n                // \n                needsWrapping.value = actualHeight > singleLineHeight * 1.3;\n            });\n        }\n        watch(() => [props.text, props.dialogKey, props.isLoading], () => {\n            startTyping();\n        }, { immediate: true });\n        watch(() => displayedText.value, () => {\n            if (isNarration.value) {\n                //  setTimeout  DOM \n                setTimeout(() => {\n                    checkTextWrapping();\n                }, 10);\n            }\n        });\n        onMounted(() => {\n            startTyping();\n            if (isNarration.value) {\n                checkTextWrapping();\n            }\n        });\n        onUnmounted(() => {\n            clearTypingTimer();\n        });\n        // /\n        const showEditDialog = ref(false);\n        const editText = ref('');\n        function handleEdit() {\n            if (props.messageId === undefined)\n                return;\n            editText.value = props.text;\n            showEditDialog.value = true;\n        }\n        function handleDelete() {\n            if (props.messageId === undefined || !props.onDelete)\n                return;\n            if (confirm('')) {\n                props.onDelete(props.messageId);\n            }\n        }\n        function confirmEdit() {\n            if (props.messageId === undefined || !props.onEdit)\n                return;\n            if (editText.value.trim()) {\n                props.onEdit(props.messageId, editText.value.trim());\n                showEditDialog.value = false;\n            }\n        }\n        function cancelEdit() {\n            showEditDialog.value = false;\n            editText.value = '';\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(_Fragment, null, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        (!isInnerArrow.value)\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 0,\n                                disabled: __props.isFirstDialogue,\n                                class: _normalizeClass([\n                                    'flex flex-shrink-0 items-center justify-center transition-all duration-200',\n                                    __props.isFirstDialogue ? 'cursor-not-allowed opacity-40' : 'hover:scale-105',\n                                ]),\n                                style: _normalizeStyle(outerArrowStyle.value),\n                                \"aria-label\": \"\",\n                                onClick: _withModifiers(handlePrev, [\"stop\"])\n                            }, [...(_cache[2] || (_cache[2] = [\n                                    _createElementVNode(\"svg\", {\n                                        class: \"h-5 w-5\",\n                                        fill: \"none\",\n                                        stroke: \"currentColor\",\n                                        viewBox: \"0 0 24 24\"\n                                    }, [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M15 19l-7-7 7-7\"\n                                        })\n                                    ], -1 /* CACHED */)\n                                ]))], 14 /* CLASS, STYLE, PROPS */, _hoisted_3))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", {\n                            class: _normalizeClass([\"flex-1 relative p-4 md:p-5 min-h-[120px]\", [isNarration.value ? 'flex flex-col' : '']]),\n                            style: _normalizeStyle(boxStyle.value)\n                        }, [\n                            _createCommentVNode(\"  \"),\n                            (isInnerArrow.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                                    _createElementVNode(\"button\", {\n                                        disabled: __props.isFirstDialogue,\n                                        class: _normalizeClass([\n                                            'flex items-center justify-center transition-all duration-200',\n                                            __props.isFirstDialogue ? 'cursor-not-allowed opacity-40' : 'hover:bg-opacity-100',\n                                        ]),\n                                        style: _normalizeStyle(innerLeftArrowStyle.value),\n                                        \"aria-label\": \"\",\n                                        onClick: _withModifiers(handlePrev, [\"stop\"])\n                                    }, [...(_cache[3] || (_cache[3] = [\n                                            _createElementVNode(\"svg\", {\n                                                class: \"h-5 w-5\",\n                                                fill: \"none\",\n                                                stroke: \"currentColor\",\n                                                viewBox: \"0 0 24 24\"\n                                            }, [\n                                                _createElementVNode(\"path\", {\n                                                    \"stroke-linecap\": \"round\",\n                                                    \"stroke-linejoin\": \"round\",\n                                                    \"stroke-width\": \"2\",\n                                                    d: \"M15 19l-7-7 7-7\"\n                                                })\n                                            ], -1 /* CACHED */)\n                                        ]))], 14 /* CLASS, STYLE, PROPS */, _hoisted_5)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  \"),\n                            (!isNarration.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", {\n                                    key: 1,\n                                    class: \"h-6 mb-2 flex items-start\",\n                                    style: _normalizeStyle({\n                                        paddingLeft: isInnerArrow.value ? '48px' : 0,\n                                        paddingRight: isInnerArrow.value ? '48px' : 0,\n                                    })\n                                }, [\n                                    _createElementVNode(\"div\", {\n                                        class: \"px-3 py-1 text-sm font-medium\",\n                                        style: _normalizeStyle({\n                                            backgroundColor: dialogStyle.value.colors.nameBackground,\n                                            color: dialogStyle.value.colors.nameText,\n                                            borderRadius: nameShape.value.borderRadius,\n                                            borderBottom: nameShape.value.style === 'underline' ? `2px solid ${dialogStyle.value.colors.nameText}` : undefined,\n                                            boxShadow: nameShape.value.style === 'floating' ? '0 2px 8px rgba(0,0,0,0.1)' : undefined,\n                                        })\n                                    }, _toDisplayString(__props.character), 5 /* TEXT, STYLE */),\n                                    _createCommentVNode(\" /user \"),\n                                    (props.isEditable && props.messageId !== undefined)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                                            _createElementVNode(\"button\", {\n                                                onClick: _withModifiers(handleEdit, [\"stop\"]),\n                                                class: \"p-1 rounded transition-colors hover:bg-black/10\",\n                                                \"aria-label\": \"\",\n                                                title: \"\"\n                                            }, [...(_cache[4] || (_cache[4] = [\n                                                    _createElementVNode(\"svg\", {\n                                                        class: \"h-4 w-4\",\n                                                        fill: \"none\",\n                                                        stroke: \"currentColor\",\n                                                        viewBox: \"0 0 24 24\"\n                                                    }, [\n                                                        _createElementVNode(\"path\", {\n                                                            \"stroke-linecap\": \"round\",\n                                                            \"stroke-linejoin\": \"round\",\n                                                            \"stroke-width\": \"2\",\n                                                            d: \"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"\n                                                        })\n                                                    ], -1 /* CACHED */)\n                                                ]))]),\n                                            _createElementVNode(\"button\", {\n                                                onClick: _withModifiers(handleDelete, [\"stop\"]),\n                                                class: \"p-1 rounded transition-colors hover:bg-red-500/20\",\n                                                \"aria-label\": \"\",\n                                                title: \"\"\n                                            }, [...(_cache[5] || (_cache[5] = [\n                                                    _createElementVNode(\"svg\", {\n                                                        class: \"h-4 w-4 text-red-500\",\n                                                        fill: \"none\",\n                                                        stroke: \"currentColor\",\n                                                        viewBox: \"0 0 24 24\"\n                                                    }, [\n                                                        _createElementVNode(\"path\", {\n                                                            \"stroke-linecap\": \"round\",\n                                                            \"stroke-linejoin\": \"round\",\n                                                            \"stroke-width\": \"2\",\n                                                            d: \"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"\n                                                        })\n                                                    ], -1 /* CACHED */)\n                                                ]))])\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ], 4 /* STYLE */))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", {\n                                ref_key: \"textContentRef\",\n                                ref: textContentRef,\n                                class: _normalizeClass([\n                                    'leading-relaxed',\n                                    isNarration.value ? `italic text-center flex-1 flex flex-col ${narrationJustifyClass.value}` : '',\n                                ]),\n                                style: _normalizeStyle({\n                                    color: isNarration.value ? dialogStyle.value.colors.narrationText : dialogStyle.value.colors.dialogText,\n                                    fontSize: `${dialogStyle.value.fontSize}px`,\n                                    paddingLeft: isInnerArrow.value ? '48px' : 0,\n                                    paddingRight: isInnerArrow.value ? '48px' : 0,\n                                })\n                            }, [\n                                _createElementVNode(\"span\", {\n                                    innerHTML: formatTextWithCursor(displayedText.value, isTyping.value)\n                                }, null, 8 /* PROPS */, _hoisted_7)\n                            ], 6 /* CLASS, STYLE */),\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_8, [\n                                (_openBlock(), _createBlock(_resolveDynamicComponent(indicatorComponent.value)))\n                            ]),\n                            _createCommentVNode(\"  \"),\n                            (isInnerArrow.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                    _createElementVNode(\"button\", {\n                                        disabled: __props.isLastDialogue,\n                                        class: _normalizeClass([\n                                            'flex items-center justify-center transition-all duration-200',\n                                            __props.isLastDialogue ? 'cursor-not-allowed opacity-40' : 'hover:bg-opacity-100',\n                                        ]),\n                                        style: _normalizeStyle(innerRightArrowStyle.value),\n                                        \"aria-label\": \"\",\n                                        onClick: _withModifiers(handleNext, [\"stop\"])\n                                    }, [...(_cache[6] || (_cache[6] = [\n                                            _createElementVNode(\"svg\", {\n                                                class: \"h-5 w-5\",\n                                                fill: \"none\",\n                                                stroke: \"currentColor\",\n                                                viewBox: \"0 0 24 24\"\n                                            }, [\n                                                _createElementVNode(\"path\", {\n                                                    \"stroke-linecap\": \"round\",\n                                                    \"stroke-linejoin\": \"round\",\n                                                    \"stroke-width\": \"2\",\n                                                    d: \"M9 5l7 7-7 7\"\n                                                })\n                                            ], -1 /* CACHED */)\n                                        ]))], 14 /* CLASS, STYLE, PROPS */, _hoisted_10)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 6 /* CLASS, STYLE */),\n                        _createCommentVNode(\"  \"),\n                        (!isInnerArrow.value)\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 1,\n                                disabled: __props.isLastDialogue,\n                                class: _normalizeClass([\n                                    'flex flex-shrink-0 items-center justify-center transition-all duration-200',\n                                    __props.isLastDialogue ? 'cursor-not-allowed opacity-40' : 'hover:scale-105',\n                                ]),\n                                style: _normalizeStyle(outerArrowStyle.value),\n                                \"aria-label\": \"\",\n                                onClick: _withModifiers(handleNext, [\"stop\"])\n                            }, [...(_cache[7] || (_cache[7] = [\n                                    _createElementVNode(\"svg\", {\n                                        class: \"h-5 w-5\",\n                                        fill: \"none\",\n                                        stroke: \"currentColor\",\n                                        viewBox: \"0 0 24 24\"\n                                    }, [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M9 5l7 7-7 7\"\n                                        })\n                                    ], -1 /* CACHED */)\n                                ]))], 14 /* CLASS, STYLE, PROPS */, _hoisted_11))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ]),\n                _createCommentVNode(\"  \"),\n                (showEditDialog.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm\",\n                        onClick: cancelEdit\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"bg-card rounded-lg p-6 shadow-xl max-w-md w-full mx-4\",\n                            onClick: _cache[1] || (_cache[1] = _withModifiers(() => { }, [\"stop\"])),\n                            style: _normalizeStyle({\n                                backgroundColor: dialogStyle.value.colors.boxBackground,\n                                borderColor: dialogStyle.value.colors.boxBorder,\n                                borderWidth: '1px',\n                                borderStyle: 'solid',\n                            })\n                        }, [\n                            _createElementVNode(\"h3\", {\n                                class: \"text-lg font-semibold mb-4\",\n                                style: _normalizeStyle({ color: dialogStyle.value.colors.dialogText })\n                            }, \"\", 4 /* STYLE */),\n                            _withDirectives(_createElementVNode(\"textarea\", {\n                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((editText).value = $event)),\n                                class: \"w-full p-3 rounded border resize-none focus:outline-none focus:ring-2\",\n                                style: _normalizeStyle({\n                                    backgroundColor: dialogStyle.value.colors.boxBackground,\n                                    borderColor: dialogStyle.value.colors.boxBorder,\n                                    color: dialogStyle.value.colors.dialogText,\n                                }),\n                                rows: \"4\",\n                                placeholder: \"...\"\n                            }, null, 4 /* STYLE */), [\n                                [_vModelText, editText.value]\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_12, [\n                                _createElementVNode(\"button\", {\n                                    onClick: cancelEdit,\n                                    class: \"px-4 py-2 rounded transition-colors\",\n                                    style: _normalizeStyle({\n                                        backgroundColor: dialogStyle.value.colors.boxBorder + '40',\n                                        color: dialogStyle.value.colors.dialogText,\n                                    })\n                                }, \"  \", 4 /* STYLE */),\n                                _createElementVNode(\"button\", {\n                                    onClick: confirmEdit,\n                                    class: \"px-4 py-2 rounded transition-colors\",\n                                    style: _normalizeStyle({\n                                        backgroundColor: dialogStyle.value.colors.nameBackground,\n                                        color: dialogStyle.value.colors.nameText,\n                                    })\n                                }, \"  \", 4 /* STYLE */)\n                            ])\n                        ], 4 /* STYLE */)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ], 64 /* STABLE_FRAGMENT */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DialogBox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DialogBox.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DialogBox.vue?vue&type=style&index=0&id=7ebdc071&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7ebdc071\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"note-card\"\n};\nconst _hoisted_2 = { class: \"note-content\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NoteCard',\n    props: {\n        content: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (__props.content)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, _toDisplayString(__props.content), 1 /* TEXT */)\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NoteCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NoteCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NoteCard.vue?vue&type=style&index=0&id=72408b3a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-72408b3a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, normalizeStyle as _normalizeStyle, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"space-y-1.5\" };\nconst _hoisted_2 = { class: \"flex items-center justify-between\" };\nconst _hoisted_3 = { class: \"text-muted-foreground text-xs\" };\nconst _hoisted_4 = { class: \"flex items-center gap-2\" };\nconst _hoisted_5 = { class: \"text-muted-foreground w-5 text-[10px]\" };\nconst _hoisted_6 = [\"onPointerdown\", \"onPointermove\", \"onPointerup\"];\nconst _hoisted_7 = { class: \"text-muted-foreground w-9 text-right text-[10px]\" };\nimport { computed, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ColorSlider',\n    props: {\n        label: {},\n        value: {},\n        showAlpha: { type: Boolean, default: true }\n    },\n    emits: [\"update:value\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        // HSL \n        function hexToHsl(hex) {\n            let r = 0, g = 0, b = 0, a = 1;\n            if (hex.startsWith('rgba')) {\n                const match = hex.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*([\\d.]+))?\\)/);\n                if (match) {\n                    r = Number.parseInt(match[1]) / 255;\n                    g = Number.parseInt(match[2]) / 255;\n                    b = Number.parseInt(match[3]) / 255;\n                    a = match[4] ? Number.parseFloat(match[4]) : 1;\n                }\n            }\n            else if (hex.startsWith('rgb')) {\n                const match = hex.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\n                if (match) {\n                    r = Number.parseInt(match[1]) / 255;\n                    g = Number.parseInt(match[2]) / 255;\n                    b = Number.parseInt(match[3]) / 255;\n                }\n            }\n            else if (hex.startsWith('#')) {\n                const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})?$/i.exec(hex);\n                if (result) {\n                    r = Number.parseInt(result[1], 16) / 255;\n                    g = Number.parseInt(result[2], 16) / 255;\n                    b = Number.parseInt(result[3], 16) / 255;\n                    a = result[4] ? Number.parseInt(result[4], 16) / 255 : 1;\n                }\n            }\n            const max = Math.max(r, g, b);\n            const min = Math.min(r, g, b);\n            let h = 0;\n            let s = 0;\n            const l = (max + min) / 2;\n            if (max !== min) {\n                const d = max - min;\n                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n                switch (max) {\n                    case r:\n                        h = ((g - b) / d + (g < b ? 6 : 0)) / 6;\n                        break;\n                    case g:\n                        h = ((b - r) / d + 2) / 6;\n                        break;\n                    case b:\n                        h = ((r - g) / d + 4) / 6;\n                        break;\n                }\n            }\n            return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100), a };\n        }\n        function hslToRgba(h, s, l, a) {\n            s /= 100;\n            l /= 100;\n            const k = (n) => (n + h / 30) % 12;\n            const f = (n) => l - s * Math.min(l, 1 - l) * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));\n            const r = Math.round(255 * f(0));\n            const g = Math.round(255 * f(8));\n            const b = Math.round(255 * f(4));\n            return a < 1\n                ? `rgba(${r}, ${g}, ${b}, ${a.toFixed(2)})`\n                : `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\n        }\n        function rgbaToHex(rgba) {\n            if (rgba.startsWith('#'))\n                return rgba.slice(0, 7).toUpperCase();\n            const match = rgba.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)/);\n            if (match) {\n                const r = Number.parseInt(match[1]).toString(16).padStart(2, '0');\n                const g = Number.parseInt(match[2]).toString(16).padStart(2, '0');\n                const b = Number.parseInt(match[3]).toString(16).padStart(2, '0');\n                return `#${r}${g}${b}`.toUpperCase();\n            }\n            return '#000000';\n        }\n        const hsl = computed(() => hexToHsl(props.value));\n        const hexDisplay = computed(() => rgbaToHex(props.value));\n        const hexInput = ref(hexDisplay.value);\n        const localHsl = ref(hsl.value);\n        const isDraggingRef = ref(false);\n        const trackRefs = {};\n        const draggingSlider = ref(null);\n        const globalMoveHandler = ref(null);\n        const globalUpHandler = ref(null);\n        // \n        watch(() => props.value, () => {\n            if (!isDraggingRef.value) {\n                const newHsl = hexToHsl(props.value);\n                localHsl.value = newHsl;\n                hexInput.value = hexDisplay.value;\n            }\n        });\n        const sliders = computed(() => {\n            const result = [\n                {\n                    key: 'h',\n                    label: 'H',\n                    min: 0,\n                    max: 360,\n                    currentValue: localHsl.value.h,\n                    gradient: 'linear-gradient(to right, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000)',\n                    step: 1,\n                    thumbColor: `hsl(${localHsl.value.h}, 100%, 50%)`,\n                    displayValue: `${Math.round(localHsl.value.h)}`,\n                },\n                {\n                    key: 's',\n                    label: 'S',\n                    min: 0,\n                    max: 100,\n                    currentValue: localHsl.value.s,\n                    gradient: `linear-gradient(to right, hsl(${localHsl.value.h}, 0%, ${localHsl.value.l}%), hsl(${localHsl.value.h}, 100%, ${localHsl.value.l}%))`,\n                    step: 1,\n                    thumbColor: hslToRgba(localHsl.value.h, localHsl.value.s, localHsl.value.l, 1),\n                    displayValue: `${Math.round(localHsl.value.s)}%`,\n                },\n                {\n                    key: 'l',\n                    label: 'L',\n                    min: 0,\n                    max: 100,\n                    currentValue: localHsl.value.l,\n                    gradient: `linear-gradient(to right, #000, hsl(${localHsl.value.h}, ${localHsl.value.s}%, 50%), #fff)`,\n                    step: 1,\n                    thumbColor: hslToRgba(localHsl.value.h, localHsl.value.s, localHsl.value.l, 1),\n                    displayValue: `${Math.round(localHsl.value.l)}%`,\n                },\n            ];\n            if (props.showAlpha) {\n                result.push({\n                    key: 'a',\n                    label: 'A',\n                    min: 0,\n                    max: 1,\n                    currentValue: localHsl.value.a,\n                    gradient: `linear-gradient(to right, transparent, ${hslToRgba(localHsl.value.h, localHsl.value.s, localHsl.value.l, 1)})`,\n                    step: 0.01,\n                    thumbColor: hslToRgba(localHsl.value.h, localHsl.value.s, localHsl.value.l, localHsl.value.a),\n                    displayValue: `${Math.round(localHsl.value.a * 100)}%`,\n                });\n            }\n            return result;\n        });\n        // HSL\n        function updateLocalValue(e, slider) {\n            const track = trackRefs[slider.key];\n            if (!track)\n                return;\n            const rect = track.getBoundingClientRect();\n            const x = Math.max(0, Math.min(e.clientX - rect.left, rect.width));\n            const ratio = x / rect.width;\n            const val = slider.min + ratio * (slider.max - slider.min);\n            const finalVal = slider.step < 1 ? Math.round(val * 100) / 100 : Math.round(val);\n            // \n            localHsl.value = { ...localHsl.value, [slider.key]: finalVal };\n            // \n            const newValue = hslToRgba(localHsl.value.h, localHsl.value.s, localHsl.value.l, localHsl.value.a);\n            emit('update:value', newValue);\n        }\n        // \n        function commitChange() {\n            if (isDraggingRef.value) {\n                // \n                const finalValue = hslToRgba(localHsl.value.h, localHsl.value.s, localHsl.value.l, localHsl.value.a);\n                emit('update:value', finalValue);\n                isDraggingRef.value = false;\n            }\n        }\n        function handlePointerDown(e, slider) {\n            isDraggingRef.value = true;\n            draggingSlider.value = slider.key;\n            //  setPointerCapture \n            e.currentTarget.setPointerCapture(e.pointerId);\n            // \n            updateLocalValue(e, slider);\n            // \n            const handleGlobalMove = (ev) => {\n                if (draggingSlider.value === slider.key && isDraggingRef.value) {\n                    updateLocalValue(ev, slider);\n                }\n            };\n            const handleGlobalUp = () => {\n                if (draggingSlider.value === slider.key) {\n                    commitChange();\n                    draggingSlider.value = null;\n                    // \n                    if (globalMoveHandler.value) {\n                        document.removeEventListener('pointermove', globalMoveHandler.value);\n                    }\n                    if (globalUpHandler.value) {\n                        document.removeEventListener('pointerup', globalUpHandler.value);\n                    }\n                    // \n                    if (e.currentTarget instanceof HTMLElement) {\n                        e.currentTarget.releasePointerCapture(e.pointerId);\n                    }\n                }\n            };\n            globalMoveHandler.value = handleGlobalMove;\n            globalUpHandler.value = handleGlobalUp;\n            document.addEventListener('pointermove', handleGlobalMove);\n            document.addEventListener('pointerup', handleGlobalUp);\n        }\n        function handlePointerMove(e, slider) {\n            if (draggingSlider.value === slider.key && isDraggingRef.value) {\n                updateLocalValue(e, slider);\n            }\n        }\n        function handlePointerUp(e, slider) {\n            if (draggingSlider.value === slider.key) {\n                commitChange();\n                draggingSlider.value = null;\n                // \n                if (e.currentTarget instanceof HTMLElement) {\n                    e.currentTarget.releasePointerCapture(e.pointerId);\n                }\n            }\n        }\n        function handleHexInput(e) {\n            const input = e.target.value.toUpperCase();\n            hexInput.value = input;\n            if (/^#[0-9A-F]{6}$/.test(input)) {\n                const newHsl = hexToHsl(input);\n                newHsl.a = localHsl.value.a;\n                localHsl.value = newHsl;\n                emit('update:value', hslToRgba(newHsl.h, newHsl.s, newHsl.l, newHsl.a));\n            }\n        }\n        function handleHexBlur() {\n            hexInput.value = rgbaToHex(props.value);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"label\", _hoisted_3, _toDisplayString(__props.label), 1 /* TEXT */),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _withDirectives(_createElementVNode(\"input\", {\n                            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((hexInput).value = $event)),\n                            type: \"text\",\n                            class: \"bg-background text-foreground w-20 rounded border px-2 py-0.5 font-mono text-xs\",\n                            placeholder: \"#000000\",\n                            onInput: handleHexInput,\n                            onBlur: handleHexBlur\n                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                            [_vModelText, hexInput.value]\n                        ]),\n                        _createElementVNode(\"div\", {\n                            class: \"border-border h-6 w-6 rounded border shadow-sm\",\n                            style: _normalizeStyle({ backgroundColor: __props.value })\n                        }, null, 4 /* STYLE */)\n                    ])\n                ]),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(sliders.value, (slider) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slider.key,\n                        class: \"flex items-center gap-2\"\n                    }, [\n                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(slider.label), 1 /* TEXT */),\n                        _createElementVNode(\"div\", {\n                            ref_for: true,\n                            ref: el => (trackRefs[slider.key] = el),\n                            class: \"relative flex h-6 flex-1 cursor-pointer touch-none items-center\",\n                            onPointerdown: e => handlePointerDown(e, slider),\n                            onPointermove: e => handlePointerMove(e, slider),\n                            onPointerup: e => handlePointerUp(e, slider)\n                        }, [\n                            _createElementVNode(\"div\", {\n                                class: \"absolute inset-y-2 right-0 left-0 rounded-full\",\n                                style: _normalizeStyle({ background: slider.gradient })\n                            }, null, 4 /* STYLE */),\n                            _createElementVNode(\"div\", {\n                                class: \"pointer-events-none absolute top-1/2 h-4 w-4 -translate-y-1/2 rounded-full border-2 border-white shadow-md\",\n                                style: _normalizeStyle({\n                                    left: `calc(${((slider.currentValue - slider.min) / (slider.max - slider.min)) * 100}% - 8px)`,\n                                    background: slider.thumbColor,\n                                })\n                            }, null, 4 /* STYLE */)\n                        ], 40 /* PROPS, NEED_HYDRATION */, _hoisted_6),\n                        _createElementVNode(\"span\", _hoisted_7, _toDisplayString(slider.displayValue), 1 /* TEXT */)\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ColorSlider.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ColorSlider.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ColorSlider.vue?vue&type=style&index=0&id=6137eb39&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6137eb39\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, resolveDynamicComponent as _resolveDynamicComponent, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"flex items-center gap-1\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"p-1\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"absolute left-1 top-1/2 -translate-y-1/2\"\n};\nconst _hoisted_4 = { class: \"absolute bottom-1.5 right-2\" };\nconst _hoisted_5 = {\n    key: 1,\n    class: \"absolute right-1 top-1/2 -translate-y-1/2\"\n};\nconst _hoisted_6 = {\n    key: 1,\n    class: \"p-1\"\n};\nimport { computed, h } from 'vue';\nimport { arrowShapePresets, backgroundPatternPresets, borderWidthPresets, boxShapePresets, indicatorShapePresets, nameShapePresets, } from '../types/galgame';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DialogPreview',\n    props: {\n        style: {}\n    },\n    setup(__props) {\n        function hslToRgba(h, s, l, a) {\n            s /= 100;\n            l /= 100;\n            const k = (n) => (n + h / 30) % 12;\n            const f = (n) => l - s * Math.min(l, 1 - l) * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));\n            const r = Math.round(255 * f(0));\n            const g = Math.round(255 * f(8));\n            const b = Math.round(255 * f(4));\n            return a < 1\n                ? `rgba(${r}, ${g}, ${b}, ${a.toFixed(2)})`\n                : `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\n        }\n        const props = __props;\n        //  computed \n        const dialogStyle = computed(() => props.style);\n        const boxShape = computed(() => boxShapePresets.find(p => p.id === dialogStyle.value.boxShape) || boxShapePresets[0]);\n        const nameShape = computed(() => nameShapePresets.find(p => p.id === dialogStyle.value.nameShape) || nameShapePresets[0]);\n        const arrowShape = computed(() => arrowShapePresets.find(p => p.id === dialogStyle.value.arrowShape) || arrowShapePresets[0]);\n        const indicatorShape = computed(() => indicatorShapePresets.find(p => p.id === dialogStyle.value.indicatorShape) || indicatorShapePresets[0]);\n        const borderWidth = computed(() => borderWidthPresets.find(p => p.id === dialogStyle.value.borderWidth) || borderWidthPresets[1]);\n        const bgPattern = computed(() => backgroundPatternPresets.find(p => p.id === dialogStyle.value.backgroundPattern));\n        const isInnerArrow = computed(() => arrowShape.value.isInner);\n        const isMinimalArrow = computed(() => arrowShape.value.type === 'minimal');\n        const isPillShape = computed(() => dialogStyle.value.boxShape === 'pill');\n        const arrowBorderRadius = computed(() => {\n            if (arrowShape.value.type === 'square' || arrowShape.value.type === 'inner-square')\n                return '4px';\n            if (arrowShape.value.type === 'pill')\n                return '12px';\n            return '9999px';\n        });\n        const getPatternStyle = computed(() => {\n            if (!bgPattern.value?.pattern)\n                return {};\n            const borderColorForPattern = dialogStyle.value.colors.boxBorder.replace(/[\\d.]+\\)$/, '0.08)');\n            const patternWithColor = bgPattern.value.pattern.replace(/VAR_BORDER_COLOR/g, borderColorForPattern);\n            let backgroundSize = '20px 20px';\n            if (bgPattern.value.id === 'dots')\n                backgroundSize = '16px 16px';\n            if (bgPattern.value.id === 'diamonds')\n                backgroundSize = '16px 16px';\n            if (bgPattern.value.id === 'stripes')\n                backgroundSize = '28px 28px';\n            return {\n                backgroundImage: patternWithColor,\n                backgroundSize,\n            };\n        });\n        const boxStyle = computed(() => {\n            return {\n                backgroundColor: isPillShape.value ? 'rgba(255,255,255,0.7)' : dialogStyle.value.colors.boxBackground,\n                borderRadius: boxShape.value.borderRadius,\n                borderTopWidth: borderWidth.value.width,\n                borderLeftWidth: borderWidth.value.width,\n                borderRightWidth: borderWidth.value.width,\n                borderBottomWidth: borderWidth.value.width,\n                borderStyle: 'solid',\n                borderColor: dialogStyle.value.colors.boxBorder,\n                boxShadow: boxShape.value.shadow,\n                ...(isPillShape.value ? { backdropFilter: 'blur(12px)', WebkitBackdropFilter: 'blur(12px)' } : {}),\n                ...getPatternStyle.value,\n            };\n        });\n        const indicatorComponent = computed(() => {\n            const { type } = indicatorShape.value;\n            const color = dialogStyle.value.colors.indicatorColor;\n            if (type === 'none')\n                return null;\n            if (type === 'dots') {\n                return h('div', { class: 'flex gap-0.5 items-center' }, [0, 1, 2].map(i => h('span', {\n                    key: i,\n                    class: 'w-1 h-1 rounded-full',\n                    style: { backgroundColor: color, opacity: i === 2 ? 1 : 0.4 },\n                })));\n            }\n            if (type === 'diamonds') {\n                return h('div', { class: 'flex gap-0.5 items-center' }, [0, 1, 2].map(i => h('span', {\n                    key: i,\n                    style: {\n                        width: '8px',\n                        height: '8px',\n                        backgroundColor: color,\n                        opacity: i === 2 ? 1 : 0.3 + i * 0.15,\n                        transform: 'rotate(45deg)',\n                        display: 'inline-block',\n                    },\n                })));\n            }\n            if (type === 'pulse') {\n                return h('div', { class: 'relative w-2 h-2' }, [\n                    h('span', {\n                        class: 'absolute inset-0 rounded-full',\n                        style: { backgroundColor: color },\n                    }),\n                ]);\n            }\n            if (type === 'arrow') {\n                return h('svg', {\n                    class: 'w-3 h-3',\n                    style: { color },\n                    fill: 'none',\n                    stroke: 'currentColor',\n                    viewBox: '0 0 24 24',\n                }, [\n                    h('path', {\n                        'stroke-linecap': 'round',\n                        'stroke-linejoin': 'round',\n                        'stroke-width': '2',\n                        d: 'M9 5l7 7-7 7',\n                    }),\n                ]);\n            }\n            return null;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (!isInnerArrow.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", {\n                            class: \"p-1 backdrop-blur-sm shadow\",\n                            style: _normalizeStyle({\n                                backgroundColor: dialogStyle.value.colors.arrowBackground,\n                                borderRadius: arrowBorderRadius.value.value,\n                            })\n                        }, [\n                            (_openBlock(), _createElementBlock(\"svg\", {\n                                class: \"w-3 h-3\",\n                                fill: \"none\",\n                                stroke: \"currentColor\",\n                                viewBox: \"0 0 24 24\",\n                                style: _normalizeStyle({ color: dialogStyle.value.colors.arrowIcon })\n                            }, [...(_cache[0] || (_cache[0] = [\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M15 19l-7-7 7-7\"\n                                    }, null, -1 /* CACHED */)\n                                ]))], 4 /* STYLE */))\n                        ], 4 /* STYLE */)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createElementVNode(\"div\", {\n                    class: \"flex-1 p-2 min-h-[60px] relative\",\n                    style: _normalizeStyle(boxStyle.value)\n                }, [\n                    (isInnerArrow.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", {\n                                class: \"p-1 backdrop-blur-sm shadow\",\n                                style: _normalizeStyle({\n                                    backgroundColor: dialogStyle.value.colors.arrowBackground,\n                                    borderRadius: arrowBorderRadius.value,\n                                })\n                            }, [\n                                (_openBlock(), _createElementBlock(\"svg\", {\n                                    class: \"w-3 h-3\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\",\n                                    style: _normalizeStyle({ color: dialogStyle.value.colors.arrowIcon })\n                                }, [...(_cache[1] || (_cache[1] = [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M15 19l-7-7 7-7\"\n                                        }, null, -1 /* CACHED */)\n                                    ]))], 4 /* STYLE */))\n                            ], 4 /* STYLE */)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createElementVNode(\"div\", {\n                        class: \"h-4 mb-1 flex items-start\",\n                        style: _normalizeStyle({\n                            paddingLeft: isInnerArrow.value ? '24px' : 0,\n                            paddingRight: isInnerArrow.value ? '24px' : 0,\n                        })\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"px-2 py-0.5 text-[10px] font-medium\",\n                            style: _normalizeStyle({\n                                backgroundColor: dialogStyle.value.colors.nameBackground,\n                                color: dialogStyle.value.colors.nameText,\n                                borderRadius: nameShape.value.borderRadius,\n                                borderBottom: nameShape.value.style === 'underline' ? `2px solid ${dialogStyle.value.colors.nameText}` : undefined,\n                                boxShadow: nameShape.value.style === 'floating' ? '0 2px 8px rgba(0,0,0,0.1)' : undefined,\n                            })\n                        }, \"  \", 4 /* STYLE */)\n                    ], 4 /* STYLE */),\n                    _createElementVNode(\"p\", {\n                        class: \"text-[10px] leading-relaxed\",\n                        style: _normalizeStyle({\n                            color: dialogStyle.value.colors.dialogText,\n                            fontSize: `${dialogStyle.value.fontSize}px`,\n                            paddingLeft: isInnerArrow.value ? '24px' : 0,\n                            paddingRight: isInnerArrow.value ? '24px' : 0,\n                        })\n                    }, \" ... \", 4 /* STYLE */),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        (_openBlock(), _createBlock(_resolveDynamicComponent(indicatorComponent.value)))\n                    ]),\n                    (isInnerArrow.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"div\", {\n                                class: \"p-1 backdrop-blur-sm shadow\",\n                                style: _normalizeStyle({\n                                    backgroundColor: dialogStyle.value.colors.arrowBackground,\n                                    borderRadius: arrowBorderRadius.value,\n                                })\n                            }, [\n                                (_openBlock(), _createElementBlock(\"svg\", {\n                                    class: \"w-3 h-3\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\",\n                                    style: _normalizeStyle({ color: dialogStyle.value.colors.arrowIcon })\n                                }, [...(_cache[2] || (_cache[2] = [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M9 5l7 7-7 7\"\n                                        }, null, -1 /* CACHED */)\n                                    ]))], 4 /* STYLE */))\n                            ], 4 /* STYLE */)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 4 /* STYLE */),\n                (!isInnerArrow.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                        _createElementVNode(\"div\", {\n                            class: \"p-1 backdrop-blur-sm shadow\",\n                            style: _normalizeStyle({\n                                backgroundColor: dialogStyle.value.colors.arrowBackground,\n                                borderRadius: arrowBorderRadius.value.value,\n                            })\n                        }, [\n                            (_openBlock(), _createElementBlock(\"svg\", {\n                                class: \"w-3 h-3\",\n                                fill: \"none\",\n                                stroke: \"currentColor\",\n                                viewBox: \"0 0 24 24\",\n                                style: _normalizeStyle({ color: dialogStyle.value.colors.arrowIcon })\n                            }, [...(_cache[3] || (_cache[3] = [\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M9 5l7 7-7 7\"\n                                    }, null, -1 /* CACHED */)\n                                ]))], 4 /* STYLE */))\n                        ], 4 /* STYLE */)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DialogPreview.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DialogPreview.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, createVNode as _createVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = { class: \"animate-in fade-in absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm duration-200\" };\nconst _hoisted_2 = { class: \"bg-card relative max-h-[85vh] w-[90%] max-w-lg overflow-hidden rounded-xl shadow-2xl\" };\nconst _hoisted_3 = { class: \"border-border flex items-center justify-between border-b p-4\" };\nconst _hoisted_4 = { class: \"settings-scroll-container max-h-[calc(85vh-120px)] overflow-y-auto p-4\" };\nconst _hoisted_5 = { class: \"space-y-6\" };\nconst _hoisted_6 = { class: \"space-y-4\" };\nconst _hoisted_7 = { class: \"space-y-3\" };\nconst _hoisted_8 = { class: \"space-y-2\" };\nconst _hoisted_9 = { class: \"text-muted-foreground text-xs\" };\nconst _hoisted_10 = [\"value\"];\nconst _hoisted_11 = { class: \"space-y-2\" };\nconst _hoisted_12 = { class: \"text-muted-foreground text-xs\" };\nconst _hoisted_13 = [\"value\"];\nconst _hoisted_14 = { class: \"space-y-2\" };\nconst _hoisted_15 = { class: \"text-muted-foreground text-xs\" };\nconst _hoisted_16 = [\"value\"];\nconst _hoisted_17 = { class: \"space-y-4\" };\nconst _hoisted_18 = { class: \"flex items-center justify-between\" };\nconst _hoisted_19 = { class: \"relative inline-flex cursor-pointer items-center\" };\nconst _hoisted_20 = [\"checked\"];\nconst _hoisted_21 = {\n    key: 0,\n    class: \"animate-in fade-in space-y-2 duration-200\"\n};\nconst _hoisted_22 = { class: \"text-muted-foreground text-xs\" };\nconst _hoisted_23 = [\"value\"];\nconst _hoisted_24 = { class: \"space-y-4\" };\nconst _hoisted_25 = { class: \"flex items-center justify-between\" };\nconst _hoisted_26 = { class: \"relative inline-flex cursor-pointer items-center\" };\nconst _hoisted_27 = [\"checked\"];\nconst _hoisted_28 = {\n    key: 0,\n    class: \"animate-in fade-in space-y-4 duration-200\"\n};\nconst _hoisted_29 = { class: \"bg-muted/30 rounded-lg p-3\" };\nconst _hoisted_30 = { class: \"mb-2 flex items-center justify-between\" };\nconst _hoisted_31 = [\"disabled\"];\nconst _hoisted_32 = {\n    key: 0,\n    class: \"h-3 w-3\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    viewBox: \"0 0 24 24\"\n};\nconst _hoisted_33 = {\n    key: 1,\n    class: \"h-3 w-3\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    viewBox: \"0 0 24 24\"\n};\nconst _hoisted_34 = { class: \"px-6\" };\nconst _hoisted_35 = { class: \"space-y-4\" };\nconst _hoisted_36 = { class: \"bg-muted text-muted-foreground inline-flex h-9 w-full items-center justify-center rounded-lg p-[3px]\" };\nconst _hoisted_37 = {\n    key: 0,\n    class: \"space-y-4\"\n};\nconst _hoisted_38 = { class: \"space-y-2\" };\nconst _hoisted_39 = { class: \"grid grid-cols-5 gap-2\" };\nconst _hoisted_40 = [\"onClick\"];\nconst _hoisted_41 = { class: \"space-y-2\" };\nconst _hoisted_42 = { class: \"grid grid-cols-6 gap-2\" };\nconst _hoisted_43 = [\"onClick\"];\nconst _hoisted_44 = { class: \"space-y-2\" };\nconst _hoisted_45 = { class: \"grid grid-cols-5 gap-2\" };\nconst _hoisted_46 = [\"onClick\"];\nconst _hoisted_47 = { class: \"space-y-2\" };\nconst _hoisted_48 = { class: \"grid grid-cols-5 gap-2\" };\nconst _hoisted_49 = [\"onClick\"];\nconst _hoisted_50 = { class: \"space-y-2\" };\nconst _hoisted_51 = { class: \"grid grid-cols-6 gap-2\" };\nconst _hoisted_52 = [\"onClick\"];\nconst _hoisted_53 = { class: \"space-y-2\" };\nconst _hoisted_54 = { class: \"grid grid-cols-5 gap-2\" };\nconst _hoisted_55 = [\"onClick\"];\nconst _hoisted_56 = { class: \"space-y-2\" };\nconst _hoisted_57 = { class: \"text-muted-foreground text-xs\" };\nconst _hoisted_58 = [\"value\"];\nconst _hoisted_59 = {\n    key: 1,\n    class: \"space-y-4\"\n};\nimport { computed, ref } from 'vue';\nimport { arrowShapePresets, backgroundPatternPresets, borderWidthPresets, boxShapePresets, indicatorShapePresets, nameShapePresets, } from '../types/galgame';\nimport ColorSlider from './ColorSlider.vue';\nimport DialogPreview from './DialogPreview.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettingsPanel',\n    props: {\n        onClose: { type: Function },\n        spriteSettings: {},\n        onSpriteSettingsChange: { type: Function },\n        autoPlay: { type: Boolean },\n        onAutoPlayChange: { type: Function },\n        autoPlaySpeed: {},\n        onAutoPlaySpeedChange: { type: Function },\n        dialogStyle: {},\n        onDialogStyleChange: { type: Function },\n        onSaveStyle: { type: Function },\n        currentAppliedStyle: {},\n        customModeEnabled: { type: Boolean },\n        onCustomModeChange: { type: Function }\n    },\n    setup(__props) {\n        const props = __props;\n        const activeTab = ref('shapes');\n        const hasChanges = computed(() => {\n            return JSON.stringify(props.dialogStyle) !== JSON.stringify(props.currentAppliedStyle);\n        });\n        function updateSpriteSettings(settings) {\n            props.onSpriteSettingsChange(settings);\n        }\n        function updateShape(key, value) {\n            props.onDialogStyleChange({ ...props.dialogStyle, [key]: value });\n        }\n        function updateColor(key, value) {\n            props.onDialogStyleChange({\n                ...props.dialogStyle,\n                colors: { ...props.dialogStyle.colors, [key]: value },\n            });\n        }\n        function handleEnableCustomMode(enabled) {\n            props.onCustomModeChange(enabled);\n            if (enabled) {\n                // \n                props.onDialogStyleChange(props.currentAppliedStyle);\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[21] || (_cache[21] = _createElementVNode(\"h2\", { class: \"text-foreground text-lg font-semibold\" }, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"button\", {\n                            class: \"hover:bg-muted rounded-full p-1 transition-colors\",\n                            \"aria-label\": \"\",\n                            onClick: _cache[0] || (_cache[0] =\n                                //@ts-ignore\n                                (...args) => (__props.onClose && __props.onClose(...args)))\n                        }, [...(_cache[20] || (_cache[20] = [\n                                _createElementVNode(\"svg\", {\n                                    class: \"h-5 w-5\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\"\n                                }, [\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M6 18L18 6M6 6l12 12\"\n                                    })\n                                ], -1 /* CACHED */)\n                            ]))])\n                    ]),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _createElementVNode(\"div\", _hoisted_5, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                _cache[22] || (_cache[22] = _createElementVNode(\"h3\", { class: \"text-foreground text-sm font-medium\" }, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"div\", _hoisted_8, [\n                                        _createElementVNode(\"label\", _hoisted_9, \" (\" + _toDisplayString(Math.round(__props.spriteSettings.scale * 100)) + \"%)\", 1 /* TEXT */),\n                                        _createElementVNode(\"input\", {\n                                            type: \"range\",\n                                            value: __props.spriteSettings.scale,\n                                            min: \"0.5\",\n                                            max: \"1.5\",\n                                            step: \"0.05\",\n                                            class: \"w-full\",\n                                            onInput: _cache[1] || (_cache[1] =\n                                                e => updateSpriteSettings({\n                                                    ...__props.spriteSettings,\n                                                    scale: parseFloat(e.target.value),\n                                                }))\n                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_10)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_11, [\n                                        _createElementVNode(\"label\", _hoisted_12, \" (\" + _toDisplayString(__props.spriteSettings.positionX) + \"%)\", 1 /* TEXT */),\n                                        _createElementVNode(\"input\", {\n                                            type: \"range\",\n                                            value: __props.spriteSettings.positionX,\n                                            min: \"0\",\n                                            max: \"100\",\n                                            step: \"1\",\n                                            class: \"w-full\",\n                                            onInput: _cache[2] || (_cache[2] =\n                                                e => updateSpriteSettings({\n                                                    ...__props.spriteSettings,\n                                                    positionX: parseInt(e.target.value),\n                                                }))\n                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_13)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_14, [\n                                        _createElementVNode(\"label\", _hoisted_15, \" (\" + _toDisplayString(__props.spriteSettings.positionY) + \"%)\", 1 /* TEXT */),\n                                        _createElementVNode(\"input\", {\n                                            type: \"range\",\n                                            value: __props.spriteSettings.positionY,\n                                            min: \"0\",\n                                            max: \"100\",\n                                            step: \"1\",\n                                            class: \"w-full\",\n                                            onInput: _cache[3] || (_cache[3] =\n                                                e => updateSpriteSettings({\n                                                    ...__props.spriteSettings,\n                                                    positionY: parseInt(e.target.value),\n                                                }))\n                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_16)\n                                    ])\n                                ])\n                            ]),\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_17, [\n                                _cache[25] || (_cache[25] = _createElementVNode(\"h3\", { class: \"text-foreground text-sm font-medium\" }, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_18, [\n                                    _cache[24] || (_cache[24] = _createElementVNode(\"label\", { class: \"text-muted-foreground text-xs\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"label\", _hoisted_19, [\n                                        _createElementVNode(\"input\", {\n                                            type: \"checkbox\",\n                                            checked: __props.autoPlay,\n                                            class: \"peer sr-only\",\n                                            onChange: _cache[4] || (_cache[4] = e => __props.onAutoPlayChange(e.target.checked))\n                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_20),\n                                        _cache[23] || (_cache[23] = _createElementVNode(\"div\", { class: \"bg-input peer relative h-[1.15rem] w-8 rounded-full transition-colors peer-checked:bg-primary\" }, [\n                                            _createElementVNode(\"div\", { class: \"bg-background absolute top-0 left-0 h-4 w-4 rounded-full transition-transform peer-checked:translate-x-[calc(100%-2px)]\" })\n                                        ], -1 /* CACHED */))\n                                    ])\n                                ]),\n                                (__props.autoPlay)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [\n                                        _createElementVNode(\"label\", _hoisted_22, \" (\" + _toDisplayString(__props.autoPlaySpeed / 1000) + \")\", 1 /* TEXT */),\n                                        _createElementVNode(\"input\", {\n                                            type: \"range\",\n                                            value: __props.autoPlaySpeed,\n                                            min: \"1000\",\n                                            max: \"8000\",\n                                            step: \"500\",\n                                            class: \"w-full\",\n                                            onInput: _cache[5] || (_cache[5] = e => __props.onAutoPlaySpeedChange(parseInt(e.target.value)))\n                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_23)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_24, [\n                                _createElementVNode(\"div\", _hoisted_25, [\n                                    _cache[27] || (_cache[27] = _createElementVNode(\"h3\", { class: \"text-foreground text-sm font-medium\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"label\", _hoisted_26, [\n                                        _createElementVNode(\"input\", {\n                                            type: \"checkbox\",\n                                            checked: __props.customModeEnabled,\n                                            class: \"peer sr-only\",\n                                            onChange: _cache[6] || (_cache[6] = e => handleEnableCustomMode(e.target.checked))\n                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_27),\n                                        _cache[26] || (_cache[26] = _createElementVNode(\"div\", { class: \"bg-input peer relative h-[1.15rem] w-8 rounded-full transition-colors peer-checked:bg-primary\" }, [\n                                            _createElementVNode(\"div\", { class: \"bg-background absolute top-0 left-0 h-4 w-4 rounded-full transition-transform peer-checked:translate-x-[calc(100%-2px)]\" })\n                                        ], -1 /* CACHED */))\n                                    ])\n                                ]),\n                                (__props.customModeEnabled)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, [\n                                        _createCommentVNode(\"  \"),\n                                        _createElementVNode(\"div\", _hoisted_29, [\n                                            _createElementVNode(\"div\", _hoisted_30, [\n                                                _cache[30] || (_cache[30] = _createElementVNode(\"span\", { class: \"text-muted-foreground text-xs\" }, \"\", -1 /* CACHED */)),\n                                                _createElementVNode(\"button\", {\n                                                    disabled: !hasChanges.value,\n                                                    class: _normalizeClass([\n                                                        'flex h-7 items-center gap-1 rounded-md border px-3 text-xs transition-colors',\n                                                        hasChanges.value\n                                                            ? 'bg-primary text-primary-foreground border-primary hover:bg-primary/90'\n                                                            : 'bg-background cursor-not-allowed border-gray-200 opacity-50',\n                                                    ]),\n                                                    onClick: _cache[7] || (_cache[7] =\n                                                        //@ts-ignore\n                                                        (...args) => (__props.onSaveStyle && __props.onSaveStyle(...args)))\n                                                }, [\n                                                    (hasChanges.value)\n                                                        ? (_openBlock(), _createElementBlock(\"svg\", _hoisted_32, [...(_cache[28] || (_cache[28] = [\n                                                                _createElementVNode(\"path\", {\n                                                                    \"stroke-linecap\": \"round\",\n                                                                    \"stroke-linejoin\": \"round\",\n                                                                    \"stroke-width\": \"2\",\n                                                                    d: \"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12\"\n                                                                }, null, -1 /* CACHED */)\n                                                            ]))]))\n                                                        : (_openBlock(), _createElementBlock(\"svg\", _hoisted_33, [...(_cache[29] || (_cache[29] = [\n                                                                _createElementVNode(\"path\", {\n                                                                    \"stroke-linecap\": \"round\",\n                                                                    \"stroke-linejoin\": \"round\",\n                                                                    \"stroke-width\": \"2\",\n                                                                    d: \"M5 13l4 4L19 7\"\n                                                                }, null, -1 /* CACHED */)\n                                                            ]))])),\n                                                    _createTextVNode(\" \" + _toDisplayString(hasChanges.value ? '' : ''), 1 /* TEXT */)\n                                                ], 10 /* CLASS, PROPS */, _hoisted_31)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_34, [\n                                                _createVNode(DialogPreview, {\n                                                    style: _normalizeStyle(__props.dialogStyle)\n                                                }, null, 8 /* PROPS */, [\"style\"])\n                                            ])\n                                        ]),\n                                        _createCommentVNode(\"  \"),\n                                        _createElementVNode(\"div\", _hoisted_35, [\n                                            _createElementVNode(\"div\", _hoisted_36, [\n                                                _createElementVNode(\"button\", {\n                                                    class: _normalizeClass([\n                                                        'inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all',\n                                                        activeTab.value === 'shapes'\n                                                            ? 'bg-background text-foreground border-input shadow-sm'\n                                                            : 'text-muted-foreground hover:text-foreground',\n                                                    ]),\n                                                    onClick: _cache[8] || (_cache[8] = ($event) => (activeTab.value = 'shapes'))\n                                                }, \"  \", 2 /* CLASS */),\n                                                _createElementVNode(\"button\", {\n                                                    class: _normalizeClass([\n                                                        'inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all',\n                                                        activeTab.value === 'colors'\n                                                            ? 'bg-background text-foreground border-input shadow-sm'\n                                                            : 'text-muted-foreground hover:text-foreground',\n                                                    ]),\n                                                    onClick: _cache[9] || (_cache[9] = ($event) => (activeTab.value = 'colors'))\n                                                }, \"  \", 2 /* CLASS */)\n                                            ]),\n                                            _createCommentVNode(\"  \"),\n                                            (activeTab.value === 'shapes')\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_37, [\n                                                    _createCommentVNode(\"  \"),\n                                                    _createElementVNode(\"div\", _hoisted_38, [\n                                                        _cache[31] || (_cache[31] = _createElementVNode(\"label\", { class: \"text-muted-foreground text-xs\" }, \"\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"div\", _hoisted_39, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(boxShapePresets), (preset) => {\n                                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                                    key: preset.id,\n                                                                    class: _normalizeClass([\n                                                                        'rounded-lg border p-2 text-[10px] transition-all',\n                                                                        __props.dialogStyle.boxShape === preset.id\n                                                                            ? 'border-primary bg-primary/10 text-primary'\n                                                                            : 'border-border hover:border-primary/50',\n                                                                    ]),\n                                                                    onClick: ($event) => (updateShape('boxShape', preset.id))\n                                                                }, _toDisplayString(preset.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_40));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]),\n                                                    _createCommentVNode(\"  \"),\n                                                    _createElementVNode(\"div\", _hoisted_41, [\n                                                        _cache[32] || (_cache[32] = _createElementVNode(\"label\", { class: \"text-muted-foreground text-xs\" }, \"\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"div\", _hoisted_42, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(backgroundPatternPresets), (preset) => {\n                                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                                    key: preset.id,\n                                                                    class: _normalizeClass([\n                                                                        'rounded-lg border p-2 text-[10px] transition-all',\n                                                                        __props.dialogStyle.backgroundPattern === preset.id\n                                                                            ? 'border-primary bg-primary/10 text-primary'\n                                                                            : 'border-border hover:border-primary/50',\n                                                                    ]),\n                                                                    onClick: ($event) => (updateShape('backgroundPattern', preset.id))\n                                                                }, _toDisplayString(preset.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_43));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]),\n                                                    _createCommentVNode(\"  \"),\n                                                    _createElementVNode(\"div\", _hoisted_44, [\n                                                        _cache[33] || (_cache[33] = _createElementVNode(\"label\", { class: \"text-muted-foreground text-xs\" }, \"\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"div\", _hoisted_45, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(borderWidthPresets), (preset) => {\n                                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                                    key: preset.id,\n                                                                    class: _normalizeClass([\n                                                                        'rounded-lg border p-2 text-[10px] transition-all',\n                                                                        __props.dialogStyle.borderWidth === preset.id\n                                                                            ? 'border-primary bg-primary/10 text-primary'\n                                                                            : 'border-border hover:border-primary/50',\n                                                                    ]),\n                                                                    onClick: ($event) => (updateShape('borderWidth', preset.id))\n                                                                }, _toDisplayString(preset.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_46));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]),\n                                                    _createCommentVNode(\"  \"),\n                                                    _createElementVNode(\"div\", _hoisted_47, [\n                                                        _cache[34] || (_cache[34] = _createElementVNode(\"label\", { class: \"text-muted-foreground text-xs\" }, \"\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"div\", _hoisted_48, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(nameShapePresets), (preset) => {\n                                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                                    key: preset.id,\n                                                                    class: _normalizeClass([\n                                                                        'rounded-lg border p-2 text-[10px] transition-all',\n                                                                        __props.dialogStyle.nameShape === preset.id\n                                                                            ? 'border-primary bg-primary/10 text-primary'\n                                                                            : 'border-border hover:border-primary/50',\n                                                                    ]),\n                                                                    onClick: ($event) => (updateShape('nameShape', preset.id))\n                                                                }, _toDisplayString(preset.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_49));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]),\n                                                    _createCommentVNode(\"  \"),\n                                                    _createElementVNode(\"div\", _hoisted_50, [\n                                                        _cache[35] || (_cache[35] = _createElementVNode(\"label\", { class: \"text-muted-foreground text-xs\" }, \"\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"div\", _hoisted_51, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(arrowShapePresets), (preset) => {\n                                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                                    key: preset.id,\n                                                                    class: _normalizeClass([\n                                                                        'rounded-lg border p-2 text-[10px] transition-all',\n                                                                        __props.dialogStyle.arrowShape === preset.id\n                                                                            ? 'border-primary bg-primary/10 text-primary'\n                                                                            : 'border-border hover:border-primary/50',\n                                                                    ]),\n                                                                    onClick: ($event) => (updateShape('arrowShape', preset.id))\n                                                                }, _toDisplayString(preset.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_52));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]),\n                                                    _createCommentVNode(\"  \"),\n                                                    _createElementVNode(\"div\", _hoisted_53, [\n                                                        _cache[36] || (_cache[36] = _createElementVNode(\"label\", { class: \"text-muted-foreground text-xs\" }, \"\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"div\", _hoisted_54, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(indicatorShapePresets), (preset) => {\n                                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                                    key: preset.id,\n                                                                    class: _normalizeClass([\n                                                                        'rounded-lg border p-2 text-[10px] transition-all',\n                                                                        __props.dialogStyle.indicatorShape === preset.id\n                                                                            ? 'border-primary bg-primary/10 text-primary'\n                                                                            : 'border-border hover:border-primary/50',\n                                                                    ]),\n                                                                    onClick: ($event) => (updateShape('indicatorShape', preset.id))\n                                                                }, _toDisplayString(preset.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_55));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]),\n                                                    _createCommentVNode(\"  \"),\n                                                    _createElementVNode(\"div\", _hoisted_56, [\n                                                        _createElementVNode(\"label\", _hoisted_57, \" (\" + _toDisplayString(__props.dialogStyle.fontSize) + \"px)\", 1 /* TEXT */),\n                                                        _createElementVNode(\"input\", {\n                                                            type: \"range\",\n                                                            value: __props.dialogStyle.fontSize,\n                                                            min: \"12\",\n                                                            max: \"24\",\n                                                            step: \"1\",\n                                                            class: \"w-full\",\n                                                            onInput: _cache[10] || (_cache[10] =\n                                                                e => __props.onDialogStyleChange({\n                                                                    ...__props.dialogStyle,\n                                                                    fontSize: parseInt(e.target.value),\n                                                                }))\n                                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_58)\n                                                    ])\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            _createCommentVNode(\"  \"),\n                                            (activeTab.value === 'colors')\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_59, [\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.boxBackground,\n                                                        \"onUpdate:value\": _cache[11] || (_cache[11] = v => updateColor('boxBackground', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"]),\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.boxBorder,\n                                                        \"onUpdate:value\": _cache[12] || (_cache[12] = v => updateColor('boxBorder', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"]),\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.nameBackground,\n                                                        \"onUpdate:value\": _cache[13] || (_cache[13] = v => updateColor('nameBackground', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"]),\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.nameText,\n                                                        \"show-alpha\": false,\n                                                        \"onUpdate:value\": _cache[14] || (_cache[14] = v => updateColor('nameText', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"]),\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.dialogText,\n                                                        \"show-alpha\": false,\n                                                        \"onUpdate:value\": _cache[15] || (_cache[15] = v => updateColor('dialogText', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"]),\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.narrationText,\n                                                        \"show-alpha\": false,\n                                                        \"onUpdate:value\": _cache[16] || (_cache[16] = v => updateColor('narrationText', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"]),\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.arrowBackground,\n                                                        \"onUpdate:value\": _cache[17] || (_cache[17] = v => updateColor('arrowBackground', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"]),\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.arrowIcon,\n                                                        \"show-alpha\": false,\n                                                        \"onUpdate:value\": _cache[18] || (_cache[18] = v => updateColor('arrowIcon', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"]),\n                                                    _createVNode(ColorSlider, {\n                                                        label: \"\",\n                                                        value: __props.dialogStyle.colors.indicatorColor,\n                                                        \"onUpdate:value\": _cache[19] || (_cache[19] = v => updateColor('indicatorColor', v))\n                                                    }, null, 8 /* PROPS */, [\"value\"])\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettingsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettingsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SettingsPanel.vue?vue&type=style&index=0&id=13dbee10&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-13dbee10\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"bg-card/95 text-foreground relative max-h-[85vh] w-[90%] max-w-2xl rounded-lg shadow-2xl backdrop-blur-md\" };\nconst _hoisted_2 = { class: \"theater-content max-h-[calc(85vh-100px)] overflow-y-auto px-6 py-4\" };\nimport { nextTick, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TheaterPanel',\n    props: {\n        show: { type: Boolean },\n        messageId: {},\n        statusBlock: {},\n        onClose: { type: Function }\n    },\n    setup(__props) {\n        const props = __props;\n        const theaterContainer = ref(null);\n        const theaterRendered = ref(false);\n        function handleClose() {\n            props.onClose();\n        }\n        // \n        function renderTheater() {\n            if (!theaterContainer.value) {\n                return;\n            }\n            const container = theaterContainer.value;\n            const theaterContent = props.statusBlock?. || '';\n            // \n            container.innerHTML = '';\n            if (!theaterContent || theaterContent.trim() === '') {\n                const emptyMsg = document.createElement('div');\n                emptyMsg.textContent = '';\n                emptyMsg.style.textAlign = 'center';\n                emptyMsg.style.color = '#788a82';\n                emptyMsg.style.padding = '20px';\n                container.appendChild(emptyMsg);\n                theaterRendered.value = true;\n                return;\n            }\n            //  :  \n            const matches = [...theaterContent.matchAll(/([^:]+)[:](.*?)/g)];\n            if (matches.length === 0) {\n                // \n                const textDiv = document.createElement('div');\n                textDiv.textContent = theaterContent;\n                textDiv.style.whiteSpace = 'pre-wrap';\n                textDiv.style.color = '#333';\n                textDiv.style.padding = '12px';\n                container.appendChild(textDiv);\n                theaterRendered.value = true;\n                return;\n            }\n            // \n            const firstSpeaker = matches[0]?.[1]?.trim() || '';\n            const mainCharacterName = firstSpeaker.split('')[0].split('(')[0].trim();\n            matches.forEach(match => {\n                const fullSpeaker = match[1]?.trim();\n                const content = match[2]?.trim() || '';\n                const speakerName = fullSpeaker.split('')[0].split('(')[0].trim();\n                const isMainCharacter = speakerName === mainCharacterName;\n                // \n                const bubble = document.createElement('div');\n                bubble.className = 'theater-bubble';\n                bubble.style.display = 'flex';\n                bubble.style.justifyContent = isMainCharacter ? 'flex-end' : 'flex-start';\n                bubble.style.marginBottom = '12px';\n                // \n                const bubbleContent = document.createElement('div');\n                bubbleContent.style.maxWidth = '70%';\n                bubbleContent.style.padding = '10px 14px';\n                bubbleContent.style.borderRadius = '12px';\n                bubbleContent.style.background = isMainCharacter ? '#e0f2fe' : '#f3f4f6';\n                bubbleContent.style.color = '#1f2937';\n                bubbleContent.style.fontSize = '14px';\n                bubbleContent.style.lineHeight = '1.5';\n                bubbleContent.style.wordBreak = 'break-word';\n                bubbleContent.textContent = content;\n                // \n                const speakerLabel = document.createElement('div');\n                speakerLabel.style.fontSize = '12px';\n                speakerLabel.style.color = '#6b7280';\n                speakerLabel.style.marginBottom = '4px';\n                speakerLabel.style.textAlign = isMainCharacter ? 'right' : 'left';\n                speakerLabel.textContent = fullSpeaker;\n                // \n                const bubbleWrapper = document.createElement('div');\n                bubbleWrapper.style.width = '100%';\n                bubbleWrapper.appendChild(speakerLabel);\n                bubbleWrapper.appendChild(bubbleContent);\n                bubble.appendChild(bubbleWrapper);\n                container.appendChild(bubble);\n            });\n            theaterRendered.value = true;\n        }\n        //  show  statusBlock \n        watch(() => [props.show, props.statusBlock], async () => {\n            if (props.show) {\n                await nextTick();\n                if (!theaterRendered.value) {\n                    renderTheater();\n                }\n            }\n            else {\n                theaterRendered.value = false;\n            }\n        }, { immediate: true });\n        return (_ctx, _cache) => {\n            return (__props.show)\n                ? (_openBlock(), _createElementBlock(\"div\", {\n                    key: 0,\n                    class: \"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm\",\n                    onClick: _withModifiers(handleClose, [\"self\"])\n                }, [\n                    _createElementVNode(\"div\", _hoisted_1, [\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", { class: \"border-border/30 flex items-center justify-between border-b px-6 py-3\" }, [\n                            _cache[1] || (_cache[1] = _createElementVNode(\"h2\", { class: \"text-lg font-medium\" }, \"    \", -1 /* CACHED */)),\n                            _createElementVNode(\"button\", {\n                                class: \"hover:bg-muted rounded-full p-1 transition-colors\",\n                                \"aria-label\": \"\",\n                                onClick: handleClose\n                            }, [...(_cache[0] || (_cache[0] = [\n                                    _createElementVNode(\"svg\", {\n                                        class: \"h-5 w-5\",\n                                        fill: \"none\",\n                                        stroke: \"currentColor\",\n                                        viewBox: \"0 0 24 24\"\n                                    }, [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M6 18L18 6M6 6l12 12\"\n                                        })\n                                    ], -1 /* CACHED */)\n                                ]))])\n                        ]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _createElementVNode(\"div\", {\n                                ref_key: \"theaterContainer\",\n                                ref: theaterContainer,\n                                class: \"theater-bubbles-container space-y-3\"\n                            }, null, 512 /* NEED_PATCH */)\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TheaterPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TheaterPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TheaterPanel.vue?vue&type=style&index=0&id=3c9b7522&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3c9b7522\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, normalizeClass as _normalizeClass, toDisplayString as _toDisplayString, Fragment as _Fragment, createBlock as _createBlock, renderList as _renderList, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"absolute top-4 left-4 z-50 flex flex-col items-start gap-2\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"animate-in fade-in slide-in-from-left-2 text-sm duration-200\"\n};\nconst _hoisted_3 = { class: \"absolute top-4 right-4 z-50 flex flex-col items-end gap-2\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"animate-in fade-in slide-in-from-left-2 text-sm duration-200\"\n};\nconst _hoisted_5 = [\"aria-label\"];\nconst _hoisted_6 = {\n    key: 0,\n    class: \"h-5 w-5\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    viewBox: \"0 0 24 24\"\n};\nconst _hoisted_7 = {\n    key: 1,\n    class: \"h-5 w-5\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    viewBox: \"0 0 24 24\"\n};\nconst _hoisted_8 = { class: \"text-sm\" };\nconst _hoisted_9 = { class: \"animate-in fade-in px-8 text-center text-xl leading-relaxed text-white duration-1000 md:text-2xl\" };\nconst _hoisted_10 = {\n    key: 3,\n    class: \"absolute top-20 right-4 z-40\",\n    style: { \"max-width\": \"280px\" }\n};\nconst _hoisted_11 = { class: \"bg-card/95 text-foreground relative max-h-[85vh] w-[90%] max-w-3xl rounded-lg shadow-2xl backdrop-blur-md\" };\nconst _hoisted_12 = { class: \"border-border/30 flex items-center justify-between border-b px-6 py-3\" };\nconst _hoisted_13 = { class: \"history-scroll-container max-h-[calc(85vh-100px)] overflow-y-auto px-6 py-2\" };\nconst _hoisted_14 = {\n    key: 0,\n    class: \"text-muted-foreground py-12 text-center text-sm\"\n};\nconst _hoisted_15 = [\"onClick\"];\nconst _hoisted_16 = { class: \"font-medium\" };\nconst _hoisted_17 = [\"innerHTML\"];\nconst _hoisted_18 = {\n    key: 4,\n    class: \"bg-border/30 absolute right-3 bottom-0 left-3 h-px opacity-0 transition-opacity group-hover:opacity-100\"\n};\nconst _hoisted_19 = { class: \"flex items-center gap-3\" };\nimport { computed, nextTick, onMounted, onUnmounted, ref, shallowRef, watch } from 'vue';\nimport { defaultDialogStyle } from '../types/galgame';\nimport { hasMotionAndExpression, loadWorldbookResources, parseMessageBlocks, parseStatusBlock, } from '../utils/messageParser';\nimport CharacterSprite from './CharacterSprite.vue';\nimport CharacterStatusPanel from './CharacterStatusPanel.vue';\nimport ChoiceBox from './ChoiceBox.vue';\nimport DialogBox from './DialogBox.vue';\nimport NoteCard from './NoteCard.vue';\nimport SettingsPanel from './SettingsPanel.vue';\nimport TheaterPanel from './TheaterPanel.vue';\n// localStorage \nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'GalgamePlayer',\n    setup(__props) {\n        const STORAGE_KEYS = {\n            DIALOG_STYLE: 'galgame_dialog_style',\n            SPRITE_SETTINGS: 'galgame_sprite_settings',\n        };\n        const containerRef = ref(null);\n        const autoPlayTimerRef = ref(null);\n        //  -  shallowRef \n        const dialogues = shallowRef([]);\n        const currentDialogIndex = ref(0);\n        const currentDialogue = computed(() => dialogues.value[currentDialogIndex.value] || null);\n        // UI \n        const showSettings = ref(false);\n        const isFullscreen = ref(false);\n        const autoPlay = ref(false);\n        const autoPlaySpeed = ref(3000);\n        const menuExpanded = ref(false);\n        const characterMenuExpanded = ref(false);\n        const showCharacterPanel = ref(false);\n        const showTheaterPanel = ref(false);\n        const blackScreen = ref(false);\n        const blackScreenText = ref('');\n        const showChoices = ref(false);\n        const customModeEnabled = ref(false);\n        const showInputBox = ref(false);\n        const inputText = ref('');\n        const inputRef = ref(null);\n        // \n        const isStreaming = ref(false);\n        const streamingText = ref('');\n        const streamingMessageId = ref(null);\n        //  -  localStorage \n        const spriteSettings = ref(loadFromStorage(STORAGE_KEYS.SPRITE_SETTINGS, {\n            scale: 1,\n            positionX: 50,\n            positionY: 50,\n        }));\n        const dialogStyle = ref(loadFromStorage(STORAGE_KEYS.DIALOG_STYLE, defaultDialogStyle));\n        const previewStyle = ref({ ...dialogStyle.value });\n        // Live2D  -  shallowRef\n        const live2dModels = shallowRef([]);\n        //  localStorage \n        function loadFromStorage(key, defaultValue) {\n            try {\n                const stored = localStorage.getItem(key);\n                if (stored) {\n                    return JSON.parse(stored);\n                }\n            }\n            catch (e) {\n                console.warn(` localStorage  ${key} :`, e);\n            }\n            return defaultValue;\n        }\n        //  localStorage\n        function saveToStorage(key, value) {\n            try {\n                localStorage.setItem(key, JSON.stringify(value));\n            }\n            catch (e) {\n                console.warn(` localStorage ${key} :`, e);\n            }\n        }\n        //  localStorage\n        watch(dialogStyle, newStyle => {\n            saveToStorage(STORAGE_KEYS.DIALOG_STYLE, newStyle);\n        }, { deep: true });\n        watch(spriteSettings, newSettings => {\n            saveToStorage(STORAGE_KEYS.SPRITE_SETTINGS, newSettings);\n        }, { deep: true });\n        //  - iframe\n        //  width  aspect-ratio vh \n        const containerStyle = computed(() => {\n            const isPortrait = window.innerHeight > window.innerWidth;\n            const isFullscreenMode = !!document.fullscreenElement;\n            const targetAspectRatio = 16 / 9;\n            if (isPortrait && isFullscreenMode) {\n                // 90\n                // 16:9\n                //  width  aspect-ratio iframe\n                const screenHeight = window.innerHeight; // \n                return {\n                    width: `${screenHeight}px`,\n                    aspectRatio: '16 / 9',\n                    transform: 'rotate(90deg)',\n                    transformOrigin: 'center center',\n                    position: 'absolute',\n                    left: '50%',\n                    top: '50%',\n                    marginLeft: `-${screenHeight / 2}px`,\n                    marginTop: `-${screenHeight / targetAspectRatio / 2}px`,\n                    background: 'transparent',\n                };\n            }\n            //  width  aspect-ratio\n            //  CSS \n            return {\n                width: '100%',\n                aspectRatio: '16 / 9',\n                margin: '0 auto',\n                background: 'transparent',\n            };\n        });\n        // \n        const backgroundImage = computed(() => {\n            const dialogue = currentDialogue.value;\n            // URL\n            if (dialogue?.sceneImageUrl) {\n                return dialogue.sceneImageUrl;\n            }\n            // sceneURL\n            if (dialogue?.scene) {\n                // sceneURL\n                if (dialogue.scene.match(/^https?:\\/\\//) || dialogue.scene.match(/^\\//)) {\n                    return dialogue.scene;\n                }\n            }\n            // \n            return null;\n        });\n        // \n        const currentSpriteType = computed(() => {\n            const dialogue = currentDialogue.value;\n            if (dialogue?.sprite?.type) {\n                console.info('[GalgamePlayer] currentSpriteType:  dialogue.sprite.type ', dialogue.sprite.type);\n                return dialogue.sprite.type;\n            }\n            // CG\n            if (dialogue?.isCG || dialogue?.type === 'cg') {\n                console.info('[GalgamePlayer] currentSpriteType: CG none');\n                return 'none';\n            }\n            //  Live2D  Live2D\n            if (dialogue?.character) {\n                const hasLive2d = live2dModels.value.some(m => m.name === dialogue.character);\n                console.info('[GalgamePlayer] currentSpriteType: ', {\n                    character: dialogue.character,\n                    hasLive2d,\n                    availableModels: live2dModels.value.map(m => ({ id: m.id, name: m.name })),\n                });\n                return hasLive2d ? 'live2d' : 'image';\n            }\n            console.info('[GalgamePlayer] currentSpriteType:  image');\n            return 'image';\n        });\n        const currentImageUrl = computed(() => {\n            const dialogue = currentDialogue.value;\n            return dialogue?.sprite?.imageUrl || '/placeholder-user.jpg';\n        });\n        const currentLive2dModelId = computed(() => {\n            const dialogue = currentDialogue.value;\n            if (dialogue?.sprite?.live2dModelId) {\n                console.info('[GalgamePlayer] currentLive2dModelId:  dialogue.sprite.live2dModelId ', dialogue.sprite.live2dModelId);\n                return dialogue.sprite.live2dModelId;\n            }\n            // \n            if (dialogue?.character) {\n                const model = live2dModels.value.find(m => m.name === dialogue.character);\n                console.info('[GalgamePlayer] currentLive2dModelId: ', {\n                    character: dialogue.character,\n                    foundModel: model ? { id: model.id, name: model.name } : null,\n                    availableModels: live2dModels.value.map(m => ({ id: m.id, name: m.name })),\n                });\n                return model?.id;\n            }\n            console.info('[GalgamePlayer] currentLive2dModelId: ID');\n            return undefined;\n        });\n        // \n        const userMessageEdits = ref(new Map());\n        // \n        async function loadDialoguesFromTavern() {\n            try {\n                const messages = getChatMessages('0-{{lastMessageId}}');\n                const newDialogues = [];\n                let lastScene; // \n                let lastSceneImageUrl; // \n                let lastSpriteState; // /Live2D \n                let lastMotion; //  Live2D \n                let lastExpression; //  Live2D \n                let lastIsCG; // CG\n                let lastCgImageUrl; // CGURL\n                // \n                const inheritSceneAndBackground = (dialogue) => {\n                    if (!dialogue.scene && lastScene) {\n                        dialogue.scene = lastScene;\n                    }\n                    if (!dialogue.sceneImageUrl &&\n                        lastSceneImageUrl &&\n                        (!dialogue.scene || (lastScene && dialogue.scene === lastScene))) {\n                        dialogue.sceneImageUrl = lastSceneImageUrl;\n                    }\n                };\n                // CGnarrationCGCG\n                const inheritCGState = (dialogue) => {\n                    if (dialogue.type === 'blackscreen')\n                        return;\n                    // CGCGCG\n                    if (dialogue.isCG === undefined && lastIsCG) {\n                        dialogue.isCG = lastIsCG;\n                        if (lastCgImageUrl) {\n                            dialogue.cgImageUrl = lastCgImageUrl;\n                        }\n                    }\n                };\n                // /Live2D \n                const inheritSpriteState = (dialogue) => {\n                    if (dialogue.type === 'blackscreen')\n                        return;\n                    if (lastSpriteState) {\n                        dialogue.sprite = { ...lastSpriteState };\n                    }\n                    if (!dialogue.motion && lastMotion) {\n                        dialogue.motion = lastMotion;\n                    }\n                    if (!dialogue.expression && lastExpression) {\n                        dialogue.expression = lastExpression;\n                    }\n                };\n                // \n                const updateSceneState = (dialogue) => {\n                    if (dialogue.type === 'blackscreen')\n                        return;\n                    if (dialogue.scene) {\n                        lastScene = dialogue.scene;\n                    }\n                    if (dialogue.sceneImageUrl) {\n                        lastSceneImageUrl = dialogue.sceneImageUrl;\n                    }\n                };\n                // /Live2D \n                const updateSpriteStateFromCharacter = (dialogue) => {\n                    // characterisCG === falseCG\n                    if (dialogue.isCG === false) {\n                        // CG/Live2D\n                        lastSpriteState = dialogue.sprite ? { ...dialogue.sprite } : undefined;\n                        lastMotion = dialogue.motion;\n                        lastExpression = dialogue.expression;\n                        lastIsCG = false;\n                        lastCgImageUrl = undefined;\n                    }\n                    else if (dialogue.isCG === true) {\n                        // CG/Live2D\n                        lastSpriteState = undefined;\n                        lastMotion = undefined;\n                        lastExpression = undefined;\n                        lastIsCG = true;\n                        lastCgImageUrl = dialogue.cgImageUrl;\n                    }\n                    else {\n                        // isCG\n                        lastSpriteState = dialogue.sprite ? { ...dialogue.sprite } : undefined;\n                        lastMotion = dialogue.motion;\n                        lastExpression = dialogue.expression;\n                        // isCGCG\n                        if (dialogue.isCG !== undefined) {\n                            lastIsCG = dialogue.isCG;\n                            lastCgImageUrl = dialogue.cgImageUrl;\n                        }\n                    }\n                };\n                // \n                for (const msg of messages) {\n                    const messageText = msg.message || '';\n                    // \n                    const blocks = await parseMessageBlocks(messageText, lastScene);\n                    // \n                    // StatusBlock  <content> \n                    if (blocks.length === 0) {\n                        continue;\n                    }\n                    // StatusBlock\n                    const statusBlock = parseStatusBlock(messageText);\n                    // [[choice||1||||]]\n                    const newFormatChoiceBlocks = [];\n                    const oldFormatChoiceBlocks = [];\n                    // \n                    for (const block of blocks) {\n                        if (block.type === 'choice') {\n                            if (block.choiceText && block.choiceCharacter && block.choiceResponse) {\n                                // \n                                newFormatChoiceBlocks.push({\n                                    choiceText: block.choiceText,\n                                    choiceCharacter: block.choiceCharacter,\n                                    choiceResponse: block.choiceResponse,\n                                });\n                            }\n                            else if (block.choices && block.choices.length > 0) {\n                                // \n                                oldFormatChoiceBlocks.push({ choices: block.choices });\n                            }\n                        }\n                    }\n                    // \n                    for (const block of blocks) {\n                        if (block.type === 'character') {\n                            const motionToUse = block.motionFile || block.motion;\n                            const expressionToUse = block.expressionFile || block.expression;\n                            // motionexpressionLive2D\n                            const hasMotionExpr = hasMotionAndExpression(block.character || '', motionToUse, expressionToUse, live2dModels.value);\n                            const live2dModel = live2dModels.value.find(m => m.name === block.character);\n                            const hasSpriteImage = !!block.spriteImageUrl || !!msg.extra?.sprite_image;\n                            console.info('[] :', {\n                                character: block.character,\n                                hasLive2dModel: !!live2dModel,\n                                hasMotionExpr,\n                                hasSpriteImage,\n                                spriteImageUrl: block.spriteImageUrl,\n                                blockIsCG: block.isCG,\n                            });\n                            // CG\n                            // 1. CGblock.isCG === trueCG\n                            // 2. CGCG\n                            // 3. block.isCG === false\n                            // 4. CGCG\n                            const isCGMode = block.isCG === true;\n                            console.info('[] CG:', {\n                                isCGMode,\n                                reason: block.isCG === true\n                                    ? 'CGCG'\n                                    : block.isCG === false\n                                        ? ''\n                                        : 'isCG',\n                            });\n                            const dialogue = {\n                                character: block.character,\n                                text: block.text || '',\n                                message_id: msg.message_id,\n                                role: 'assistant',\n                                type: isCGMode ? 'cg' : undefined,\n                                scene: block.scene,\n                                sceneImageUrl: block.sceneImageUrl, // URL\n                                motion: motionToUse,\n                                expression: expressionToUse,\n                                //  isThrough**\n                                isCG: isCGMode,\n                                cgImageUrl: isCGMode ? block.cgImageUrl || block.scene : undefined, // CG URL\n                                statusBlock,\n                                sprite: isCGMode\n                                    ? { type: 'none' } // CG\n                                    : (() => {\n                                        const imageUrl = block.spriteImageUrl || msg.extra?.sprite_image || undefined;\n                                        console.info('[] :', block.character, 'spriteImageUrl:', block.spriteImageUrl, 'imageUrl:', imageUrl, 'spriteType:', live2dModel ? 'live2d' : 'image', 'isCGMode:', isCGMode, 'hasSpriteImage:', hasSpriteImage);\n                                        return {\n                                            type: live2dModel ? 'live2d' : 'image',\n                                            live2dModelId: live2dModel?.id,\n                                            imageUrl,\n                                        };\n                                    })(),\n                            };\n                            inheritSceneAndBackground(dialogue);\n                            newDialogues.push(dialogue);\n                            updateSceneState(dialogue);\n                            updateSpriteStateFromCharacter(dialogue);\n                        }\n                        else if (block.type === 'narration') {\n                            const dialogue = {\n                                character: '',\n                                text: block.message || '',\n                                type: 'narration',\n                                message_id: msg.message_id,\n                                role: 'system',\n                                scene: block.scene,\n                                sceneImageUrl: block.sceneImageUrl, // URL\n                                statusBlock,\n                            };\n                            inheritSceneAndBackground(dialogue);\n                            inheritSpriteState(dialogue);\n                            inheritCGState(dialogue); // CGnarrationCG\n                            newDialogues.push(dialogue);\n                            updateSceneState(dialogue);\n                        }\n                        else if (block.type === 'blacktext') {\n                            const dialogue = {\n                                character: '',\n                                text: block.message || '',\n                                type: 'blackscreen',\n                                message_id: msg.message_id,\n                                role: 'system',\n                                statusBlock,\n                            };\n                            // blacktextCGCG\n                            lastIsCG = undefined;\n                            lastCgImageUrl = undefined;\n                            newDialogues.push(dialogue);\n                        }\n                        else if (block.type === 'user') {\n                            const dialogue = {\n                                character: '',\n                                text: block.message || '',\n                                type: 'user',\n                                message_id: msg.message_id,\n                                role: 'user',\n                                scene: block.scene,\n                                sceneImageUrl: block.sceneImageUrl, // URL\n                                isEditable: true,\n                                //  isThrough**\n                                statusBlock,\n                            };\n                            inheritSceneAndBackground(dialogue);\n                            inheritSpriteState(dialogue);\n                            inheritCGState(dialogue); // CG\n                            // \n                            const edit = userMessageEdits.value.get(msg.message_id);\n                            if (edit) {\n                                if (edit.deleted) {\n                                    dialogue.isDeleted = true;\n                                }\n                                else if (edit.text !== undefined) {\n                                    dialogue.editedText = edit.text;\n                                    dialogue.text = edit.text;\n                                }\n                            }\n                            newDialogues.push(dialogue);\n                            updateSceneState(dialogue);\n                        }\n                        else if (block.type === 'note') {\n                            // \n                            if (newDialogues.length > 0) {\n                                const lastDialogue = newDialogues[newDialogues.length - 1];\n                                lastDialogue.noteContent = block.noteContent;\n                            }\n                            else {\n                                // \n                                const dialogue = {\n                                    character: '',\n                                    text: '',\n                                    type: 'narration',\n                                    message_id: msg.message_id,\n                                    role: 'system',\n                                    noteContent: block.noteContent,\n                                    statusBlock,\n                                };\n                                inheritSceneAndBackground(dialogue);\n                                newDialogues.push(dialogue);\n                            }\n                        }\n                        else if (block.type === 'choice') {\n                            // \n                        }\n                    }\n                    // \n                    if (newFormatChoiceBlocks.length > 0) {\n                        // 1\n                        //  choice \n                        const choiceDialogue = {\n                            character: '',\n                            text: '',\n                            type: 'choice',\n                            message_id: msg.message_id,\n                            role: 'system',\n                            options: newFormatChoiceBlocks.map((choiceBlock, index) => ({\n                                id: `choice_${index}`,\n                                text: choiceBlock.choiceText,\n                                character: choiceBlock.choiceCharacter,\n                                response: choiceBlock.choiceResponse,\n                            })),\n                            statusBlock,\n                        };\n                        inheritSceneAndBackground(choiceDialogue);\n                        inheritSpriteState(choiceDialogue);\n                        inheritCGState(choiceDialogue); // CG\n                        newDialogues.push(choiceDialogue);\n                        updateSceneState(choiceDialogue);\n                    }\n                    else if (oldFormatChoiceBlocks.length > 0) {\n                        // 2AI\n                        // \n                        const allChoices = [];\n                        for (const choiceBlock of oldFormatChoiceBlocks) {\n                            allChoices.push(...choiceBlock.choices);\n                        }\n                        const choiceDialogue = {\n                            character: '',\n                            text: '',\n                            type: 'choice',\n                            message_id: msg.message_id,\n                            role: 'system',\n                            options: allChoices.map((choice, index) => ({\n                                id: `choice_${index}`,\n                                text: choice,\n                            })),\n                            statusBlock,\n                        };\n                        inheritSceneAndBackground(choiceDialogue);\n                        inheritSpriteState(choiceDialogue);\n                        inheritCGState(choiceDialogue); // CG\n                        newDialogues.push(choiceDialogue);\n                        updateSceneState(choiceDialogue);\n                    }\n                }\n                // \n                const filteredDialogues = newDialogues.filter(d => !d.isDeleted);\n                // \n                const previousLength = dialogues.value.length;\n                dialogues.value = filteredDialogues;\n                // \n                // previousLength === 0\n                if (previousLength === 0 && filteredDialogues.length > 0) {\n                    currentDialogIndex.value = 0;\n                }\n                // \n                // \n                else if (currentDialogIndex.value >= filteredDialogues.length) {\n                    // \n                    currentDialogIndex.value = Math.max(0, filteredDialogues.length - 1);\n                }\n                // \n                console.info(` ${dialogues.value.length} `);\n                // \n                if (dialogues.value.length === 0) {\n                    loadTestDialogues();\n                }\n            }\n            catch (error) {\n                console.error(':', error);\n                // \n                loadTestDialogues();\n            }\n        }\n        // \n        function loadTestDialogues() {\n            console.info('');\n            dialogues.value = [\n                {\n                    character: '',\n                    text: ' Galgame ',\n                    type: undefined,\n                    scene: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=1920&h=1080&fit=crop',\n                    sprite: { type: 'image', imageUrl: '/placeholder-user.jpg' },\n                },\n                {\n                    character: '',\n                    text: '',\n                    isThrough: false,\n                },\n                {\n                    character: '',\n                    text: '',\n                    type: 'narration',\n                },\n                {\n                    character: '',\n                    text: '*through*  through ',\n                    isThrough: true,\n                },\n                {\n                    character: '',\n                    text: '...',\n                    type: 'blackscreen',\n                },\n                {\n                    character: '',\n                    text: '',\n                },\n                {\n                    character: '',\n                    text: '',\n                },\n                {\n                    character: '',\n                    text: '',\n                    type: 'choice',\n                    options: [\n                        { id: 'opt1', text: '' },\n                        { id: 'opt2', text: '' },\n                        { id: 'opt3', text: '' },\n                    ],\n                },\n                {\n                    character: '',\n                    text: ' Live2D ',\n                },\n                {\n                    character: '',\n                    text: '',\n                },\n                {\n                    character: '',\n                    text: '---  Live2D  ---',\n                    type: 'narration',\n                },\n                {\n                    character: '',\n                    text: ' 1 Live2D  -  + ',\n                    type: 'narration',\n                    scene: '',\n                },\n                {\n                    character: '',\n                    text: ' Live2D \"\"\"\"',\n                    type: undefined,\n                    scene: '',\n                    motion: '',\n                    expression: '',\n                    sprite: { type: 'live2d', live2dModelId: '' },\n                },\n                {\n                    character: '',\n                    text: ' 2 Live2D  -  + ',\n                    type: 'narration',\n                    scene: '',\n                },\n                {\n                    character: '',\n                    text: '\"\"\"\"',\n                    type: undefined,\n                    scene: '',\n                    motion: '',\n                    expression: '',\n                    sprite: { type: 'live2d', live2dModelId: '' },\n                },\n                {\n                    character: '',\n                    text: ' 3 Live2D  -  + ',\n                    type: 'narration',\n                    scene: '',\n                },\n                {\n                    character: '',\n                    text: '\"\"\"\"',\n                    type: undefined,\n                    scene: '',\n                    motion: '',\n                    expression: '',\n                    sprite: { type: 'live2d', live2dModelId: '' },\n                },\n                {\n                    character: '',\n                    text: ' 4 Live2D ',\n                    type: 'narration',\n                    scene: '',\n                },\n                {\n                    character: '',\n                    text: ' Live2D ',\n                    type: undefined,\n                    scene: '',\n                    sprite: {\n                        type: 'image',\n                        imageUrl: 'https://iili.io/f01ajiN.png', // NPC \n                    },\n                },\n                {\n                    character: '',\n                    text: ' 5 -  + ',\n                    type: 'narration',\n                },\n                {\n                    character: '',\n                    text: '\"\"\"\"',\n                    type: undefined,\n                    motion: '',\n                    expression: '',\n                    sprite: { type: 'live2d', live2dModelId: '' },\n                },\n                {\n                    character: '',\n                    text: ' 6 Live2D  -  + ',\n                    type: 'narration',\n                    scene: '',\n                },\n                {\n                    character: '',\n                    text: '\"\"\"\"',\n                    type: undefined,\n                    scene: '',\n                    motion: '',\n                    expression: '',\n                    sprite: { type: 'live2d', live2dModelId: '' },\n                },\n                {\n                    character: '',\n                    text: ' 7 Live2D  -  + ',\n                    type: 'narration',\n                    scene: '',\n                },\n                {\n                    character: '',\n                    text: '\"\"\"\"',\n                    type: undefined,\n                    scene: '',\n                    motion: '',\n                    expression: '',\n                    sprite: { type: 'live2d', live2dModelId: '' },\n                },\n                {\n                    character: '',\n                    text: '--- Live2D  ---',\n                    type: 'narration',\n                },\n                {\n                    character: '',\n                    text: '',\n                    type: 'narration',\n                },\n            ];\n        }\n        //  Live2D \n        async function loadLive2dModels() {\n            try {\n                const modelsMap = new Map();\n                // 1. \n                const variables = getVariables({ type: 'character' }) || {};\n                if (variables?.live2d_models && Array.isArray(variables.live2d_models)) {\n                    for (const model of variables.live2d_models) {\n                        if (model.name) {\n                            modelsMap.set(model.name, { ...model });\n                        }\n                    }\n                }\n                // 2.  defaultAnimation \n                try {\n                    const resources = await loadWorldbookResources();\n                    for (const [modelName, modelData] of resources.models.entries()) {\n                        const existingModel = modelsMap.get(modelName);\n                        if (existingModel) {\n                            //  defaultAnimation \n                            if (modelData.defaultAnimation) {\n                                existingModel.defaultAnimation = modelData.defaultAnimation;\n                            }\n                            // \n                            if (modelData.files) {\n                                // \n                                if (modelData.files.model3) {\n                                    existingModel.modelPath = modelData.files.model3.split('/').pop() || existingModel.modelPath;\n                                    //  basePath\n                                    const basePath = modelData.files.model3.substring(0, modelData.files.model3.lastIndexOf('/') + 1);\n                                    existingModel.basePath = basePath || existingModel.basePath;\n                                }\n                                if (modelData.files.textures) {\n                                    existingModel.textures = modelData.files.textures;\n                                }\n                            }\n                            //  motions  expressions\n                            if (modelData.motions && modelData.motions.length > 0) {\n                                existingModel.motions = modelData.motions.map(m => ({\n                                    group: m.group || 'idle',\n                                    name: m.name,\n                                    file: m.file,\n                                }));\n                            }\n                            if (modelData.expressions && modelData.expressions.length > 0) {\n                                existingModel.expressions = modelData.expressions.map(e => e.name || e.file);\n                            }\n                            //  textMappings\n                            if (modelData.textMappings) {\n                                existingModel.textMappings = modelData.textMappings;\n                            }\n                        }\n                        else {\n                            // \n                            const model3Url = modelData.files?.model3 || '';\n                            //  model3  URL basePath\n                            const isFullUrl = model3Url.startsWith('http://') || model3Url.startsWith('https://');\n                            const basePath = isFullUrl\n                                ? model3Url.substring(0, model3Url.lastIndexOf('/') + 1)\n                                : model3Url.substring(0, model3Url.lastIndexOf('/') + 1);\n                            //  model3  URLmodelPath  URL\n                            const modelPath = isFullUrl ? model3Url : model3Url ? model3Url.split('/').pop() : '';\n                            const newModel = {\n                                name: modelName, // modelNamename\"\"\n                                id: modelName, // modelNameid\n                                basePath,\n                                modelPath,\n                                version: 3, // Live2D Cubism 3.0\n                                textures: modelData.files?.textures || [],\n                                motions: modelData.motions?.map(m => ({\n                                    group: m.group || 'idle',\n                                    name: m.name,\n                                    file: m.file,\n                                })) || [],\n                                expressions: modelData.expressions?.map(e => e.name || e.file) || [],\n                                defaultAnimation: modelData.defaultAnimation,\n                                textMappings: modelData.textMappings, //  textMappings \n                            };\n                            console.info(`[GalgamePlayer] : ${modelName}`, {\n                                modelPath,\n                                basePath,\n                                isFullUrl,\n                                motionsCount: newModel.motions.length,\n                                expressionsCount: newModel.expressions.length,\n                            });\n                            modelsMap.set(modelName, newModel);\n                            console.info(`: ${modelName}`);\n                        }\n                    }\n                }\n                catch (error) {\n                    console.warn(':', error);\n                }\n                live2dModels.value = Array.from(modelsMap.values());\n                console.info(`[GalgamePlayer]  ${live2dModels.value.length}  Live2D `);\n                console.info('[GalgamePlayer] :', live2dModels.value.map(m => ({\n                    id: m.id,\n                    name: m.name,\n                    modelPath: m.modelPath,\n                    basePath: m.basePath,\n                    motionsCount: m.motions?.length || 0,\n                    expressionsCount: m.expressions?.length || 0,\n                    hasTextMappings: !!m.textMappings,\n                })));\n            }\n            catch (error) {\n                console.error(' Live2D :', error);\n            }\n        }\n        function nextDialogue(skipBlackscreen = false) {\n            if (currentDialogIndex.value < dialogues.value.length - 1) {\n                const nextIndex = currentDialogIndex.value + 1;\n                currentDialogIndex.value = nextIndex;\n                if (skipBlackscreen) {\n                    blackScreen.value = false;\n                }\n                showChoices.value = false;\n            }\n        }\n        function prevDialogue() {\n            if (currentDialogIndex.value > 0) {\n                currentDialogIndex.value--;\n                showChoices.value = false;\n            }\n        }\n        // \n        watch(() => [currentDialogIndex.value, currentDialogue.value], () => {\n            const dialogue = currentDialogue.value;\n            if (!dialogue)\n                return;\n            // \n            if (streamingMessageId.value !== null && dialogue.message_id !== streamingMessageId.value) {\n                isStreaming.value = false;\n                streamingText.value = '';\n                streamingMessageId.value = null;\n            }\n            if (dialogue.type === 'blackscreen') {\n                blackScreenText.value = dialogue.text;\n                blackScreen.value = true;\n                showChoices.value = false;\n            }\n            else if (dialogue.type === 'choice') {\n                showChoices.value = true;\n                blackScreen.value = false;\n            }\n            else {\n                blackScreen.value = false;\n                showChoices.value = false;\n            }\n        }, { immediate: true });\n        // \n        watch(() => [autoPlay.value, autoPlaySpeed.value, currentDialogIndex.value, showChoices.value, currentDialogue.value], () => {\n            if (autoPlayTimerRef.value) {\n                clearTimeout(autoPlayTimerRef.value);\n                autoPlayTimerRef.value = null;\n            }\n            if (autoPlay.value && currentDialogIndex.value < dialogues.value.length - 1 && !showChoices.value) {\n                const dialogue = currentDialogue.value;\n                const delay = dialogue?.type === 'blackscreen' ? autoPlaySpeed.value + 2000 : autoPlaySpeed.value;\n                autoPlayTimerRef.value = setTimeout(() => {\n                    nextDialogue();\n                }, delay);\n            }\n        }, { immediate: true });\n        // \n        async function toggleFullscreen() {\n            try {\n                if (!document.fullscreenElement && containerRef.value) {\n                    // \n                    if (window.innerHeight > window.innerWidth) {\n                        // \n                        if (screen.orientation && 'lock' in screen.orientation) {\n                            try {\n                                await screen.orientation.lock('landscape');\n                            }\n                            catch (e) {\n                                console.warn(':', e);\n                            }\n                        }\n                    }\n                    await containerRef.value.requestFullscreen();\n                    isFullscreen.value = true;\n                }\n                else {\n                    await document.exitFullscreen();\n                    isFullscreen.value = false;\n                    // \n                    if (screen.orientation && 'unlock' in screen.orientation) {\n                        try {\n                            screen.orientation.unlock();\n                        }\n                        catch (e) {\n                            // \n                        }\n                    }\n                }\n                menuExpanded.value = false;\n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        // \n        const handleFullscreenChange = () => {\n            isFullscreen.value = !!document.fullscreenElement;\n            // \n            nextTick(() => {\n                // \n            });\n        };\n        // \n        const handleResize = () => {\n            // containerStyle  computed\n            nextTick(() => {\n                // \n            });\n        };\n        // \n        const eventCleanups = [];\n        onMounted(() => {\n            document.addEventListener('fullscreenchange', handleFullscreenChange);\n            window.addEventListener('resize', handleResize);\n            window.addEventListener('orientationchange', handleResize);\n            // \n            nextTick(() => {\n                handleResize();\n            });\n            // \n            loadLive2dModels();\n            loadDialoguesFromTavern();\n            // \n            if (typeof eventOn === 'function' && typeof tavern_events !== 'undefined') {\n                // \n                const messageReceivedCleanup = eventOn(tavern_events.MESSAGE_RECEIVED, async (messageId) => {\n                    const messageIdNum = Number(messageId);\n                    //  phone \n                    try {\n                        const messages = getChatMessages(messageIdNum);\n                        if (messages.length > 0) {\n                            const messageText = messages[0].message || '';\n                            await parsePhoneTagsAndUpdateWorldbook(messageText);\n                        }\n                    }\n                    catch (error) {\n                        console.warn(' phone :', error);\n                    }\n                    await loadDialoguesFromTavern();\n                    // \n                    // IDID\n                    if (!Number.isNaN(messageIdNum) && streamingMessageId.value === messageIdNum) {\n                        isStreaming.value = false;\n                        streamingText.value = '';\n                        streamingMessageId.value = null;\n                    }\n                });\n                if (messageReceivedCleanup) {\n                    eventCleanups.push(() => messageReceivedCleanup.stop());\n                }\n                // \n                const messageUpdatedCleanup = eventOn(tavern_events.MESSAGE_UPDATED, async () => {\n                    await loadDialoguesFromTavern();\n                    // \n                    if (streamingMessageId.value !== null) {\n                        const updatedMessage = dialogues.value.find(d => d.message_id === streamingMessageId.value);\n                        if (updatedMessage && updatedMessage.text === streamingText.value) {\n                            isStreaming.value = false;\n                            streamingText.value = '';\n                            streamingMessageId.value = null;\n                        }\n                    }\n                });\n                if (messageUpdatedCleanup) {\n                    eventCleanups.push(() => messageUpdatedCleanup.stop());\n                }\n                // \n                const chatChangedCleanup = eventOn(tavern_events.CHAT_CHANGED, () => {\n                    loadDialoguesFromTavern();\n                    currentDialogIndex.value = 0;\n                    isStreaming.value = false;\n                    streamingText.value = '';\n                    streamingMessageId.value = null;\n                });\n                if (chatChangedCleanup) {\n                    eventCleanups.push(() => chatChangedCleanup.stop());\n                }\n                // token\n                const streamTokenCleanup = eventOn(tavern_events.STREAM_TOKEN_RECEIVED, (text) => {\n                    handleStreamToken(text);\n                });\n                if (streamTokenCleanup) {\n                    eventCleanups.push(() => streamTokenCleanup.stop());\n                }\n            }\n        });\n        onUnmounted(() => {\n            document.removeEventListener('fullscreenchange', handleFullscreenChange);\n            window.removeEventListener('resize', handleResize);\n            window.removeEventListener('orientationchange', handleResize);\n            if (autoPlayTimerRef.value) {\n                clearTimeout(autoPlayTimerRef.value);\n                autoPlayTimerRef.value = null;\n            }\n            // \n            eventCleanups.forEach(cleanup => cleanup());\n            eventCleanups.length = 0;\n        });\n        function handleBlackScreenClick(e) {\n            const rect = e.currentTarget.getBoundingClientRect();\n            const clickX = e.clientX - rect.left;\n            const halfWidth = rect.width / 2;\n            if (clickX < halfWidth) {\n                if (currentDialogIndex.value > 0) {\n                    currentDialogIndex.value--;\n                    blackScreen.value = false;\n                }\n            }\n            else {\n                nextDialogue(true);\n            }\n        }\n        function handleClick() {\n            if (!showSettings.value && !menuExpanded.value && !showChoices.value) {\n                if (!blackScreen.value) {\n                    nextDialogue();\n                }\n            }\n        }\n        //  AI \n        const unreadContacts = ref(new Set());\n        // \n        const hasUnreadMessages = computed(() => {\n            if (typeof window !== 'undefined' && window.getUnreadContacts) {\n                const unreadList = window.getUnreadContacts();\n                return unreadList && unreadList.length > 0;\n            }\n            return false;\n        });\n        //  TheaterPanel \n        if (typeof window !== 'undefined') {\n            window.getUnreadContacts = () => Array.from(unreadContacts.value);\n            window.clearUnreadContact = (contactName) => {\n                unreadContacts.value.delete(contactName);\n            };\n        }\n        //  <phone> \n        async function parsePhoneTagsAndUpdateWorldbook(messageText) {\n            //  <phone> \n            const phoneRegex = /<phone>([\\s\\S]*?)<\\/phone>/gi;\n            const phoneMatches = Array.from(messageText.matchAll(phoneRegex));\n            if (phoneMatches.length === 0)\n                return;\n            //  AI \n            const aiSentContacts = new Set();\n            try {\n                // \n                let targetWorldbookName = null;\n                try {\n                    const charWorldbooks = getCharWorldbookNames('current');\n                    targetWorldbookName = charWorldbooks.primary || charWorldbooks.additional[0] || null;\n                }\n                catch (error) {\n                    console.warn(':', error);\n                }\n                // \n                if (!targetWorldbookName) {\n                    targetWorldbookName = '-';\n                }\n                // \n                let worldbook = [];\n                try {\n                    worldbook = await getWorldbook(targetWorldbookName);\n                }\n                catch {\n                    // \n                    await createOrReplaceWorldbook(targetWorldbookName, []);\n                    worldbook = [];\n                }\n                //  phone \n                for (const match of phoneMatches) {\n                    const phoneContent = match[1].trim();\n                    if (!phoneContent)\n                        continue;\n                    // \n                    // 1. {{}}|\n                    // 2. AI{{}}|\n                    const lines = phoneContent.split('\\n').filter(line => line.trim());\n                    const contactMessages = new Map();\n                    for (const line of lines) {\n                        //  AI {{}}|\n                        let lineMatch = line.match(/^(.+?)[:](.+?)\\|(.+)$/);\n                        let contactName = null;\n                        let speaker = null;\n                        let content = null;\n                        let time = null;\n                        if (lineMatch) {\n                            const potentialContact = lineMatch[1].trim();\n                            const potentialContent = lineMatch[2].trim();\n                            const potentialTime = lineMatch[3].trim();\n                            // \"\"\"\"\n                            const userFormatMatch = potentialContact.match(/^(.+?)$/);\n                            if (userFormatMatch) {\n                                // {{}}|\n                                contactName = userFormatMatch[1].trim();\n                                content = potentialContent;\n                                time = potentialTime;\n                                //  {{user}}  <user>\n                                if (content.includes('{{user}}') || content.includes('<user>')) {\n                                    speaker = '{{user}}';\n                                    content = content.replace(/{{user}}|<user>/gi, '').trim();\n                                }\n                                else {\n                                    speaker = contactName;\n                                }\n                            }\n                            else {\n                                // AI {{}}|\n                                // \n                                if (potentialContact === '{{user}}' || potentialContact === '<user>') {\n                                    // \n                                    // \"\"\n                                    continue;\n                                }\n                                // AI \n                                contactName = potentialContact;\n                                speaker = contactName;\n                                content = potentialContent;\n                                time = potentialTime;\n                                //  AI \n                                aiSentContacts.add(contactName);\n                            }\n                        }\n                        else {\n                            // 2{{}}||\n                            lineMatch = line.match(/^(.+?)\\|(.+?)\\|(.+)$/);\n                            if (lineMatch) {\n                                contactName = lineMatch[1].trim();\n                                content = lineMatch[2].trim();\n                                time = lineMatch[3].trim();\n                                speaker = '{{user}}'; // \n                            }\n                        }\n                        // \n                        if (contactName && content && time && speaker) {\n                            if (!contactMessages.has(contactName)) {\n                                contactMessages.set(contactName, []);\n                            }\n                            contactMessages.get(contactName).push({\n                                speaker,\n                                content,\n                                time,\n                            });\n                        }\n                    }\n                    // \n                    for (const [contactName, messages] of contactMessages.entries()) {\n                        const entryName = `${contactName}`;\n                        // \n                        let entry = worldbook.find(e => e.name === entryName);\n                        if (!entry) {\n                            // \n                            entry = {\n                                name: entryName,\n                                content: '',\n                                comment: '',\n                                priority: 100,\n                                enabled: true,\n                                insertion_order: 0,\n                                case_sensitive: false,\n                                name_regex: false,\n                                content_regex: false,\n                                exclude_recursion: false,\n                                display_index: 0,\n                                probability: 100,\n                                delay: 0,\n                                delay_on: 0,\n                                delay_off: 0,\n                                recursion: {\n                                    prevent_incoming: false,\n                                    prevent_outgoing: false,\n                                    delay_until: null,\n                                },\n                                position: {\n                                    before: [],\n                                    after: [],\n                                    order: 0,\n                                },\n                                disable: false,\n                                exclude: false,\n                                uid: Date.now().toString(),\n                            };\n                            worldbook.push(entry);\n                        }\n                        // \n                        const existingContent = entry.content || '';\n                        const newLines = messages.map(msg => `${msg.speaker}${msg.content}|${msg.time}`);\n                        const updatedContent = existingContent ? `${existingContent}\\n${newLines.join('\\n')}` : newLines.join('\\n');\n                        entry.content = updatedContent;\n                    }\n                }\n                // \n                if (worldbook.length > 0) {\n                    await updateWorldbookWith(targetWorldbookName, () => worldbook);\n                    console.info(` ${targetWorldbookName} `);\n                }\n                // \n                if (aiSentContacts.size > 0) {\n                    aiSentContacts.forEach(contact => {\n                        unreadContacts.value.add(contact);\n                    });\n                    //  TheaterPanel \n                    if (typeof window !== 'undefined' && window.updateTheaterUnreadMarkers) {\n                        window.updateTheaterUnreadMarkers();\n                    }\n                }\n            }\n            catch (error) {\n                console.error(' phone :', error);\n            }\n        }\n        // phone\n        function getTheaterPhoneContent() {\n            if (typeof window !== 'undefined' && window.getTheaterPendingMessages) {\n                return window.getTheaterPendingMessages();\n            }\n            return '';\n        }\n        // phone\n        async function sendUserMessageWithPhone(messageText) {\n            const phoneContent = getTheaterPhoneContent();\n            // phone\n            const finalMessage = phoneContent ? `${messageText}\\n\\n${phoneContent}` : messageText;\n            await createChatMessages([\n                {\n                    role: 'user',\n                    message: finalMessage,\n                },\n            ], { refresh: 'all' });\n        }\n        /**\n         *  </content> \n         */\n        function trimMessageBeforeContentTag(messageText) {\n            //  </content> \n            const contentEndIndex = messageText.indexOf('</content>');\n            if (contentEndIndex !== -1) {\n                //  </content>  </content>\n                return messageText.substring(0, contentEndIndex + 10); // 10  '</content>' \n            }\n            //  </content>\n            return messageText;\n        }\n        // \n        async function handleSaveToStory(text) {\n            try {\n                // ID\n                const currentMessageId = getCurrentMessageId();\n                const chat_message = getChatMessages(currentMessageId)[0];\n                if (!chat_message) {\n                    console.warn('');\n                    return;\n                }\n                // \n                const currentScene = currentDialogue.value?.scene || '{{scene}}';\n                // \n                const newMessage = chat_message.message + '\\n\\n[[user||' + currentScene + '||' + text + ']]';\n                //  setChatMessages \n                await setChatMessages([\n                    {\n                        message_id: currentMessageId,\n                        message: newMessage,\n                    },\n                ], { refresh: 'none' });\n                // \n                const newDialogue = {\n                    character: '',\n                    text,\n                    type: 'user',\n                    isEditable: true,\n                    message_id: getLastMessageId() + 1, // ID\n                };\n                const newDialogues = [...dialogues.value];\n                newDialogues.splice(currentDialogIndex.value + 1, 0, newDialogue);\n                dialogues.value = newDialogues;\n                // \n                currentDialogIndex.value = currentDialogIndex.value + 1;\n                console.info(':', text);\n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        // \n        async function trimChoiceText(messageId, selectedText) {\n            try {\n                const messages = getChatMessages(messageId);\n                if (messages.length === 0)\n                    return;\n                const originalMessage = messages[0];\n                const messageText = originalMessage.message || '';\n                // \n                const choiceBlockRegex = /\\[\\[choice\\|\\|([^\\]]+)\\]\\]/g;\n                let match;\n                let newMessageText = messageText;\n                const allChoiceBlocks = [];\n                // \n                while ((match = choiceBlockRegex.exec(messageText)) !== null) {\n                    const choiceBlock = match[0];\n                    const parts = match[1]\n                        .split('||')\n                        .map(c => c.trim())\n                        .filter(c => c);\n                    allChoiceBlocks.push({ block: choiceBlock, parts });\n                }\n                // user\n                const currentScene = currentDialogue.value?.scene || '{{scene}}';\n                // [[choice||1||||]]\n                const newFormatBlocks = allChoiceBlocks.filter(cb => cb.parts.length >= 3);\n                if (newFormatBlocks.length > 0) {\n                    // \n                    for (const choiceBlock of newFormatBlocks) {\n                        const choiceText = choiceBlock.parts[0];\n                        if (choiceText !== selectedText) {\n                            // \n                            newMessageText = newMessageText.replace(choiceBlock.block, '');\n                            console.info(':', choiceText);\n                        }\n                    }\n                    // \n                    newMessageText = newMessageText.replace(/\\n\\s*\\n/g, '\\n').trim();\n                    // user\n                    //  <content> \n                    const contentMatch = newMessageText.match(/<content>([\\s\\S]*?)<\\/content>/i);\n                    if (contentMatch) {\n                        //  <content> user\n                        const contentText = contentMatch[1];\n                        const userMessage = `\\n[[user||${currentScene}||${selectedText}]]`;\n                        const newContentText = contentText + userMessage;\n                        newMessageText = newMessageText.replace(contentMatch[0], `<content>${newContentText}</content>`);\n                    }\n                    else {\n                        // user\n                        newMessageText = newMessageText + `\\n\\n[[user||${currentScene}||${selectedText}]]`;\n                    }\n                }\n                else {\n                    // [[choice||1||2||3]]\n                    const oldFormatBlocks = allChoiceBlocks.filter(cb => cb.parts.length < 3 && cb.parts.length > 0);\n                    for (const choiceBlock of oldFormatBlocks) {\n                        const selectedIndex = choiceBlock.parts.findIndex(c => c === selectedText);\n                        if (selectedIndex !== -1) {\n                            // \n                            const trimmedChoiceBlock = `[[choice||${selectedText}]]`;\n                            newMessageText = newMessageText.replace(choiceBlock.block, trimmedChoiceBlock);\n                            console.info(':', selectedText);\n                        }\n                    }\n                    // user\n                    const contentMatch = newMessageText.match(/<content>([\\s\\S]*?)<\\/content>/i);\n                    if (contentMatch) {\n                        const contentText = contentMatch[1];\n                        const userMessage = `\\n[[user||${currentScene}||${selectedText}]]`;\n                        const newContentText = contentText + userMessage;\n                        newMessageText = newMessageText.replace(contentMatch[0], `<content>${newContentText}</content>`);\n                    }\n                    else {\n                        newMessageText = newMessageText + `\\n\\n[[user||${currentScene}||${selectedText}]]`;\n                    }\n                }\n                // \n                if (newMessageText !== messageText) {\n                    await setChatMessages([\n                        {\n                            message_id: messageId,\n                            message: newMessageText,\n                        },\n                    ], { refresh: 'none' });\n                    console.info(':', selectedText);\n                }\n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        async function handleChoiceSelect(id, customText) {\n            console.info(':', id, customText);\n            // ID\n            const currentMessageId = currentDialogue.value?.message_id;\n            if (currentMessageId === undefined) {\n                console.warn('ID');\n                nextDialogue();\n                return;\n            }\n            try {\n                // ID\n                const lastMessageId = getLastMessageId();\n                // \n                const isAllDialoguesLoaded = currentDialogIndex.value >= dialogues.value.length - 1;\n                // \n                let messageText = '';\n                let selectedOption;\n                if (id === 'custom' && customText) {\n                    // \n                    messageText = customText.trim();\n                }\n                else {\n                    // \n                    selectedOption = currentDialogue.value?.options?.find(opt => opt.id === id);\n                    messageText = selectedOption?.text || '';\n                }\n                if (!messageText) {\n                    console.warn('');\n                    nextDialogue();\n                    return;\n                }\n                // 1. \n                await trimChoiceText(currentMessageId, messageText);\n                // 2. \n                if (selectedOption && selectedOption.character && selectedOption.response) {\n                    // \n                    const responseDialogue = {\n                        character: selectedOption.character,\n                        text: selectedOption.response,\n                        type: undefined,\n                        message_id: currentMessageId, // ID\n                        role: 'assistant',\n                    };\n                    // \n                    const newDialogues = [...dialogues.value];\n                    newDialogues.splice(currentDialogIndex.value + 1, 0, responseDialogue);\n                    dialogues.value = newDialogues;\n                    // \n                    currentDialogIndex.value = currentDialogIndex.value + 1;\n                }\n                // 3. \n                if (isAllDialoguesLoaded) {\n                    //  </content>  AI \n                    if (currentMessageId !== undefined) {\n                        try {\n                            //  </content> \n                            const messages = getChatMessages(currentMessageId);\n                            if (messages.length > 0) {\n                                const currentMessage = messages[0];\n                                const originalText = currentMessage.message || '';\n                                const trimmedText = trimMessageBeforeContentTag(originalText);\n                                if (trimmedText !== originalText) {\n                                    await setChatMessages([\n                                        {\n                                            message_id: currentMessageId,\n                                            message: trimmedText,\n                                        },\n                                    ], { refresh: 'none' });\n                                    console.info(' </content> ');\n                                }\n                            }\n                        }\n                        catch (error) {\n                            console.error(':', error);\n                        }\n                    }\n                    if (currentMessageId !== undefined && currentMessageId < lastMessageId) {\n                        const messagesToDelete = [];\n                        for (let i = currentMessageId + 1; i <= lastMessageId; i++) {\n                            messagesToDelete.push(i);\n                        }\n                        if (messagesToDelete.length > 0) {\n                            await deleteChatMessages(messagesToDelete, { refresh: 'all' });\n                            console.info(` ${messagesToDelete.length} `);\n                        }\n                    }\n                    // phone\n                    await sendUserMessageWithPhone(messageText);\n                    console.info(':', messageText);\n                    // token\n                    const expectedMessageId = getLastMessageId() + 1;\n                    isStreaming.value = true;\n                    streamingText.value = '';\n                    streamingMessageId.value = expectedMessageId;\n                    //  AI \n                    await triggerSlash('/trigger');\n                    console.info(' AI ');\n                    // \n                    await loadDialoguesFromTavern();\n                }\n                // 1 AI \n                //  </content>  AI \n                if (!isAllDialoguesLoaded && id === 'custom' && customText) {\n                    //  </content> \n                    if (currentMessageId !== undefined) {\n                        try {\n                            const messages = getChatMessages(currentMessageId);\n                            if (messages.length > 0) {\n                                const currentMessage = messages[0];\n                                const originalText = currentMessage.message || '';\n                                const trimmedText = trimMessageBeforeContentTag(originalText);\n                                if (trimmedText !== originalText) {\n                                    await setChatMessages([\n                                        {\n                                            message_id: currentMessageId,\n                                            message: trimmedText,\n                                        },\n                                    ], { refresh: 'none' });\n                                    console.info(' </content> ');\n                                }\n                            }\n                        }\n                        catch (error) {\n                            console.error(':', error);\n                        }\n                    }\n                    //  AI \n                    if (currentMessageId !== undefined && currentMessageId < lastMessageId) {\n                        const messagesToDelete = [];\n                        for (let i = currentMessageId + 1; i <= lastMessageId; i++) {\n                            messagesToDelete.push(i);\n                        }\n                        if (messagesToDelete.length > 0) {\n                            await deleteChatMessages(messagesToDelete, { refresh: 'all' });\n                            console.info(` ${messagesToDelete.length} `);\n                        }\n                    }\n                    // \n                    await createChatMessages([\n                        {\n                            role: 'user',\n                            message: messageText,\n                        },\n                    ], { refresh: 'all' });\n                    console.info(':', messageText);\n                    // \n                    const expectedMessageId = getLastMessageId() + 1;\n                    isStreaming.value = true;\n                    streamingText.value = '';\n                    streamingMessageId.value = expectedMessageId;\n                    //  AI \n                    await triggerSlash('/trigger');\n                    console.info(' AI ');\n                    // \n                    await loadDialoguesFromTavern();\n                }\n                else if (!isAllDialoguesLoaded) {\n                    //  AI \n                    // \n                    nextDialogue();\n                }\n            }\n            catch (error) {\n                console.error(':', error);\n                isStreaming.value = false;\n                streamingText.value = '';\n                streamingMessageId.value = null;\n                nextDialogue();\n            }\n        }\n        // \n        function getDisplayText() {\n            const dialogue = currentDialogue.value;\n            if (!dialogue)\n                return '';\n            // \n            const text = dialogue.text || '';\n            if (!text)\n                return '';\n            // \n            if (isStreaming.value && streamingMessageId.value === dialogue.message_id) {\n                // \n                return text;\n            }\n            // \n            return text;\n        }\n        // token\n        function handleStreamToken(text) {\n            if (!isStreaming.value || streamingMessageId.value === null) {\n                return;\n            }\n            // \n            streamingText.value = text;\n        }\n        // \n        const showHistoryDialog = ref(false);\n        const historyMessages = ref([]);\n        async function handleHistory() {\n            menuExpanded.value = false;\n            showHistoryDialog.value = true;\n            try {\n                // \n                const lastMessageId = getLastMessageId();\n                const messages = [];\n                for (let i = 0; i <= lastMessageId; i++) {\n                    try {\n                        const chatMessages = getChatMessages(i);\n                        if (chatMessages.length > 0) {\n                            const msg = chatMessages[0];\n                            const messageText = msg.message || '';\n                            // \n                            const blocks = await parseMessageBlocks(messageText);\n                            const items = [];\n                            for (const block of blocks) {\n                                if (block.type === 'character' && block.character && block.text) {\n                                    items.push({\n                                        type: 'character',\n                                        character: block.character,\n                                        text: block.text,\n                                    });\n                                }\n                                else if (block.type === 'user') {\n                                    const userText = 'message' in block ? block.message : block.text;\n                                    if (userText) {\n                                        //  *through* \n                                        items.push({\n                                            type: 'user',\n                                            character: '',\n                                            text: userText,\n                                        });\n                                    }\n                                }\n                                else if (block.type === 'narration') {\n                                    const narrationText = 'message' in block ? block.message : block.text;\n                                    if (narrationText) {\n                                        items.push({\n                                            type: 'narration',\n                                            text: narrationText,\n                                        });\n                                    }\n                                }\n                                else if (block.type === 'blacktext') {\n                                    const blackText = 'message' in block ? block.message : block.text;\n                                    if (blackText) {\n                                        items.push({\n                                            type: 'blacktext',\n                                            text: blackText,\n                                        });\n                                    }\n                                }\n                                else if (block.type === 'choice' && (block.choiceText || block.text)) {\n                                    items.push({\n                                        type: 'choice',\n                                        text: block.choiceText || block.text || '',\n                                    });\n                                }\n                            }\n                            // \n                            if (items.length === 0) {\n                                const cleanText = messageText\n                                    .replace(/\\[\\[[^\\]]+\\]\\]/g, '')\n                                    .replace(/<[^>]+>/g, '')\n                                    .trim();\n                                if (cleanText) {\n                                    items.push({\n                                        type: msg.role === 'user' ? 'user' : 'character',\n                                        character: msg.role === 'user' ? '' : 'AI',\n                                        text: cleanText,\n                                    });\n                                }\n                            }\n                            if (items.length > 0) {\n                                messages.push({\n                                    id: i,\n                                    role: msg.role || 'user',\n                                    items,\n                                });\n                            }\n                        }\n                    }\n                    catch (error) {\n                        // \n                        console.warn(` ${i} :`, error);\n                    }\n                }\n                historyMessages.value = messages.reverse(); // \n                console.info(` ${historyMessages.value.length} `);\n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        //  ** \n        function formatUserText(text) {\n            if (!text)\n                return '';\n            //  ** \n            //  **  *through* \n            return text.replace(/\\*([^*]+)\\*/g, (match, content) => {\n                //  *through* \n                if (content.trim() === 'through')\n                    return match;\n                // \n                return ` <span style=\"color: #9ca3af; font-style: italic;\">${content}</span> `;\n            });\n        }\n        // \n        async function jumpToHistoryMessage(messageId) {\n            try {\n                // \n                showHistoryDialog.value = false;\n                // \n                await loadDialoguesFromTavern();\n                // \n                const dialogueIndex = dialogues.value.findIndex(d => d.message_id === messageId);\n                if (dialogueIndex >= 0) {\n                    currentDialogIndex.value = dialogueIndex;\n                    console.info(` ${messageId} ${dialogueIndex}`);\n                }\n                else {\n                    console.warn(` ${messageId} `);\n                }\n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        function handleSaveStyle() {\n            dialogStyle.value = { ...previewStyle.value };\n        }\n        function handleSettingsClick() {\n            if (menuExpanded.value) {\n                if (!customModeEnabled.value) {\n                    previewStyle.value = { ...dialogStyle.value };\n                }\n                showSettings.value = true;\n                menuExpanded.value = false;\n            }\n            else {\n                menuExpanded.value = true;\n            }\n        }\n        function handleCharacterClick() {\n            // \n            if (characterMenuExpanded.value) {\n                showCharacterPanel.value = true;\n                characterMenuExpanded.value = false;\n            }\n            else {\n                // \n                characterMenuExpanded.value = true;\n            }\n        }\n        function handleTheaterClick() {\n            showTheaterPanel.value = true;\n            characterMenuExpanded.value = false;\n        }\n        // \n        function handleQuickTheaterClick() {\n            showTheaterPanel.value = true;\n            characterMenuExpanded.value = false;\n            //  TheaterPanel \n            nextTick(() => {\n                if (typeof window !== 'undefined' && window.openTheaterContacts) {\n                    window.openTheaterContacts();\n                }\n            });\n        }\n        function handleInputClick() {\n            showInputBox.value = true;\n            characterMenuExpanded.value = false;\n            // \n            nextTick(() => {\n                inputRef.value?.focus();\n            });\n        }\n        // \n        async function handleSendInput() {\n            if (!inputText.value.trim())\n                return;\n            const text = inputText.value.trim();\n            inputText.value = '';\n            showInputBox.value = false;\n            // \n            const isAllDialoguesLoaded = currentDialogIndex.value >= dialogues.value.length - 1;\n            const currentMessageId = currentDialogue.value?.message_id;\n            const lastMessageId = getLastMessageId();\n            //  </content> \n            if (!isAllDialoguesLoaded && currentMessageId !== undefined) {\n                try {\n                    // \n                    const messages = getChatMessages(currentMessageId);\n                    if (messages.length > 0) {\n                        const currentMessage = messages[0];\n                        const originalText = currentMessage.message || '';\n                        //  </content> \n                        const trimmedText = trimMessageBeforeContentTag(originalText);\n                        // \n                        if (trimmedText !== originalText) {\n                            await setChatMessages([\n                                {\n                                    message_id: currentMessageId,\n                                    message: trimmedText,\n                                },\n                            ], { refresh: 'none' });\n                            console.info(' </content> ');\n                        }\n                    }\n                    // \n                    if (currentMessageId < lastMessageId) {\n                        const messagesToDelete = [];\n                        for (let i = currentMessageId + 1; i <= lastMessageId; i++) {\n                            messagesToDelete.push(i);\n                        }\n                        if (messagesToDelete.length > 0) {\n                            await deleteChatMessages(messagesToDelete, { refresh: 'all' });\n                            console.info(` ${messagesToDelete.length} `);\n                        }\n                    }\n                }\n                catch (error) {\n                    console.error(':', error);\n                }\n            }\n            // \n            const newDialogue = {\n                character: '',\n                text,\n                type: 'user',\n                isEditable: true,\n                message_id: getLastMessageId() + 1, // ID\n            };\n            // \n            const newDialogues = [...dialogues.value];\n            newDialogues.splice(currentDialogIndex.value + 1, 0, newDialogue);\n            dialogues.value = newDialogues;\n            // \n            currentDialogIndex.value = currentDialogIndex.value + 1;\n            //  AI \n            try {\n                // \n                await applyUserMessageEdits();\n                // \n                const currentScene = currentDialogue.value?.scene || '{{scene}}';\n                // \n                const formattedMessage = `[[user||${currentScene}||${text}]]`;\n                // phone\n                await sendUserMessageWithPhone(formattedMessage);\n                console.info(':', text);\n                // token\n                const expectedMessageId = getLastMessageId() + 1;\n                isStreaming.value = true;\n                streamingText.value = '';\n                streamingMessageId.value = expectedMessageId;\n                //  AI \n                await triggerSlash('/trigger');\n                console.info(' AI ');\n                // \n                await loadDialoguesFromTavern();\n            }\n            catch (error) {\n                console.error(':', error);\n                isStreaming.value = false;\n                streamingText.value = '';\n                streamingMessageId.value = null;\n            }\n        }\n        // \n        async function handleSaveInput() {\n            if (!inputText.value.trim())\n                return;\n            const text = inputText.value.trim();\n            inputText.value = '';\n            showInputBox.value = false;\n            // \n            await handleSaveToStory(text);\n        }\n        // \n        async function handleEditUserMessage(messageId, newText) {\n            try {\n                // \n                await syncEditToMessage(messageId, newText);\n                // \n                userMessageEdits.value.set(messageId, { text: newText });\n                // UI\n                const dialogueIndex = dialogues.value.findIndex(d => d.message_id === messageId);\n                if (dialogueIndex !== -1) {\n                    const newDialogues = [...dialogues.value];\n                    newDialogues[dialogueIndex] = {\n                        ...newDialogues[dialogueIndex],\n                        text: newText,\n                    };\n                    dialogues.value = newDialogues;\n                }\n                console.info(':', messageId, newText);\n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        // \n        async function handleDeleteUserMessage(messageId) {\n            try {\n                // \n                userMessageEdits.value.set(messageId, { deleted: true });\n                // UI\n                const dialogueIndex = dialogues.value.findIndex(d => d.message_id === messageId);\n                if (dialogueIndex !== -1) {\n                    const newDialogues = [...dialogues.value];\n                    newDialogues.splice(dialogueIndex, 1);\n                    dialogues.value = newDialogues;\n                    // \n                    if (currentDialogIndex.value >= newDialogues.length) {\n                        currentDialogIndex.value = Math.max(0, newDialogues.length - 1);\n                    }\n                }\n                console.info(':', messageId);\n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        // \n        async function applyUserMessageEdits() {\n            if (userMessageEdits.value.size === 0)\n                return;\n            try {\n                // \n                for (const [messageId, edit] of userMessageEdits.value.entries()) {\n                    if (edit.deleted) {\n                        // \n                        await deleteChatMessages([messageId], { refresh: 'none' });\n                        console.info(':', messageId);\n                    }\n                    else if (edit.text) {\n                        // \n                        // \n                        await syncEditToMessage(messageId, edit.text);\n                        console.info(':', messageId);\n                    }\n                }\n                // \n                userMessageEdits.value.clear();\n                // \n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        // \n        async function syncEditToMessage(messageId, newText) {\n            try {\n                const messages = getChatMessages(messageId);\n                if (messages.length > 0) {\n                    const originalMessage = messages[0];\n                    const messageText = originalMessage.message || '';\n                    //  <content> \n                    const contentMatch = messageText.match(/<content>([\\s\\S]*?)<\\/content>/i);\n                    const contentText = contentMatch ? contentMatch[1] : messageText;\n                    //  [[user||...]] \n                    const userBlockRegex = /\\[\\[user\\|\\|([^\\]]+)\\]\\]/g;\n                    let match;\n                    let newMessageText = messageText;\n                    let foundMatch = false;\n                    //  user \n                    while ((match = userBlockRegex.exec(contentText)) !== null) {\n                        const content = match[1];\n                        // \n                        const kvPairs = {};\n                        const parts = content\n                            .split('||')\n                            .map(p => p.trim())\n                            .filter(p => p);\n                        for (const part of parts) {\n                            const kvMatch = part.match(/^([^:]+)[:]\\s*(.+)$/);\n                            if (kvMatch) {\n                                const key = kvMatch[1].trim();\n                                const value = kvMatch[2].trim();\n                                if (key && value) {\n                                    kvPairs[key] = value;\n                                }\n                            }\n                        }\n                        //  user \n                        if (kvPairs[''] ||\n                            kvPairs['scene'] ||\n                            kvPairs[''] ||\n                            kvPairs[''] ||\n                            kvPairs[''] ||\n                            kvPairs['text']) {\n                            const scene = kvPairs[''] || kvPairs['scene'] || '{{scene}}';\n                            const oldBlock = match[0];\n                            // **\n                            const newBlock = `[[user||${scene}||${newText}]]`;\n                            //  <content>  contentText \n                            if (contentMatch) {\n                                const newContentText = contentText.replace(oldBlock, newBlock);\n                                newMessageText = messageText.replace(contentMatch[0], `<content>${newContentText}</content>`);\n                            }\n                            else {\n                                newMessageText = messageText.replace(oldBlock, newBlock);\n                            }\n                            foundMatch = true;\n                            break;\n                        }\n                    }\n                    //  <content> \n                    if (!foundMatch) {\n                        if (contentMatch) {\n                            const newContentText = contentText + `\\n[[user||{{scene}}||${newText}]]`;\n                            newMessageText = messageText.replace(contentMatch[0], `<content>${newContentText}</content>`);\n                        }\n                        else {\n                            newMessageText = messageText + `\\n[[user||{{scene}}||${newText}]]`;\n                        }\n                    }\n                    await setChatMessages([\n                        {\n                            message_id: messageId,\n                            message: newMessageText,\n                        },\n                    ], { refresh: 'none' });\n                    console.info(':', messageId, newText);\n                }\n            }\n            catch (error) {\n                console.error(':', error);\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                ref_key: \"containerRef\",\n                ref: containerRef,\n                class: \"relative w-full overflow-hidden select-none\",\n                style: _normalizeStyle([containerStyle.value, { \"background\": \"transparent\" }])\n            }, [\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", {\n                    class: \"absolute inset-0 bg-center bg-no-repeat\",\n                    style: _normalizeStyle({\n                        backgroundImage: backgroundImage.value ? `url('${backgroundImage.value}')` : undefined,\n                        backgroundColor: 'transparent',\n                        backgroundSize: backgroundImage.value ? 'cover' : undefined,\n                        backgroundPosition: 'center',\n                        backgroundRepeat: 'no-repeat',\n                        objectFit: 'cover',\n                    })\n                }, null, 4 /* STYLE */),\n                _createCommentVNode(\"  \"),\n                _cache[23] || (_cache[23] = _createElementVNode(\"div\", { class: \"bg-primary/5 absolute inset-0\" }, null, -1 /* CACHED */)),\n                _createCommentVNode(\"  \"),\n                _createVNode(CharacterSprite, {\n                    scale: spriteSettings.value.scale,\n                    \"position-x\": spriteSettings.value.positionX,\n                    \"position-y\": spriteSettings.value.positionY,\n                    \"sprite-type\": currentSpriteType.value,\n                    \"image-url\": currentImageUrl.value,\n                    \"live2d-model-id\": currentLive2dModelId.value,\n                    \"live2d-models\": live2dModels.value,\n                    motion: currentDialogue.value?.motion,\n                    expression: currentDialogue.value?.expression\n                }, null, 8 /* PROPS */, [\"scale\", \"position-x\", \"position-y\", \"sprite-type\", \"image-url\", \"live2d-model-id\", \"live2d-models\", \"motion\", \"expression\"]),\n                _createCommentVNode(\" CGCG \"),\n                (currentDialogue.value?.isCG && currentDialogue.value.cgImageUrl)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"absolute inset-0 z-5 bg-cover bg-center\",\n                        style: _normalizeStyle({\n                            backgroundImage: `url('${currentDialogue.value.cgImageUrl}')`,\n                        })\n                    }, null, 4 /* STYLE */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass([\n                            'bg-card/80 text-foreground flex items-center gap-2 rounded-full p-2 shadow-lg backdrop-blur-sm transition-all hover:bg-card',\n                            characterMenuExpanded.value ? 'pr-4' : '',\n                        ]),\n                        \"aria-label\": \"\",\n                        onClick: _withModifiers(handleCharacterClick, [\"stop\"])\n                    }, [\n                        _createCommentVNode(\"  SVG \"),\n                        _cache[8] || (_cache[8] = _createElementVNode(\"svg\", {\n                            class: \"h-5 w-5\",\n                            fill: \"none\",\n                            stroke: \"currentColor\",\n                            viewBox: \"0 0 24 24\"\n                        }, [\n                            _createElementVNode(\"path\", {\n                                \"stroke-linecap\": \"round\",\n                                \"stroke-linejoin\": \"round\",\n                                \"stroke-width\": \"2\",\n                                d: \"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\n                            })\n                        ], -1 /* CACHED */)),\n                        (characterMenuExpanded.value)\n                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, \"\"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ], 2 /* CLASS */),\n                    _createCommentVNode(\"  \"),\n                    (characterMenuExpanded.value)\n                        ? (_openBlock(), _createElementBlock(\"button\", {\n                            key: 0,\n                            class: \"bg-card/80 text-foreground animate-in fade-in slide-in-from-top-2 flex items-center gap-2 rounded-full p-2 pr-4 shadow-lg backdrop-blur-sm transition-colors duration-200 hover:bg-card\",\n                            style: { \"animation-delay\": \"25ms\" },\n                            \"aria-label\": \"\",\n                            onClick: _withModifiers(handleTheaterClick, [\"stop\"])\n                        }, [...(_cache[9] || (_cache[9] = [\n                                _createElementVNode(\"svg\", {\n                                    class: \"h-5 w-5\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\"\n                                }, [\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M7 4h10a1 1 0 011 1v14a1 1 0 01-1 1H7a1 1 0 01-1-1V5a1 1 0 011-1z\"\n                                    }),\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M11 5h2m-2 14h2\"\n                                    })\n                                ], -1 /* CACHED */),\n                                _createElementVNode(\"span\", { class: \"text-sm\" }, \"\", -1 /* CACHED */)\n                            ]))]))\n                        : _createCommentVNode(\"v-if\", true),\n                    (characterMenuExpanded.value)\n                        ? (_openBlock(), _createElementBlock(\"button\", {\n                            key: 1,\n                            class: \"bg-card/80 text-foreground animate-in fade-in slide-in-from-top-2 flex items-center gap-2 rounded-full p-2 pr-4 shadow-lg backdrop-blur-sm transition-colors duration-200 hover:bg-card\",\n                            style: { \"animation-delay\": \"75ms\" },\n                            \"aria-label\": \"\",\n                            onClick: _withModifiers(handleInputClick, [\"stop\"])\n                        }, [...(_cache[10] || (_cache[10] = [\n                                _createElementVNode(\"svg\", {\n                                    class: \"h-5 w-5\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\"\n                                }, [\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"\n                                    })\n                                ], -1 /* CACHED */),\n                                _createElementVNode(\"span\", { class: \"text-sm\" }, \"\", -1 /* CACHED */)\n                            ]))]))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createCommentVNode(\"  \"),\n                    (hasUnreadMessages.value)\n                        ? (_openBlock(), _createElementBlock(\"button\", {\n                            key: 2,\n                            class: \"bg-card/80 text-foreground animate-in fade-in slide-in-from-top-2 flex items-center justify-center rounded-full p-2 shadow-lg backdrop-blur-sm transition-all duration-200 hover:bg-card hover:scale-110\",\n                            style: { \"animation-delay\": \"100ms\" },\n                            \"aria-label\": \"\",\n                            onClick: _withModifiers(handleQuickTheaterClick, [\"stop\"])\n                        }, [...(_cache[11] || (_cache[11] = [\n                                _createElementVNode(\"svg\", {\n                                    class: \"h-5 w-5\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\"\n                                }, [\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M7 4h10a1 1 0 011 1v14a1 1 0 01-1 1H7a1 1 0 01-1-1V5a1 1 0 011-1z\"\n                                    }),\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M11 5h2m-2 14h2\"\n                                    })\n                                ], -1 /* CACHED */)\n                            ]))]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass([\n                            'bg-card/80 text-foreground flex items-center gap-2 rounded-full p-2 shadow-lg backdrop-blur-sm transition-all hover:bg-card',\n                            menuExpanded.value ? 'pr-4' : '',\n                        ]),\n                        \"aria-label\": \"\",\n                        onClick: handleSettingsClick\n                    }, [\n                        _cache[12] || (_cache[12] = _createElementVNode(\"svg\", {\n                            class: \"h-5 w-5\",\n                            fill: \"none\",\n                            stroke: \"currentColor\",\n                            viewBox: \"0 0 24 24\"\n                        }, [\n                            _createElementVNode(\"path\", {\n                                \"stroke-linecap\": \"round\",\n                                \"stroke-linejoin\": \"round\",\n                                \"stroke-width\": \"2\",\n                                d: \"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\"\n                            }),\n                            _createElementVNode(\"path\", {\n                                \"stroke-linecap\": \"round\",\n                                \"stroke-linejoin\": \"round\",\n                                \"stroke-width\": \"2\",\n                                d: \"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"\n                            })\n                        ], -1 /* CACHED */)),\n                        (menuExpanded.value)\n                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, \"\"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ], 2 /* CLASS */),\n                    _createCommentVNode(\"  \"),\n                    (menuExpanded.value)\n                        ? (_openBlock(), _createElementBlock(\"button\", {\n                            key: 0,\n                            class: \"bg-card/80 text-foreground animate-in fade-in slide-in-from-top-2 flex items-center gap-2 rounded-full p-2 pr-4 shadow-lg backdrop-blur-sm transition-colors duration-200 hover:bg-card\",\n                            \"aria-label\": isFullscreen.value ? '' : '',\n                            onClick: toggleFullscreen\n                        }, [\n                            (isFullscreen.value)\n                                ? (_openBlock(), _createElementBlock(\"svg\", _hoisted_6, [...(_cache[13] || (_cache[13] = [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M9 9V4.5M9 9H4.5M9 9L3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5l5.25 5.25\"\n                                        }, null, -1 /* CACHED */)\n                                    ]))]))\n                                : (_openBlock(), _createElementBlock(\"svg\", _hoisted_7, [...(_cache[14] || (_cache[14] = [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"\n                                        }, null, -1 /* CACHED */)\n                                    ]))])),\n                            _createElementVNode(\"span\", _hoisted_8, _toDisplayString(isFullscreen.value ? '' : ''), 1 /* TEXT */)\n                        ], 8 /* PROPS */, _hoisted_5))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createCommentVNode(\"  \"),\n                    (menuExpanded.value)\n                        ? (_openBlock(), _createElementBlock(\"button\", {\n                            key: 1,\n                            class: \"bg-card/80 text-foreground animate-in fade-in slide-in-from-top-2 flex items-center gap-2 rounded-full p-2 pr-4 shadow-lg backdrop-blur-sm transition-colors duration-200 hover:bg-card\",\n                            style: { \"animation-delay\": \"50ms\" },\n                            \"aria-label\": \"\",\n                            onClick: handleHistory\n                        }, [...(_cache[15] || (_cache[15] = [\n                                _createElementVNode(\"svg\", {\n                                    class: \"h-5 w-5\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\"\n                                }, [\n                                    _createElementVNode(\"path\", {\n                                        \"stroke-linecap\": \"round\",\n                                        \"stroke-linejoin\": \"round\",\n                                        \"stroke-width\": \"2\",\n                                        d: \"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"\n                                    })\n                                ], -1 /* CACHED */),\n                                _createElementVNode(\"span\", { class: \"text-sm\" }, \"\", -1 /* CACHED */)\n                            ]))]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", {\n                    class: \"absolute inset-0 z-10 cursor-pointer\",\n                    onClick: handleClick\n                }),\n                _createCommentVNode(\"  \"),\n                (menuExpanded.value || characterMenuExpanded.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        class: \"absolute inset-0 z-40\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => {\n                            menuExpanded.value = false;\n                            characterMenuExpanded.value = false;\n                        })\n                    }))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\n                        'absolute inset-0 z-30 flex items-center justify-center bg-black transition-opacity duration-1000',\n                        blackScreen.value ? 'opacity-100' : 'pointer-events-none opacity-0',\n                    ]),\n                    onClick: handleBlackScreenClick\n                }, [\n                    _createElementVNode(\"p\", _hoisted_9, _toDisplayString(blackScreenText.value), 1 /* TEXT */),\n                    _createCommentVNode(\"  \"),\n                    (blackScreen.value)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            _cache[16] || (_cache[16] = _createStaticVNode(\"<div class=\\\"absolute top-1/2 left-6 -translate-y-1/2 text-white/40 transition-colors hover:text-white/60\\\" data-v-31ebb342><svg class=\\\"h-8 w-8\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" viewBox=\\\"0 0 24 24\\\" data-v-31ebb342><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M15 19l-7-7 7-7\\\" data-v-31ebb342></path></svg></div><div class=\\\"absolute top-1/2 right-6 -translate-y-1/2 text-white/40 transition-colors hover:text-white/60\\\" data-v-31ebb342><svg class=\\\"h-8 w-8\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" viewBox=\\\"0 0 24 24\\\" data-v-31ebb342><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M9 5l7 7-7 7\\\" data-v-31ebb342></path></svg></div>\", 2))\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 2 /* CLASS */),\n                _createCommentVNode(\"  \"),\n                (showChoices.value && currentDialogue.value?.options)\n                    ? (_openBlock(), _createBlock(ChoiceBox, {\n                        key: 2,\n                        options: currentDialogue.value.options,\n                        \"custom-style\": dialogStyle.value,\n                        \"on-select\": handleChoiceSelect,\n                        \"on-prev\": prevDialogue,\n                        \"on-next\": () => nextDialogue(),\n                        \"on-save\": handleSaveToStory\n                    }, null, 8 /* PROPS */, [\"options\", \"custom-style\", \"on-next\"]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (!blackScreen.value &&\n                    !showChoices.value &&\n                    currentDialogue.value &&\n                    currentDialogue.value.noteContent &&\n                    currentDialogue.value.type !== 'blackscreen' &&\n                    currentDialogue.value.type !== 'choice')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                        _createVNode(NoteCard, {\n                            content: currentDialogue.value.noteContent\n                        }, null, 8 /* PROPS */, [\"content\"])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (!blackScreen.value &&\n                    !showChoices.value &&\n                    currentDialogue.value &&\n                    currentDialogue.value.type !== 'blackscreen' &&\n                    currentDialogue.value.type !== 'choice' &&\n                    getDisplayText())\n                    ? (_openBlock(), _createBlock(DialogBox, {\n                        key: 4,\n                        character: currentDialogue.value.character || '',\n                        text: getDisplayText(),\n                        \"is-last-dialogue\": currentDialogIndex.value >= dialogues.value.length - 1,\n                        \"is-first-dialogue\": currentDialogIndex.value === 0,\n                        \"on-prev\": prevDialogue,\n                        \"on-next\": nextDialogue,\n                        \"dialog-key\": currentDialogIndex.value,\n                        \"custom-style\": dialogStyle.value,\n                        \"is-loading\": isStreaming.value && streamingMessageId.value === currentDialogue.value.message_id,\n                        \"streaming-text\": isStreaming.value && streamingMessageId.value === currentDialogue.value.message_id ? streamingText.value : undefined,\n                        \"is-through\": currentDialogue.value.isThrough,\n                        \"is-editable\": currentDialogue.value.isEditable,\n                        \"message-id\": currentDialogue.value.message_id,\n                        \"on-edit\": handleEditUserMessage,\n                        \"on-delete\": handleDeleteUserMessage\n                    }, null, 8 /* PROPS */, [\"character\", \"text\", \"is-last-dialogue\", \"is-first-dialogue\", \"dialog-key\", \"custom-style\", \"is-loading\", \"streaming-text\", \"is-through\", \"is-editable\", \"message-id\"]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (showSettings.value)\n                    ? (_openBlock(), _createBlock(SettingsPanel, {\n                        key: 5,\n                        \"on-close\": () => (showSettings.value = false),\n                        \"sprite-settings\": spriteSettings.value,\n                        \"on-sprite-settings-change\": s => (spriteSettings.value = s),\n                        \"auto-play\": autoPlay.value,\n                        \"on-auto-play-change\": v => (autoPlay.value = v),\n                        \"auto-play-speed\": autoPlaySpeed.value,\n                        \"on-auto-play-speed-change\": v => (autoPlaySpeed.value = v),\n                        \"dialog-style\": previewStyle.value,\n                        \"on-dialog-style-change\": s => (previewStyle.value = s),\n                        \"on-save-style\": handleSaveStyle,\n                        \"current-applied-style\": dialogStyle.value,\n                        \"custom-mode-enabled\": customModeEnabled.value,\n                        \"on-custom-mode-change\": v => (customModeEnabled.value = v)\n                    }, null, 8 /* PROPS */, [\"on-close\", \"sprite-settings\", \"on-sprite-settings-change\", \"auto-play\", \"on-auto-play-change\", \"auto-play-speed\", \"on-auto-play-speed-change\", \"dialog-style\", \"on-dialog-style-change\", \"current-applied-style\", \"custom-mode-enabled\", \"on-custom-mode-change\"]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                _createVNode(CharacterStatusPanel, {\n                    show: showCharacterPanel.value,\n                    \"message-id\": currentDialogue.value?.message_id,\n                    \"status-block\": currentDialogue.value?.statusBlock,\n                    \"on-close\": () => (showCharacterPanel.value = false)\n                }, null, 8 /* PROPS */, [\"show\", \"message-id\", \"status-block\", \"on-close\"]),\n                _createCommentVNode(\"  \"),\n                _createVNode(TheaterPanel, {\n                    show: showTheaterPanel.value,\n                    \"message-id\": currentDialogue.value?.message_id,\n                    \"status-block\": currentDialogue.value?.statusBlock,\n                    \"on-close\": () => (showTheaterPanel.value = false)\n                }, null, 8 /* PROPS */, [\"show\", \"message-id\", \"status-block\", \"on-close\"]),\n                _createCommentVNode(\"  \"),\n                (showHistoryDialog.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 6,\n                        class: \"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm\",\n                        onClick: _cache[2] || (_cache[2] = _withModifiers(($event) => (showHistoryDialog.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_12, [\n                                _cache[18] || (_cache[18] = _createElementVNode(\"h2\", { class: \"text-lg font-medium\" }, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"hover:bg-muted rounded-full p-1 transition-colors\",\n                                    \"aria-label\": \"\",\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (showHistoryDialog.value = false))\n                                }, [...(_cache[17] || (_cache[17] = [\n                                        _createElementVNode(\"svg\", {\n                                            class: \"h-5 w-5\",\n                                            fill: \"none\",\n                                            stroke: \"currentColor\",\n                                            viewBox: \"0 0 24 24\"\n                                        }, [\n                                            _createElementVNode(\"path\", {\n                                                \"stroke-linecap\": \"round\",\n                                                \"stroke-linejoin\": \"round\",\n                                                \"stroke-width\": \"2\",\n                                                d: \"M6 18L18 6M6 6l12 12\"\n                                            })\n                                        ], -1 /* CACHED */)\n                                    ]))])\n                            ]),\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_13, [\n                                (historyMessages.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, \"  \"))\n                                    : _createCommentVNode(\"v-if\", true),\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(historyMessages.value, (msg, msgIndex) => {\n                                    return (_openBlock(), _createElementBlock(_Fragment, {\n                                        key: msg.id\n                                    }, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(msg.items, (item, itemIndex) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: `${msg.id}-${itemIndex}`,\n                                                class: \"history-message-item group relative cursor-pointer rounded px-3 py-2 transition-all\",\n                                                onClick: ($event) => (jumpToHistoryMessage(msg.id))\n                                            }, [\n                                                _createCommentVNode(\"  \"),\n                                                (item.type === 'character' || item.type === 'user')\n                                                    ? (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: 0,\n                                                        class: \"leading-relaxed\",\n                                                        style: _normalizeStyle({\n                                                            color: dialogStyle.value.colors.dialogText,\n                                                            fontSize: `${dialogStyle.value.fontSize}px`,\n                                                        })\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_16, _toDisplayString(item.character) + \"\", 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", {\n                                                            innerHTML: formatUserText(item.text)\n                                                        }, null, 8 /* PROPS */, _hoisted_17)\n                                                    ], 4 /* STYLE */))\n                                                    : (item.type === 'narration')\n                                                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                            _createCommentVNode(\"  \"),\n                                                            _createElementVNode(\"div\", {\n                                                                class: \"ml-6 leading-relaxed italic\",\n                                                                style: _normalizeStyle({\n                                                                    color: dialogStyle.value.colors.narrationText,\n                                                                    fontSize: `${dialogStyle.value.fontSize}px`,\n                                                                })\n                                                            }, _toDisplayString(item.text), 5 /* TEXT, STYLE */)\n                                                        ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                                                        : (item.type === 'blacktext')\n                                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                                                                _createCommentVNode(\"  \"),\n                                                                _createElementVNode(\"div\", {\n                                                                    class: \"ml-6 leading-relaxed italic opacity-70\",\n                                                                    style: _normalizeStyle({\n                                                                        color: dialogStyle.value.colors.narrationText,\n                                                                        fontSize: `${dialogStyle.value.fontSize}px`,\n                                                                    })\n                                                                }, _toDisplayString(item.text), 5 /* TEXT, STYLE */)\n                                                            ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                                                            : (item.type === 'choice')\n                                                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 3 }, [\n                                                                    _createCommentVNode(\"  \"),\n                                                                    _createElementVNode(\"div\", {\n                                                                        class: \"leading-relaxed\",\n                                                                        style: _normalizeStyle({\n                                                                            color: dialogStyle.value.colors.dialogText,\n                                                                            fontSize: `${dialogStyle.value.fontSize}px`,\n                                                                        })\n                                                                    }, [\n                                                                        _cache[19] || (_cache[19] = _createElementVNode(\"span\", { class: \"font-medium\" }, \"\", -1 /* CACHED */)),\n                                                                        _createElementVNode(\"span\", null, _toDisplayString(item.text), 1 /* TEXT */)\n                                                                    ], 4 /* STYLE */)\n                                                                ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                                                                : _createCommentVNode(\"v-if\", true),\n                                                _createCommentVNode(\" hover \"),\n                                                (itemIndex < msg.items.length - 1 || msgIndex < historyMessages.value.length - 1)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ], 8 /* PROPS */, _hoisted_15));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ], 64 /* STABLE_FRAGMENT */));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\"  \"),\n                (showInputBox.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 7,\n                        class: \"absolute inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm\",\n                        onClick: _cache[7] || (_cache[7] = () => (showInputBox.value = false))\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"relative mx-4 w-full max-w-lg p-4\",\n                            style: _normalizeStyle({\n                                backgroundColor: dialogStyle.value.boxShape === 'pill' ? 'rgba(255, 255, 255, 0.85)' : dialogStyle.value.colors.boxBackground,\n                                borderRadius: '16px',\n                                borderWidth: '1px',\n                                borderStyle: 'solid',\n                                borderColor: dialogStyle.value.colors.boxBorder,\n                                boxShadow: '0 8px 32px rgba(0,0,0,0.15)',\n                                backdropFilter: dialogStyle.value.boxShape === 'pill' ? 'blur(12px)' : undefined,\n                            }),\n                            onClick: _cache[6] || (_cache[6] = _withModifiers(() => { }, [\"stop\"]))\n                        }, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"button\", {\n                                class: \"absolute top-2 right-2 rounded-full p-1 transition-colors hover:bg-black/5\",\n                                onClick: _cache[3] || (_cache[3] = () => (showInputBox.value = false))\n                            }, [...(_cache[20] || (_cache[20] = [\n                                    _createElementVNode(\"svg\", {\n                                        class: \"text-muted-foreground h-4 w-4\",\n                                        fill: \"none\",\n                                        stroke: \"currentColor\",\n                                        viewBox: \"0 0 24 24\"\n                                    }, [\n                                        _createElementVNode(\"path\", {\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\",\n                                            \"stroke-width\": \"2\",\n                                            d: \"M6 18L18 6M6 6l12 12\"\n                                        })\n                                    ], -1 /* CACHED */)\n                                ]))]),\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", {\n                                class: \"mb-3 inline-block px-3 py-1 text-sm font-medium\",\n                                style: _normalizeStyle({\n                                    backgroundColor: dialogStyle.value.colors.nameBackground,\n                                    color: dialogStyle.value.colors.nameText,\n                                    borderRadius: '6px',\n                                })\n                            }, \"  \", 4 /* STYLE */),\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_19, [\n                                _withDirectives(_createElementVNode(\"input\", {\n                                    ref_key: \"inputRef\",\n                                    ref: inputRef,\n                                    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => ((inputText).value = $event)),\n                                    type: \"text\",\n                                    placeholder: \"...\",\n                                    class: \"flex-1 bg-transparent text-base outline-none\",\n                                    style: _normalizeStyle({ color: dialogStyle.value.colors.dialogText }),\n                                    onKeydown: [\n                                        _withKeys(handleSendInput, [\"enter\"]),\n                                        _cache[5] || (_cache[5] = _withKeys(() => (showInputBox.value = false), [\"escape\"]))\n                                    ]\n                                }, null, 36 /* STYLE, NEED_HYDRATION */), [\n                                    [_vModelText, inputText.value]\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                (inputText.value.trim())\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 0,\n                                        class: \"p-1 transition-colors hover:opacity-80\",\n                                        style: _normalizeStyle({ color: dialogStyle.value.colors.nameText }),\n                                        \"aria-label\": \"\",\n                                        title: \"\",\n                                        onClick: _withModifiers(handleSaveInput, [\"stop\"])\n                                    }, [...(_cache[21] || (_cache[21] = [\n                                            _createElementVNode(\"svg\", {\n                                                class: \"h-5 w-5\",\n                                                fill: \"none\",\n                                                stroke: \"currentColor\",\n                                                viewBox: \"0 0 24 24\"\n                                            }, [\n                                                _createElementVNode(\"path\", {\n                                                    \"stroke-linecap\": \"round\",\n                                                    \"stroke-linejoin\": \"round\",\n                                                    \"stroke-width\": \"2\",\n                                                    d: \"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12\"\n                                                })\n                                            ], -1 /* CACHED */)\n                                        ]))], 4 /* STYLE */))\n                                    : _createCommentVNode(\"v-if\", true),\n                                _createCommentVNode(\"  \"),\n                                (inputText.value.trim())\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 1,\n                                        class: \"p-1 transition-colors hover:opacity-80\",\n                                        style: _normalizeStyle({ color: dialogStyle.value.colors.nameText }),\n                                        \"aria-label\": \"\",\n                                        onClick: _withModifiers(handleSendInput, [\"stop\"])\n                                    }, [...(_cache[22] || (_cache[22] = [\n                                            _createElementVNode(\"svg\", {\n                                                class: \"h-5 w-5\",\n                                                fill: \"none\",\n                                                stroke: \"currentColor\",\n                                                viewBox: \"0 0 24 24\"\n                                            }, [\n                                                _createElementVNode(\"path\", {\n                                                    \"stroke-linecap\": \"round\",\n                                                    \"stroke-linejoin\": \"round\",\n                                                    \"stroke-width\": \"2\",\n                                                    d: \"M5 12h14M12 5l7 7-7 7\"\n                                                })\n                                            ], -1 /* CACHED */)\n                                        ]))], 4 /* STYLE */))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ], 4 /* STYLE */)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ], 4 /* STYLE */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./GalgamePlayer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./GalgamePlayer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./GalgamePlayer.vue?vue&type=style&index=0&id=31ebb342&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-31ebb342\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport GalgamePlayer from './components/GalgamePlayer.vue';\nimport './styles/globals.css';\n\n$(() => {\n  createApp(GalgamePlayer).mount('#app');\n});\n"],"names":["CubismAdapter","static","initialize","this","_isInitialized","window","Live2DCubismCore","CubismCore","Error","frameworkModule","CubismFramework","Option","LogLevel","isStarted","console","info","option","logFunction","printMessage","loggingLevel","LogLevel_Verbose","startUp","_cubismFramework","error","warn","isInitialized","getFramework","module","exports","import","LAppPal","loadFileAsBytes","filePath","callback","fetch","then","response","arrayBuffer","byteLength","catch","ArrayBuffer","getDeltaTime","deltaTime","updateTime","currentFrame","Date","now","lastFrame","message","log","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Vue","backgroundPatternPresets","id","name","pattern","boxShapePresets","borderRadius","borderWidth","shadow","borderWidthPresets","width","nameShapePresets","style","arrowShapePresets","type","isInner","indicatorShapePresets","defaultDialogStyle","boxShape","nameShape","arrowShape","indicatorShape","backgroundPattern","colors","boxBackground","boxBorder","nameBackground","nameText","nameBorder","dialogText","narrationText","arrowBackground","arrowIcon","indicatorColor","fontSize","parseWorldbookJsonData","content","jsonMatch","match","JSON","parse","trim","worldbookCache","worldbookCacheTimestamp","worldbookCacheSource","async","loadWorldbookResources","currentCharacterName","RawCharacter","find","getCardData","cache","models","Map","sprites","backgrounds","cgs","worldbookNames","charWorldbooks","getCharWorldbookNames","primary","push","additional","length","worldbookName","getWorldbook","entries","entry","enabled","data","modelData","has","modelName","set","spriteData","sprite","textMappings","join","existing","newData","size","normalizeText","text","replace","toLowerCase","fuzzyMatch","source","normalizedSource","normalizedTarget","includes","parseKeyValuePairs","result","parts","split","map","p","filter","part","kvMatch","value","matchWorldbookResources","characterName","sceneText","motionText","expressionText","cgSceneText","resources","bg","matchText","some","mapping","sceneImageUrl","file","cg","cgImageUrl","textMappingMatch","nameMatch","spriteImageUrl","modelMatchTexts","matchedModelData","motion","mappingText","motions","m","motionFile","expression","expressions","e","expressionFile","parseStatusBlock","statusData","fieldRegex","fieldMatch","exec","keys","lines","line","colonIndex","indexOf","substring","parseMessageBlocks","lastScene","blocks","currentScene","contentMatch","contentText","blockRegex","kvPairs","scene","messageText","narrationRegex","narrationMatches","narrationMatch","narrationBlock","block","character","cgScene","isCG","assign","choiceCharacter","choiceResponse","choiceText","choices","i","choice","remainingText","blockMatches","Array","from","matchAll","noteLines","inNoteBlock","trimmedLine","startsWith","noteLine","noteContent","hasMotionAndExpression","live2dModels","model","hasMotion","motionName","normalizedMotion","normalizedMapping","String","hasExpression","exprName","normalizedExpression","exprFile","STORE_NAME","openDB","Promise","resolve","reject","request","indexedDB","open","onerror","onsuccess","onupgradeneeded","event","db","objectStoreNames","contains","createObjectStore","keyPath","getFileBlobUrl","fileId","transaction","objectStore","fileData","blob","Blob","File","filename","lastModified","getFile","URL","createObjectURL","ModelState","ModelManager","_model","_modelSetting","_renderer","_motionManager","_expressionManager","_modelHomeDir","_state","NotLoaded","_gl","_canvas","_motions","_expressions","_modelMatrix","_projectionMatrix","canvas","gl","modelUrl","basePath","endsWith","Loading","modelSetting","loadModelSetting","ensureCubismFramework","loadModelData","loadTextures","preloadMotions","preloadExpressions","Loaded","CubismModelSettingJson","setting","json","TextDecoder","decode","CubismMoc","modelFileName","getModelFileName","moc","create","modelModule","CubismModel","rendererModule","CubismRenderer_WebGL","motionModule","CubismMotionManager","expressionModule","CubismExpressionMotionManager","mathModule","CubismModelMatrix","getCanvasWidth","getCanvasHeight","matrixModule","CubismMatrix44","textureCount","getTextureCount","loadedCount","textureFileName","getTextureFileName","texturePath","img","Image","crossOrigin","onload","texture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","TEXTURE_MAG_FILTER","LINEAR","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texImage2D","RGBA","UNSIGNED_BYTE","generateMipmap","src","motionGroupCount","getMotionGroupCount","groupName","getMotionGroupName","motionCount","getMotionCount","expressionCount","getExpressionCount","expressionName","getExpressionName","expressionFileName","getExpressionFileName","CubismExpressionMotion","playMotion","group","index","priority","motionFileName","getMotionFileName","motionKey","startMotionPriority","CubismMotion","playExpression","expressionIndex","startMotion","update","updateMotion","render","height","loadIdentity","scale","viewMatrix","multiplyByMatrix","drawModel","getModel","isLoaded","release","forEach","delete","clear","cubismCoreInitPromise","initCubismCore","document","querySelector","setTimeout","script","createElement","head","appendChild","Live2DRenderer","_modelConfig","_currentModelUrl","_modelManager","_animationFrameId","_lastUpdateTime","_viewMatrix","_scale","_positionX","_positionY","_usePrivateVars","_waitForModelLoad","constructor","_subdelegate","init","exists","clientWidth","clientHeight","getContext","alpha","premultipliedAlpha","preserveDrawingBuffer","enable","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","clearColor","ResizeObserver","resize","observe","loadModel","config","modelPath","blobUrl","indexedDbUrl","fileIds","parsed","url","parseIndexedDbUrl","getIndexedDbFileUrl","_fileIds","modelDir","lastIndexOf","startRenderLoop","defaultAnimation","motionIndex","findIndex","motionGroup","attempts","checkLoad","requestAnimationFrame","stopRenderLoop","cancelAnimationFrame","COLOR_BUFFER_BIT","draw","startRandomMotion","setExpression","setPosition","x","y","getModelMatrix","modelMatrix","ndcX","ndcY","setX","setY","setScale","isReady","unloadModel","destroy","loseContext","getExtension","displayWidth","displayHeight","viewport","onResize","_hoisted_1","__name","positionX","positionY","spriteType","imageUrl","live2dModelId","setup","__props","spriteContainerRef","ref","live2dCanvasRef","lastMotion","lastExpression","lastModelId","live2dRenderer","containerStyle","computed","left","bottom","transform","transformOrigin","playMotionAndExpression","modelConfig","motionConfig","normalizedGroup","mGroup","loadLive2dModel","hasModels","modelsLength","hasCanvas","availableModels","motionsCount","expressionsCount","needReloadModel","motionChanged","expressionChanged","stack","modelId","requestedId","requestedIdType","availableIds","idType","availableIdsString","stringify","requestedIdString","watch","newVal","oldVal","oldSpriteType","oldModelId","nextTick","immediate","onMounted","onUnmounted","_ctx","_cache","ref_key","class","alt","draggable","_","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","show","Boolean","messageId","statusBlock","onClose","Function","activeTab","theaterExpanded","theaterContainer","theaterRendered","isLoading","tabs","statusValues","getMvuStatData","waitGlobalInitialized","Mvu","mvuData","getMvuData","message_id","stat_data","renderTheater","rawText","container","innerHTML","matches","emptyMsg","textContent","textAlign","color","padding","fullSpeaker","speakerName","isUser","bubbleSide","bubbleWrapper","display","flexDirection","marginBottom","alignItems","speakerLabel","bubble","classList","add","loadStatusData","mvuLoaded","statData","field","loadStatusFromMvu","newValues","characterData","attrName","attrValue","isNaN","Number","extractStatusValues","newTab","onClick","args","fill","stroke","viewBox","tab","$event","options","customStyle","onSelect","onPrev","onNext","onSave","isInputting","inputText","selectedCustom","inputRef","handleCustomClick","focus","handleInputConfirm","handleSave","dialogStyle","borderWidthPreset","isPillShape","handleBackgroundClick","rect","currentTarget","getBoundingClientRect","clientX","backgroundColor","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderStyle","borderColor","boxShadow","backdropFilter","WebkitBackdropFilter","handleOptionClick","placeholder","onKeydown","autofocus","title","isLastDialogue","isFirstDialogue","dialogKey","streamingText","isThrough","isEditable","onEdit","onDelete","displayedText","isTyping","typingTimer","textContentRef","needsWrapping","narrationJustifyClass","bgPattern","isNarration","isInnerArrow","isMinimalArrow","getPatternStyle","borderColorForPattern","patternWithColor","backgroundSize","backgroundImage","boxStyle","outerArrowStyle","iconColor","bgColor","innerLeftArrowStyle","background","innerRightArrowStyle","indicatorComponent","isStreaming","h","opacity","animation","handlePrev","handleNext","formatTextWithCursor","showCursor","formattedText","formatTextWithThoughts","clearTypingTimer","clearInterval","startTyping","setInterval","slice","checkTextWrapping","element","span","availableWidth","offsetWidth","parseInt","getComputedStyle","paddingLeft","paddingRight","tempDiv","visibility","position","top","fontStyle","fontFamily","lineHeight","whiteSpace","wordWrap","overflowWrap","cleanContent","body","singleLineDiv","singleLineHeight","offsetHeight","actualHeight","removeChild","showEditDialog","editText","handleEdit","handleDelete","confirm","confirmEdit","cancelEdit","disabled","borderBottom","rows","label","showAlpha","default","emits","emit","__emit","hexToHsl","hex","r","g","b","parseFloat","max","Math","min","s","l","round","hslToRgba","k","f","toFixed","toString","padStart","rgbaToHex","rgba","toUpperCase","hsl","hexDisplay","hexInput","localHsl","isDraggingRef","trackRefs","draggingSlider","globalMoveHandler","globalUpHandler","newHsl","sliders","currentValue","gradient","step","thumbColor","displayValue","updateLocalValue","slider","track","ratio","finalVal","newValue","commitChange","finalValue","handleHexInput","input","test","handleHexBlur","onInput","onBlur","ref_for","el","onPointerdown","setPointerCapture","pointerId","handleGlobalMove","ev","handleGlobalUp","removeEventListener","HTMLElement","releasePointerCapture","addEventListener","handlePointerDown","onPointermove","handlePointerMove","onPointerup","handlePointerUp","arrowBorderRadius","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","spriteSettings","onSpriteSettingsChange","autoPlay","onAutoPlayChange","autoPlaySpeed","onAutoPlaySpeedChange","onDialogStyleChange","onSaveStyle","currentAppliedStyle","customModeEnabled","onCustomModeChange","hasChanges","updateSpriteSettings","settings","updateShape","updateColor","checked","onChange","handleEnableCustomMode","DialogPreview","preset","ColorSlider","v","handleClose","theaterContent","textDiv","mainCharacterName","isMainCharacter","className","justifyContent","bubbleContent","maxWidth","wordBreak","STORAGE_KEYS","containerRef","autoPlayTimerRef","dialogues","shallowRef","currentDialogIndex","currentDialogue","showSettings","isFullscreen","menuExpanded","characterMenuExpanded","showCharacterPanel","showTheaterPanel","blackScreen","blackScreenText","showChoices","showInputBox","streamingMessageId","loadFromStorage","previewStyle","defaultValue","stored","localStorage","getItem","saveToStorage","setItem","newStyle","deep","newSettings","isPortrait","innerHeight","innerWidth","isFullscreenMode","fullscreenElement","targetAspectRatio","screenHeight","aspectRatio","marginLeft","marginTop","margin","dialogue","currentSpriteType","hasLive2d","currentImageUrl","currentLive2dModelId","foundModel","userMessageEdits","loadDialoguesFromTavern","messages","getChatMessages","newDialogues","lastSceneImageUrl","lastSpriteState","lastIsCG","lastCgImageUrl","inheritSceneAndBackground","inheritCGState","inheritSpriteState","updateSceneState","updateSpriteStateFromCharacter","msg","newFormatChoiceBlocks","oldFormatChoiceBlocks","motionToUse","expressionToUse","hasMotionExpr","live2dModel","hasSpriteImage","extra","sprite_image","hasLive2dModel","blockIsCG","isCGMode","reason","role","edit","deleted","isDeleted","editedText","choiceDialogue","choiceBlock","allChoices","filteredDialogues","previousLength","loadTestDialogues","nextDialogue","skipBlackscreen","nextIndex","prevDialogue","toggleFullscreen","screen","orientation","lock","requestFullscreen","exitFullscreen","unlock","clearTimeout","delay","handleFullscreenChange","handleResize","eventCleanups","handleBlackScreenClick","handleClick","modelsMap","variables","getVariables","live2d_models","isArray","existingModel","files","model3","pop","textures","model3Url","isFullUrl","newModel","version","values","hasTextMappings","loadLive2dModels","eventOn","tavern_events","messageReceivedCleanup","MESSAGE_RECEIVED","messageIdNum","phoneRegex","phoneMatches","aiSentContacts","Set","targetWorldbookName","worldbook","createOrReplaceWorldbook","phoneContent","contactMessages","lineMatch","contactName","speaker","time","potentialContact","potentialContent","potentialTime","userFormatMatch","entryName","comment","insertion_order","case_sensitive","name_regex","content_regex","exclude_recursion","display_index","probability","delay_on","delay_off","recursion","prevent_incoming","prevent_outgoing","delay_until","before","after","order","disable","exclude","uid","existingContent","newLines","updatedContent","updateWorldbookWith","contact","unreadContacts","updateTheaterUnreadMarkers","parsePhoneTagsAndUpdateWorldbook","stop","messageUpdatedCleanup","MESSAGE_UPDATED","updatedMessage","chatChangedCleanup","CHAT_CHANGED","streamTokenCleanup","STREAM_TOKEN_RECEIVED","handleStreamToken","cleanup","hasUnreadMessages","getUnreadContacts","unreadList","sendUserMessageWithPhone","getTheaterPendingMessages","finalMessage","createChatMessages","refresh","trimMessageBeforeContentTag","contentEndIndex","handleSaveToStory","currentMessageId","getCurrentMessageId","chat_message","newMessage","setChatMessages","newDialogue","getLastMessageId","splice","handleChoiceSelect","customText","lastMessageId","isAllDialoguesLoaded","selectedOption","opt","selectedText","choiceBlockRegex","newMessageText","allChoiceBlocks","c","newFormatBlocks","cb","newContentText","oldFormatBlocks","trimmedChoiceBlock","trimChoiceText","responseDialogue","originalText","trimmedText","messagesToDelete","deleteChatMessages","expectedMessageId","triggerSlash","getDisplayText","clearUnreadContact","showHistoryDialog","historyMessages","handleHistory","chatMessages","items","userText","blackText","cleanText","reverse","handleSaveStyle","handleSettingsClick","handleCharacterClick","handleTheaterClick","handleQuickTheaterClick","openTheaterContacts","handleInputClick","handleSendInput","syncEditToMessage","applyUserMessageEdits","formattedMessage","handleSaveInput","handleEditUserMessage","newText","dialogueIndex","handleDeleteUserMessage","userBlockRegex","foundMatch","oldBlock","newBlock","backgroundPosition","backgroundRepeat","objectFit","CharacterSprite","ChoiceBox","NoteCard","DialogBox","SettingsPanel","CharacterStatusPanel","TheaterPanel","msgIndex","item","itemIndex","$","createApp","GalgamePlayer","mount"],"ignoreList":[],"sourceRoot":""}